<!DOCTYPE html>
<!-- saved from url=(0048)https://www.shiyanlou.com/courses/1091/learning/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="vjs-styles-defaults">
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid {
        padding-top: 56.25%
      }
    </style>
    <title data-n-head="true">Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼</title><meta data-n-head="true" name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta data-n-head="true" data-hid="keywords" name="keywords" content="实验楼,IT培训,IT教育,编程,在线编程,Linux,Linux教程,Linux操作系统,
        Python,Python教程,Python基础教程,Java,Java编程,C语言,大数据,Node.js,
        Hadoop,PHP,Docker,Git,R,SQL,MongoDB,Redis,Swift,Spark,在线实验,
        IT在线教育,编程入门,项目训练,项目实践,webIDE,软件开发"><meta data-n-head="true" data-hid="description" name="description" content="实验楼是国内领先的IT在线编程及在线实训学习平台，专业导师提供精选的实践项目，
        创新的技术使得学习者无需配置繁琐的本地环境，随时在线流畅使用。以就业为导向，
        提供编程、运维、测试、云计算、大数据、数据库等全面的IT技术动手实践环境，
        提供Linux、Python、Java、C语言、Node.js、Hadoop、PHP、Docker、Git、
        R、SQL、MongoDB、Redis、Swift、Spark等千门热门课程。"><link data-n-head="true" rel="icon" type="image/x-icon" href="https://www.shiyanlou.com/favicon.ico"><link data-n-head="true" rel="stylesheet" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/font-awesome.min.css"><link rel="preload" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/f3a337105fb6129b39d1.js.下载" as="script"><link rel="preload" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/cc58aae2d5b624e45e75.js.下载" as="script"><link rel="preload" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/34e4120db4a53410cbcd.js.下载" as="script"><link rel="preload" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/e37290ea5e6d3a26020d.css" as="style"><link rel="preload" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/0eed17603f033879ebbc.js.下载" as="script"><link rel="preload" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/4f1eb9016cbba5f02532.css" as="style"><link rel="preload" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/13652036f3502b0c6db7.js.下载" as="script"><link rel="stylesheet" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/e37290ea5e6d3a26020d.css"><link rel="stylesheet" href="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/4f1eb9016cbba5f02532.css">
  <script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/121.js.下载" id="AWSC_uabModule"></script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/um.js.下载" id="AWSC_umidPCModule"></script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/nvc.js.下载"></script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/nvcPrepare.jsonp"></script><script charset="utf-8" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/57e24fa8044cda0ae313.js.下载"></script><script charset="utf-8" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/6920e455a4bd0bff748c.js.下载"></script><script charset="utf-8" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/fa53ae7bdb5589798911.js.下载"></script><script charset="utf-8" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/78f12ae12e7792b2e80b.js.下载"></script><script async="" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/analytics.js.下载" charset="utf-8"></script></head>
  <body class="" data-modal-open-count="0">
    <div id="__nuxt"><div id="__layout"><div data-v-57a4eb3b=""><!---->  <div class="body" data-v-57a4eb3b=""><!----> <div class="lab-operation" data-v-d68b6290="" data-v-57a4eb3b=""><div data-v-00d8b544="" data-v-d68b6290="" class="section-box-root"><div data-v-4c89ebd0="" data-v-00d8b544="" class="wx-service-modal-root"><!----></div> <div data-v-48901454="" data-v-00d8b544="" class="left-box" style="width: 190.234px;"><div data-v-48901454="" class="top-bar"><div data-v-00d8b544="" data-v-48901454="" class="top-bar"><a data-v-00d8b544="" data-v-48901454="" href="https://www.shiyanlou.com/courses/1091" class="home-btn"><img data-v-00d8b544="" data-v-48901454="" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/9f0571e.png"></a> <span data-v-00d8b544="" data-v-48901454="" class="course-name">
        Pandas 百题大冲关｜学习版
      </span> <div data-v-00d8b544="" data-v-48901454="" class="sections-list-btn"><img data-v-00d8b544="" data-v-48901454="" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/01a1ffb.svg">
        章节列表
      </div></div></div> <div data-v-48901454="" class="box-container relative"><div data-v-48901454="" class="left-bar"><div data-v-00d8b544="" data-v-48901454="" class="left-bar"><div data-v-00d8b544="" data-v-48901454="" class="menu-tabs"><div data-v-00d8b544="" data-v-48901454="" class="item font-16 active">
          步骤
        </div><div data-v-00d8b544="" data-v-48901454="" class="item font-16">
          报告
        </div><div data-v-00d8b544="" data-v-48901454="" class="item font-16">
          讨论
        </div></div> <div data-v-00d8b544="" data-v-48901454="" class="menu-btns"><!----> <div data-v-00d8b544="" data-v-48901454="" title="" class="item" data-original-title="新手指南"><img data-v-00d8b544="" data-v-48901454="" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjQzZDNkM2IiBzdHJva2Utd2lkdGg9IjEuMyIgZD0iTTEwIDE3LjgzOWw4LjA2NC0xLjQ5M2EuMzUuMzUgMCAwIDAgLjI4Ni0uMzQ0di0xMy4zYS4zNS4zNSAwIDAgMC0uNDE0LS4zNDRsLTcuOCAxLjQ0NGMtLjEzNi4wMTctLjEzNi4wMTctLjI3MyAwbC03LjgtMS40NDRhLjM1LjM1IDAgMCAwLS40MTMuMzQ0djEzLjNjMCAuMTY4LjEyLjMxMy4yODYuMzQ0TDEwIDE3LjgzOXoiLz4KICAgICAgICA8cGF0aCBmaWxsPSIjQzZDNkM2IiBkPSJNOS41IDEzLjVoMXYxaC0xdi0xem0xLjcxNy00LjY5NGMwLS43MDItLjQyOC0xLjE5Mi0xLjI3NS0xLjE5Mi0uNjEyIDAtMS4xNTkuMjkxLTEuNjc4Ljg2NUw3LjUgNy43NjRDOC4xNzEgNy4wMTcgOC45OTQgNi41IDEwLjA5NCA2LjVjMS40MzUgMCAyLjQwNi44MDggMi40MDYgMi4xOTggMCAxLjc3OC0yLjI5IDIuMDgxLTIuMDUgMy44MDJIOS4yN2MtLjMxMS0xLjkyOCAxLjk0Ny0yLjQxNyAxLjk0Ny0zLjY5NHoiLz4KICAgIDwvZz4KPC9zdmc+Cg=="></div> <div data-v-00d8b544="" data-v-48901454="" title="服务号" class="item"><img data-v-00d8b544="" data-v-48901454="" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/76a43f5.svg"></div> <div data-v-00d8b544="" data-v-48901454="" class="item" role="button"><img data-v-00d8b544="" data-v-48901454="" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/cc491c4.svg" title="" data-original-title="纠错"></div> <div data-v-00d8b544="" data-v-48901454="" class="item"><img data-v-00d8b544="" data-v-48901454="" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjQzZDNkM2Ij4KICAgICAgICA8cGF0aCBmaWxsPSIjQzZDNkM2IiBzdHJva2Utd2lkdGg9Ii43IiBkPSJNMTMuOTIyIDQuMjN2Ni4xNDhhLjU1LjU1IDAgMCAxLS41NS41NUg4LjcwNHY1LjQ3OGEuNTUuNTUgMCAwIDEtLjU1LjU1SDMuNWEuMTUuMTUgMCAwIDAtLjE1LjE1di40MzRjMCAuMDgzLjA2Ny4xNS4xNS4xNWg1LjgwMnYtNS40NzhhLjU1LjU1IDAgMCAxIC41NS0uNTVoNC42NjdWNS41MTRhLjU1LjU1IDAgMCAxIC41NS0uNTVIMTkuNWEuMTUuMTUgMCAwIDAgLjE1LS4xNVY0LjM4YS4xNS4xNSAwIDAgMC0uMTUtLjE1aC01LjU3OHoiLz4KICAgICAgICA8cGF0aCBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjEuMiIgZD0iTTYuMzUgNS4xM0w0Ljc0OCA0LjA0NGMtLjE2Ni0uMTQ4LS4xNjYtLjE0OC0uMjQxLS4zMjZhLjYxMy42MTMgMCAwIDEgLjMzMy0uNzQ1bC4xMDktLjAzNiA0LjYzNS0xLjA5MmEuNzIuNzIgMCAwIDEgLjkyNi42MjRsLjU1MyA0LjYwMWMuMDAyLjE1Ny4wMDIuMTU3LS4wNS4zMTFhLjYxLjYxIDAgMCAxLS44ODguMjY4bC0xLjM5Mi0uODljLS41MDkuODgtMS41OTUgMi4yMjgtMi42MzIgMy4wNi0xLjM5IDEuMTE3LTIuODk4IDEuODc1LTQuNTIyIDIuMjdsLS4zOS0xLjEyOWMxLjc5OS0uODE2IDMuMDUzLTEuNzI0IDMuNzctMi43MDdBOC4xMDYgOC4xMDYgMCAwIDAgNi4zNSA1LjEyOXoiLz4KICAgIDwvZz4KPC9zdmc+Cg=="> <!----></div></div></div></div> <div data-v-48901454="" class="box-content relative full-width"><div data-v-659422e8="" data-v-00d8b544="" class="lab-document" data-v-48901454=""><!----> <div data-v-198dce4b="" data-v-659422e8="" class="single-document" width="190.23354564755837"><div data-v-198dce4b="" class="content"><!----> <div data-v-198dce4b=""><div data-v-198dce4b="" role="alert" aria-live="polite" aria-atomic="true" class="alert rules alert-info"><!----><p data-v-198dce4b="">说明：</p> <div data-v-198dce4b="">
            1. 本章节实验步骤已融合在右侧环境，请开启环境后直接在右侧环境的 空白单元格 处输入代码做实验
          </div> <div data-v-198dce4b="">
            2. 若想仅查看实验步骤，请点击下方展开实验步骤
          </div></div> <div data-v-198dce4b="" class="toggle-doc">
          点击收起步骤
          <i data-v-198dce4b="" class="fa fa-angle-up"></i></div> <div data-v-198dce4b="" class="markdown-body" style=""><h2 id="pandas-百题大冲关｜学习版">Pandas 百题大冲关｜学习版</h2>
<hr>
<h4 id="介绍">介绍</h4>
<p>Pandas 是基于 NumPy 的一种数据处理工具，该工具为了解决数据分析任务而创建。Pandas 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的函数和方法。Pandas 百题大冲关分为基础篇和进阶篇，每部分各有 50 道练习题。基础部分的练习题在于熟悉 Pandas 常用方法的使用，而进阶部分则侧重于 Pandas 方法的组合应用。</p>
<p>如果你对 Pandas 的使用还不熟悉，我们建议你先学习 <a href="https://www.shiyanlou.com/courses/906" target="_blank"><i class="fa fa-external-link-square"> Pandas 数据处理基础课程</i></a> 后再使用本课程进行复习和检验。</p>
<hr>
<div class="alert alert-info"><p>本次实验为 Notebook 实验，前后单元格之间有关联性，你需要按顺序执行单元格，跳跃或重复执行部分单元格可能会造成赋值混乱。</p></div>

<h3 id="基础部分">基础部分</h3>
<p><strong>1. 导入 Pandas：</strong></p>
<p>练习 Pandas 之前，首先需要导入 Pandas 模块，并约定简称为 <code>pd</code>。</p>
<p><i class="fa fa-arrow-circle-down"> 教学代码</i>：</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
</code></pre><p><i class="fa fa-arrow-circle-down"> 动手练习</i>｜如果你对课程所使用的实验楼 Notebook 在线环境并不熟悉，可以先学习 <a href="https://www.shiyanlou.com/courses/1322" target="_blank"><i class="fa fa-external-link-square"> 使用指南课程</i></a>。</p>
<pre><code class="hljs python"><span class="hljs-meta"># 在预留的空白单元格中重复输入上面的教学代码练习，亲自动手，不要复制粘贴</span>
</code></pre><p><strong>2. 查看 Pandas 版本信息：</strong></p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(pd.__version__)</span></span>
</code></pre><pre><code class="hljs python">
</code></pre><p>Pandas 的数据结构：Pandas 主要有 Series（一维数组），DataFrame（二维数组），Panel（三维数组），Panel4D（四维数组），PanelND（更多维数组）等数据结构。其中 Series 和 DataFrame 应用的最为广泛。</p>
<ul>
<li>Series 是一维带标签的数组，它可以包含任何数据类型。包括整数，字符串，浮点数，Python 对象等。Series 可以通过标签来定位。</li>
<li>DataFrame 是二维的带标签的数据结构。我们可以通过标签来定位数据。这是 NumPy 所没有的。</li>
</ul>
<h3 id="创建-series-数据类型">创建 Series 数据类型</h3>
<p>Pandas 中，Series 可以被看作由 1 列数据组成的数据集。</p>
<p>创建 Series 语法：<code>s = pd.Series(data, index=index)</code>，可以通过多种方式进行创建，以下介绍了 3 个常用方法。</p>
<p><strong>3. 从列表创建 Series：</strong></p>
<pre><code class="hljs python">arr = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]
s1 = pd.Series(arr)  # 如果不指定索引，则默认从 <span class="hljs-number">0</span> 开始
s1
</code></pre><pre><code class="hljs"><span class="hljs-number">0</span>    <span class="hljs-number">0</span>
<span class="hljs-number">1</span>    <span class="hljs-number">1</span>
<span class="hljs-number">2</span>    <span class="hljs-number">2</span>
<span class="hljs-number">3</span>    <span class="hljs-number">3</span>
<span class="hljs-number">4</span>    <span class="hljs-number">4</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><p>提示：前面的 <code>0, 1, 2, 3, 4</code> 为当前 Series 的索引，后面的 <code>0, 1, 2, 3, 4</code> 为 Series 的值。</p>
<pre><code class="hljs python">
</code></pre><p><strong>4. 从 Ndarray 创建 Series：</strong></p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

n = np.random.randn(<span class="hljs-number">5</span>)  # 创建一个随机 Ndarray 数组

<span class="hljs-keyword">index</span> = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'e'</span>]
s2 = pd.Series(n, <span class="hljs-keyword">index</span>=<span class="hljs-keyword">index</span>)
s2
</code></pre><pre><code class="hljs">a    <span class="hljs-number">1.525729</span>
b    <span class="hljs-number">0.194422</span>
c   <span class="hljs-number">-0.254870</span>
d    <span class="hljs-number">0.954533</span>
e   <span class="hljs-number">-1.154433</span>
dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>5. 从字典创建 Series：</strong></p>
<pre><code class="hljs python">d = {<span class="hljs-string">'a'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>: <span class="hljs-number">2</span>, <span class="hljs-string">'c'</span>: <span class="hljs-number">3</span>, <span class="hljs-string">'d'</span>: <span class="hljs-number">4</span>, <span class="hljs-string">'e'</span>: <span class="hljs-number">5</span>}  <span class="hljs-attr"># 定义示例字典
s3</span> = pd.Series<span class="hljs-comment">(d)</span>
s<span class="hljs-number">3</span>
</code></pre><pre><code class="hljs">a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
d    <span class="hljs-number">4</span>
e    <span class="hljs-number">5</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="series-基本操作">Series 基本操作</h3>
<p><strong>6. 修改 Series 索引：</strong></p>
<pre><code class="hljs python">print(s1)  <span class="hljs-meta"># 以 s1 为例</span>

s1.<span class="hljs-keyword">index</span> = [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>]  <span class="hljs-meta"># 修改后的索引</span>
s1
</code></pre><pre><code class="hljs"><span class="hljs-number">0</span>    <span class="hljs-number">0</span>
<span class="hljs-number">1</span>    <span class="hljs-number">1</span>
<span class="hljs-number">2</span>    <span class="hljs-number">2</span>
<span class="hljs-number">3</span>    <span class="hljs-number">3</span>
<span class="hljs-number">4</span>    <span class="hljs-number">4</span>
dtype: <span class="hljs-built_in">int</span>64





A    <span class="hljs-number">0</span>
B    <span class="hljs-number">1</span>
C    <span class="hljs-number">2</span>
D    <span class="hljs-number">3</span>
E    <span class="hljs-number">4</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>7. Series 纵向拼接：</strong></p>
<pre><code class="hljs python"><span class="hljs-built_in">s4</span> = <span class="hljs-built_in">s3</span>.append(<span class="hljs-built_in">s1</span>)  <span class="hljs-comment"># 将 s1 拼接到 s3</span>
<span class="hljs-built_in">s4</span>
</code></pre><pre><code class="hljs">a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
d    <span class="hljs-number">4</span>
e    <span class="hljs-number">5</span>
A    <span class="hljs-number">0</span>
B    <span class="hljs-number">1</span>
C    <span class="hljs-number">2</span>
D    <span class="hljs-number">3</span>
E    <span class="hljs-number">4</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>8. Series 按指定索引删除元素：</strong></p>
<pre><code class="hljs python">print(<span class="hljs-built_in">s4</span>)
<span class="hljs-built_in">s4</span> = <span class="hljs-built_in">s4</span>.drop(<span class="hljs-string">'e'</span>)  <span class="hljs-comment"># 删除索引为 e 的值</span>
<span class="hljs-built_in">s4</span>
</code></pre><pre><code class="hljs">a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
d    <span class="hljs-number">4</span>
e    <span class="hljs-number">5</span>
A    <span class="hljs-number">0</span>
B    <span class="hljs-number">1</span>
C    <span class="hljs-number">2</span>
D    <span class="hljs-number">3</span>
E    <span class="hljs-number">4</span>
dtype: <span class="hljs-built_in">int</span>64





a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
d    <span class="hljs-number">4</span>
A    <span class="hljs-number">0</span>
B    <span class="hljs-number">1</span>
C    <span class="hljs-number">2</span>
D    <span class="hljs-number">3</span>
E    <span class="hljs-number">4</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>9. Series 修改指定索引元素：</strong></p>
<pre><code class="hljs python"><span class="hljs-built_in">s4</span>[<span class="hljs-string">'A'</span>] = <span class="hljs-number">6</span>  <span class="hljs-comment"># 修改索引为 A 的值 = 6</span>
<span class="hljs-built_in">s4</span>
</code></pre><pre><code class="hljs">a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
d    <span class="hljs-number">4</span>
A    <span class="hljs-number">6</span>
B    <span class="hljs-number">1</span>
C    <span class="hljs-number">2</span>
D    <span class="hljs-number">3</span>
E    <span class="hljs-number">4</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>10. Series 按指定索引查找元素：</strong></p>
<pre><code class="hljs python">s4[<span class="hljs-string">'B'</span>]
</code></pre><pre><code class="hljs"><span class="hljs-number">1</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>11. Series 切片操作：</strong></p>
<p>例如对<code>s4</code>的前 3 个数据访问</p>
<pre><code class="hljs python">s4<span class="hljs-string">[:3]</span>
</code></pre><pre><code class="hljs">a    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>
c    <span class="hljs-number">3</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="series-运算">Series 运算</h3>
<p><strong>12. Series 加法运算：</strong></p>
<p>Series 的加法运算是按照索引计算，如果索引不同则填充为 <code>NaN</code>（空值）。</p>
<pre><code class="hljs python">s4.<span class="hljs-builtin-name">add</span>(s3)
</code></pre><pre><code class="hljs"><span class="hljs-attr">A</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">B</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">C</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">D</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">E</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">a</span>    <span class="hljs-string">2.0</span>
<span class="hljs-attr">b</span>    <span class="hljs-string">4.0</span>
<span class="hljs-attr">c</span>    <span class="hljs-string">6.0</span>
<span class="hljs-attr">d</span>    <span class="hljs-string">8.0</span>
<span class="hljs-attr">e</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">dtype</span>: <span class="hljs-string">float64</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>13. Series 减法运算：</strong></p>
<p>Series的减法运算是按照索引对应计算，如果不同则填充为 <code>NaN</code>（空值）。</p>
<pre><code class="hljs python">s<span class="hljs-number">4.</span><span class="hljs-keyword">sub</span><span class="hljs-comment">(s3)</span>
</code></pre><pre><code class="hljs"><span class="hljs-attr">A</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">B</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">C</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">D</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">E</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">a</span>    <span class="hljs-string">0.0</span>
<span class="hljs-attr">b</span>    <span class="hljs-string">0.0</span>
<span class="hljs-attr">c</span>    <span class="hljs-string">0.0</span>
<span class="hljs-attr">d</span>    <span class="hljs-string">0.0</span>
<span class="hljs-attr">e</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">dtype</span>: <span class="hljs-string">float64</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>14. Series 乘法运算：</strong></p>
<p>Series 的乘法运算是按照索引对应计算，如果索引不同则填充为 <code>NaN</code>（空值）。</p>
<pre><code class="hljs python"><span class="hljs-symbol">s4.mul</span>(<span class="hljs-built_in">s3</span>)
</code></pre><pre><code class="hljs"><span class="hljs-attr">A</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">B</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">C</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">D</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">E</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">a</span>     <span class="hljs-string">1.0</span>
<span class="hljs-attr">b</span>     <span class="hljs-string">4.0</span>
<span class="hljs-attr">c</span>     <span class="hljs-string">9.0</span>
<span class="hljs-attr">d</span>    <span class="hljs-string">16.0</span>
<span class="hljs-attr">e</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">dtype</span>: <span class="hljs-string">float64</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>15. Series 除法运算：</strong></p>
<p>Series 的除法运算是按照索引对应计算，如果索引不同则填充为 <code>NaN</code>（空值）。</p>
<pre><code class="hljs python">s4.<span class="hljs-keyword">div</span>(s3)
</code></pre><pre><code class="hljs"><span class="hljs-attr">A</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">B</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">C</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">D</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">E</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">a</span>    <span class="hljs-string">1.0</span>
<span class="hljs-attr">b</span>    <span class="hljs-string">1.0</span>
<span class="hljs-attr">c</span>    <span class="hljs-string">1.0</span>
<span class="hljs-attr">d</span>    <span class="hljs-string">1.0</span>
<span class="hljs-attr">e</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">dtype</span>: <span class="hljs-string">float64</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>16. Series 求中位数：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">s4</span><span class="hljs-selector-class">.median</span>()
</code></pre><pre><code class="hljs"><span class="hljs-number">3.0</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>17. Series 求和：</strong></p>
<pre><code class="hljs python">s4.<span class="hljs-keyword">sum</span>()
</code></pre><pre><code class="hljs"><span class="hljs-number">26</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>18. Series 求最大值：</strong></p>
<pre><code class="hljs python">s4.<span class="hljs-built_in">max</span>()
</code></pre><pre><code class="hljs"><span class="hljs-number">6</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>19. Series 求最小值：</strong></p>
<pre><code class="hljs python">s4.<span class="hljs-built_in">min</span>()
</code></pre><pre><code class="hljs"><span class="hljs-number">1</span>
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="创建-dataframe-数据类型">创建 DataFrame 数据类型</h3>
<p>与 Sereis 不同，DataFrame 可以存在多列数据。一般情况下，DataFrame 也更加常用。</p>
<p><strong>20. 通过 NumPy 数组创建 DataFrame：</strong></p>
<pre><code class="hljs python">dates = pd.date_range('today', periods=6)  <span class="hljs-comment"># 定义时间序列作为 index</span>
num_arr = np.random.randn(6, 4)  <span class="hljs-comment"># 传入 numpy 随机数组</span>
columns = ['A', 'B', 'C', 'D']  <span class="hljs-comment"># 将列表作为列名</span>
df1 = pd.DataFrame(num_arr, index=dates, columns=columns)
df1
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-11-13 06:41:53.289798</th>
      <td>0.366441</td>
      <td>-0.766434</td>
      <td>-0.743727</td>
      <td>0.510955</td>
    </tr>
    <tr>
      <th>2019-11-14 06:41:53.289798</th>
      <td>-0.648361</td>
      <td>1.402561</td>
      <td>0.592287</td>
      <td>-0.607854</td>
    </tr>
    <tr>
      <th>2019-11-15 06:41:53.289798</th>
      <td>0.665118</td>
      <td>-0.570004</td>
      <td>1.063785</td>
      <td>-0.175433</td>
    </tr>
    <tr>
      <th>2019-11-16 06:41:53.289798</th>
      <td>0.717640</td>
      <td>-0.579141</td>
      <td>-0.346500</td>
      <td>0.592020</td>
    </tr>
    <tr>
      <th>2019-11-17 06:41:53.289798</th>
      <td>2.423811</td>
      <td>-0.770996</td>
      <td>-0.717726</td>
      <td>-0.282303</td>
    </tr>
    <tr>
      <th>2019-11-18 06:41:53.289798</th>
      <td>-1.852933</td>
      <td>0.307735</td>
      <td>1.603790</td>
      <td>-0.809295</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>21. 通过字典数组创建 DataFrame：</strong></p>
<pre><code class="hljs python">data = {<span class="hljs-string">'animal'</span>: [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'snake'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'snake'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'dog'</span>],
        <span class="hljs-string">'age'</span>: [<span class="hljs-number">2.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0.5</span>, np.nan, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4.5</span>, np.nan, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>],
        <span class="hljs-string">'visits'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],
        <span class="hljs-string">'priority'</span>: [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'no'</span>]}

labels = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'e'</span>, <span class="hljs-string">'f'</span>, <span class="hljs-string">'g'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'i'</span>, <span class="hljs-string">'j'</span>]
df2 = pd.<span class="hljs-symbol">DataFrame</span>(data, index=labels)
df2
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>no</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>22. 查看 DataFrame 的数据类型：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df2</span><span class="hljs-selector-class">.dtypes</span>
</code></pre><pre><code class="hljs">animal       <span class="hljs-keyword">object</span>
age         <span class="hljs-built_in">float64</span>
visits        <span class="hljs-built_in">int64</span>
priority     <span class="hljs-keyword">object</span>
dtype: <span class="hljs-keyword">object</span>
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="dataframe-基本操作">DataFrame 基本操作</h3>
<p><strong>23. 预览 DataFrame 的前 5 行数据：</strong></p>
<p>此方法对快速了解陌生数据集结构十分有用。</p>
<pre><code class="hljs python">df<span class="hljs-number">2.</span>head<span class="hljs-comment">()</span>  <span class="hljs-attr"># 默认为显示 5</span> 行，可根据需要在括号中填入希望预览的行数
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>24. 查看 DataFrame 的后 3 行数据：</strong></p>
<pre><code class="hljs python">df2.tail(<span class="hljs-number">3</span>)
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>25.查看 DataFrame 的索引：</strong></p>
<pre><code class="hljs python">df2.<span class="hljs-keyword">index</span>
</code></pre><pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">Index</span><span class="hljs-params">([<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'e'</span>, <span class="hljs-string">'f'</span>, <span class="hljs-string">'g'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'i'</span>, <span class="hljs-string">'j'</span>], dtype=<span class="hljs-string">'object'</span>)</span></span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>26. 查看 DataFrame 的列名：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df2</span><span class="hljs-selector-class">.columns</span>
</code></pre><pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">Index</span><span class="hljs-params">([<span class="hljs-string">'animal'</span>, <span class="hljs-string">'age'</span>, <span class="hljs-string">'visits'</span>, <span class="hljs-string">'priority'</span>], dtype=<span class="hljs-string">'object'</span>)</span></span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>27. 查看 DataFrame 的数值：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df2</span><span class="hljs-selector-class">.values</span>
</code></pre><pre><code class="hljs">array([[<span class="hljs-string">'cat'</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'yes'</span>],
       [<span class="hljs-string">'cat'</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">3</span>, <span class="hljs-string">'yes'</span>],
       [<span class="hljs-string">'snake'</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'no'</span>],
       [<span class="hljs-string">'dog'</span>, nan, <span class="hljs-number">3</span>, <span class="hljs-string">'yes'</span>],
       [<span class="hljs-string">'dog'</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'no'</span>],
       [<span class="hljs-string">'cat'</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3</span>, <span class="hljs-string">'no'</span>],
       [<span class="hljs-string">'snake'</span>, <span class="hljs-number">4.5</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'no'</span>],
       [<span class="hljs-string">'cat'</span>, nan, <span class="hljs-number">1</span>, <span class="hljs-string">'yes'</span>],
       [<span class="hljs-string">'dog'</span>, <span class="hljs-number">7.0</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'no'</span>],
       [<span class="hljs-string">'dog'</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'no'</span>]], dtype=object)
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>28. 查看 DataFrame 的统计数据：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df2</span><span class="hljs-selector-class">.describe</span>()
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>age</th>
      <th>visits</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8.000000</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.437500</td>
      <td>1.900000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.007797</td>
      <td>0.875595</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.500000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.375000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.625000</td>
      <td>2.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>29. DataFrame 转置操作：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df2</span><span class="hljs-selector-class">.T</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
      <th>g</th>
      <th>h</th>
      <th>i</th>
      <th>j</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>animal</th>
      <td>cat</td>
      <td>cat</td>
      <td>snake</td>
      <td>dog</td>
      <td>dog</td>
      <td>cat</td>
      <td>snake</td>
      <td>cat</td>
      <td>dog</td>
      <td>dog</td>
    </tr>
    <tr>
      <th>age</th>
      <td>2.5</td>
      <td>3</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>5</td>
      <td>2</td>
      <td>4.5</td>
      <td>NaN</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>visits</th>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>priority</th>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>30. 对 DataFrame 进行按列排序：</strong></p>
<pre><code class="hljs python">df2.sort_values(<span class="hljs-keyword">by</span>=<span class="hljs-string">'age'</span>)  <span class="hljs-meta"># 按 age 升序排列</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>no</td>
    </tr>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>31. 对 DataFrame 数据切片：</strong></p>
<pre><code class="hljs python">df2[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>32. 对 DataFrame 通过标签查询（单列）：</strong></p>
<pre><code class="hljs python">df2[<span class="hljs-string">'age'</span>]
</code></pre><pre><code class="hljs"><span class="hljs-attr">a</span>    <span class="hljs-string">2.5</span>
<span class="hljs-attr">b</span>    <span class="hljs-string">3.0</span>
<span class="hljs-attr">c</span>    <span class="hljs-string">0.5</span>
<span class="hljs-attr">d</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">e</span>    <span class="hljs-string">5.0</span>
<span class="hljs-attr">f</span>    <span class="hljs-string">2.0</span>
<span class="hljs-attr">g</span>    <span class="hljs-string">4.5</span>
<span class="hljs-attr">h</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">i</span>    <span class="hljs-string">7.0</span>
<span class="hljs-attr">j</span>    <span class="hljs-string">3.0</span>
<span class="hljs-attr">Name</span>: <span class="hljs-string">age, dtype: float64</span>
</code></pre><pre><code class="hljs python">
</code></pre><pre><code class="hljs python">df2.age  <span class="hljs-meta"># 等价于 df2[<span class="hljs-string">'age'</span>]</span>
</code></pre><pre><code class="hljs"><span class="hljs-attr">a</span>    <span class="hljs-string">2.5</span>
<span class="hljs-attr">b</span>    <span class="hljs-string">3.0</span>
<span class="hljs-attr">c</span>    <span class="hljs-string">0.5</span>
<span class="hljs-attr">d</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">e</span>    <span class="hljs-string">5.0</span>
<span class="hljs-attr">f</span>    <span class="hljs-string">2.0</span>
<span class="hljs-attr">g</span>    <span class="hljs-string">4.5</span>
<span class="hljs-attr">h</span>    <span class="hljs-string">NaN</span>
<span class="hljs-attr">i</span>    <span class="hljs-string">7.0</span>
<span class="hljs-attr">j</span>    <span class="hljs-string">3.0</span>
<span class="hljs-attr">Name</span>: <span class="hljs-string">age, dtype: float64</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>33. 对 DataFrame 通过标签查询（多列）：</strong></p>
<pre><code class="hljs python">df2<span class="hljs-string">[['age', 'animal']]</span>  # 传入一个列名组成的列表
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>age</th>
      <th>animal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>2.5</td>
      <td>cat</td>
    </tr>
    <tr>
      <th>b</th>
      <td>3.0</td>
      <td>cat</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.5</td>
      <td>snake</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>dog</td>
    </tr>
    <tr>
      <th>e</th>
      <td>5.0</td>
      <td>dog</td>
    </tr>
    <tr>
      <th>f</th>
      <td>2.0</td>
      <td>cat</td>
    </tr>
    <tr>
      <th>g</th>
      <td>4.5</td>
      <td>snake</td>
    </tr>
    <tr>
      <th>h</th>
      <td>NaN</td>
      <td>cat</td>
    </tr>
    <tr>
      <th>i</th>
      <td>7.0</td>
      <td>dog</td>
    </tr>
    <tr>
      <th>j</th>
      <td>3.0</td>
      <td>dog</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>34. 对 DataFrame 通过位置查询：</strong></p>
<pre><code class="hljs python">df2.iloc[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]  # 查询 <span class="hljs-number">2</span>，<span class="hljs-number">3</span> 行
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>35. DataFrame 副本拷贝：</strong></p>
<pre><code class="hljs python"><span class="hljs-comment"># 生成 DataFrame 副本，方便数据集被多个不同流程使用</span>
df3 = df2.copy()
df3
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>no</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>36. 判断 DataFrame 元素是否为空：</strong></p>
<pre><code class="hljs python">df3.isnull()  # 如果为空则返回为 <span class="hljs-literal">True</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>b</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>c</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>d</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>e</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>f</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>g</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>h</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>i</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>j</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>37. 添加列数据：</strong></p>
<pre><code class="hljs python">num = pd.Series([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>], index=df3.index)

df3[<span class="hljs-string">'No.'</span>] = num  # 添加以 <span class="hljs-string">'No.'</span> 为列名的新数据列
df3
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
      <td>3</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
      <td>6</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
      <td>7</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>38. 根据 DataFrame 的下标值进行更改。：</strong></p>
<pre><code class="hljs python"># 修改第 <span class="hljs-number">2</span> 行与第 <span class="hljs-number">2</span> 列对应的值 <span class="hljs-number">3.0</span> → <span class="hljs-number">2.0</span>
df3.iat[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] = <span class="hljs-number">2</span>  # 索引序号从 <span class="hljs-number">0</span> 开始，这里为 <span class="hljs-number">1</span>, <span class="hljs-number">1</span>
df3
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
      <td>3</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
      <td>6</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
      <td>7</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>39. 根据 DataFrame 的标签对数据进行修改：</strong></p>
<pre><code class="hljs python">df3<span class="hljs-selector-class">.loc</span>[<span class="hljs-string">'f'</span>, <span class="hljs-string">'age'</span>] = <span class="hljs-number">1.5</span>
df3
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
      <td>3</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>1.5</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
      <td>6</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
      <td>7</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>40. DataFrame 求平均值操作：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df3</span><span class="hljs-selector-class">.mean</span>()
</code></pre><pre><code class="hljs">age       <span class="hljs-number">3.25</span>
visits    <span class="hljs-number">1.90</span>
No.       <span class="hljs-number">4.50</span>
dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>41. 对 DataFrame 中任意列做求和操作：</strong></p>
<pre><code class="hljs python">df3[<span class="hljs-string">'visits'</span>].<span class="hljs-keyword">sum</span>()
</code></pre><pre><code class="hljs"><span class="hljs-number">19</span>
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="字符串操作">字符串操作</h3>
<p><strong>42. 将字符串转化为小写字母：</strong></p>
<pre><code class="hljs python">string = pd.Series([<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'Aaba'</span>, <span class="hljs-string">'Baca'</span>,
                    np<span class="hljs-selector-class">.nan</span>, <span class="hljs-string">'CABA'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'cat'</span>])
<span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(string)</span></span>
string<span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.lower</span>()
</code></pre><pre><code class="hljs"><span class="hljs-attr">0</span>       <span class="hljs-string">A</span>
<span class="hljs-attr">1</span>       <span class="hljs-string">B</span>
<span class="hljs-attr">2</span>       <span class="hljs-string">C</span>
<span class="hljs-attr">3</span>    <span class="hljs-string">Aaba</span>
<span class="hljs-attr">4</span>    <span class="hljs-string">Baca</span>
<span class="hljs-attr">5</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">6</span>    <span class="hljs-string">CABA</span>
<span class="hljs-attr">7</span>     <span class="hljs-string">dog</span>
<span class="hljs-attr">8</span>     <span class="hljs-string">cat</span>
<span class="hljs-attr">dtype</span>: <span class="hljs-string">object</span>





<span class="hljs-attr">0</span>       <span class="hljs-string">a</span>
<span class="hljs-attr">1</span>       <span class="hljs-string">b</span>
<span class="hljs-attr">2</span>       <span class="hljs-string">c</span>
<span class="hljs-attr">3</span>    <span class="hljs-string">aaba</span>
<span class="hljs-attr">4</span>    <span class="hljs-string">baca</span>
<span class="hljs-attr">5</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">6</span>    <span class="hljs-string">caba</span>
<span class="hljs-attr">7</span>     <span class="hljs-string">dog</span>
<span class="hljs-attr">8</span>     <span class="hljs-string">cat</span>
<span class="hljs-attr">dtype</span>: <span class="hljs-string">object</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>43. 将字符串转化为大写字母：</strong></p>
<pre><code class="hljs python">string<span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.upper</span>()
</code></pre><pre><code class="hljs"><span class="hljs-attr">0</span>       <span class="hljs-string">A</span>
<span class="hljs-attr">1</span>       <span class="hljs-string">B</span>
<span class="hljs-attr">2</span>       <span class="hljs-string">C</span>
<span class="hljs-attr">3</span>    <span class="hljs-string">AABA</span>
<span class="hljs-attr">4</span>    <span class="hljs-string">BACA</span>
<span class="hljs-attr">5</span>     <span class="hljs-string">NaN</span>
<span class="hljs-attr">6</span>    <span class="hljs-string">CABA</span>
<span class="hljs-attr">7</span>     <span class="hljs-string">DOG</span>
<span class="hljs-attr">8</span>     <span class="hljs-string">CAT</span>
<span class="hljs-attr">dtype</span>: <span class="hljs-string">object</span>
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="dataframe-缺失值操作">DataFrame 缺失值操作</h3>
<p><strong>44. 对缺失值进行填充：</strong></p>
<pre><code class="hljs python">df4 = df3.copy()
<span class="hljs-builtin-name">print</span>(df4)
df4.fillna(<span class="hljs-attribute">value</span>=3)
</code></pre><pre><code class="hljs">  animal  age  visits priority  No.
a    cat  <span class="hljs-number">2.5</span>       <span class="hljs-number">1</span>      yes    <span class="hljs-number">0</span>
b    cat  <span class="hljs-number">2.0</span>       <span class="hljs-number">3</span>      yes    <span class="hljs-number">1</span>
c  snake  <span class="hljs-number">0.5</span>       <span class="hljs-number">2</span>       no    <span class="hljs-number">2</span>
d    dog  NaN       <span class="hljs-number">3</span>      yes    <span class="hljs-number">3</span>
e    dog  <span class="hljs-number">5.0</span>       <span class="hljs-number">2</span>       no    <span class="hljs-number">4</span>
f    cat  <span class="hljs-number">1.5</span>       <span class="hljs-number">3</span>       no    <span class="hljs-number">5</span>
g  snake  <span class="hljs-number">4.5</span>       <span class="hljs-number">1</span>       no    <span class="hljs-number">6</span>
h    cat  NaN       <span class="hljs-number">1</span>      yes    <span class="hljs-number">7</span>
i    dog  <span class="hljs-number">7.0</span>       <span class="hljs-number">2</span>       no    <span class="hljs-number">8</span>
j    dog  <span class="hljs-number">3.0</span>       <span class="hljs-number">1</span>       no    <span class="hljs-number">9</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
      <td>3</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>1.5</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
      <td>6</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>3.0</td>
      <td>1</td>
      <td>yes</td>
      <td>7</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>45. 删除存在缺失值的行：</strong></p>
<pre><code class="hljs python">df5 = df3.copy()
<span class="hljs-builtin-name">print</span>(df5)
df5.dropna(<span class="hljs-attribute">how</span>=<span class="hljs-string">'any'</span>)  # 任何存在 NaN 的行都将被删除
</code></pre><pre><code class="hljs">  animal  age  visits priority  No.
a    cat  <span class="hljs-number">2.5</span>       <span class="hljs-number">1</span>      yes    <span class="hljs-number">0</span>
b    cat  <span class="hljs-number">2.0</span>       <span class="hljs-number">3</span>      yes    <span class="hljs-number">1</span>
c  snake  <span class="hljs-number">0.5</span>       <span class="hljs-number">2</span>       no    <span class="hljs-number">2</span>
d    dog  NaN       <span class="hljs-number">3</span>      yes    <span class="hljs-number">3</span>
e    dog  <span class="hljs-number">5.0</span>       <span class="hljs-number">2</span>       no    <span class="hljs-number">4</span>
f    cat  <span class="hljs-number">1.5</span>       <span class="hljs-number">3</span>       no    <span class="hljs-number">5</span>
g  snake  <span class="hljs-number">4.5</span>       <span class="hljs-number">1</span>       no    <span class="hljs-number">6</span>
h    cat  NaN       <span class="hljs-number">1</span>      yes    <span class="hljs-number">7</span>
i    dog  <span class="hljs-number">7.0</span>       <span class="hljs-number">2</span>       no    <span class="hljs-number">8</span>
j    dog  <span class="hljs-number">3.0</span>       <span class="hljs-number">1</span>       no    <span class="hljs-number">9</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
      <td>2</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>1.5</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
      <td>6</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>46. DataFrame 按指定列对齐：</strong></p>
<pre><code class="hljs python"><span class="hljs-literal">left</span> = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'foo1'</span>, <span class="hljs-string">'foo2'</span>], <span class="hljs-string">'one'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]})
<span class="hljs-literal">right</span> = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'foo2'</span>, <span class="hljs-string">'foo3'</span>], <span class="hljs-string">'two'</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>]})

<span class="hljs-literal">print</span>(<span class="hljs-literal">left</span>)
<span class="hljs-literal">print</span>(<span class="hljs-literal">right</span>)

<span class="hljs-comment"># 按照 key 列对齐连接，只存在 foo2 相同，所以最后变成一行</span>
pd.merge(<span class="hljs-literal">left</span>, <span class="hljs-literal">right</span>, <span class="hljs-literal">on</span>=<span class="hljs-string">'key'</span>)
</code></pre><pre><code class="hljs">    <span class="hljs-type">key</span>  one
<span class="hljs-number">0</span>  foo1    <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  foo2    <span class="hljs-number">2</span>
    <span class="hljs-type">key</span>  two
<span class="hljs-number">0</span>  foo2    <span class="hljs-number">4</span>
<span class="hljs-number">1</span>  foo3    <span class="hljs-number">5</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>key</th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo2</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><h3 id="dataframe-文件操作">DataFrame 文件操作</h3>
<p><strong>47. CSV 文件写入：</strong></p>
<pre><code class="hljs python">df3.<span class="hljs-keyword">to</span><span class="hljs-constructor">_csv('<span class="hljs-params">animal</span>.<span class="hljs-params">csv</span>')</span>
print(<span class="hljs-string">"写入成功."</span>)
</code></pre><pre><code class="hljs">写入成功.
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>48. CSV 文件读取：</strong></p>
<pre><code class="hljs python">df_animal = pd.read<span class="hljs-constructor">_csv('<span class="hljs-params">animal</span>.<span class="hljs-params">csv</span>')</span>
df_animal
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>d</td>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>e</td>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f</td>
      <td>cat</td>
      <td>1.5</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>g</td>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>h</td>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>i</td>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>j</td>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>49. Excel 写入操作：</strong></p>
<pre><code class="hljs python">df3.<span class="hljs-keyword">to</span><span class="hljs-constructor">_excel('<span class="hljs-params">animal</span>.<span class="hljs-params">xlsx</span>', <span class="hljs-params">sheet_name</span>='Sheet1')</span>
print(<span class="hljs-string">"写入成功."</span>)
</code></pre><pre><code class="hljs">写入成功.
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>50. Excel 读取操作：</strong></p>
<pre><code class="hljs python">pd.read<span class="hljs-constructor">_excel('<span class="hljs-params">animal</span>.<span class="hljs-params">xlsx</span>', 'Sheet1', <span class="hljs-params">index_col</span>=None, <span class="hljs-params">na_values</span>=['NA'])</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>d</td>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>e</td>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f</td>
      <td>cat</td>
      <td>1.5</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>g</td>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>h</td>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>i</td>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>j</td>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><h3 id="进阶部分">进阶部分</h3>
<h3 id="时间序列索引">时间序列索引</h3>
<p><strong>51. 建立一个以 2018 年每一天为索引，值为随机数的 Series：</strong></p>
<pre><code class="hljs python">dti = pd.date_range(<span class="hljs-attribute">start</span>=<span class="hljs-string">'2018-01-01'</span>, <span class="hljs-attribute">end</span>=<span class="hljs-string">'2018-12-31'</span>, <span class="hljs-attribute">freq</span>=<span class="hljs-string">'D'</span>)
s = pd.Series(np.random.rand(len(dti)), <span class="hljs-attribute">index</span>=dti)
s
</code></pre><pre><code class="hljs"><span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-01</span>    <span class="hljs-number">0.991481</span>
<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-02</span>    <span class="hljs-number">0.988274</span>
<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-03</span>    <span class="hljs-number">0.013988</span>
<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-04</span>    <span class="hljs-number">0.143980</span>
<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-05</span>    <span class="hljs-number">0.951515</span>
                ...   
<span class="hljs-number">2018</span><span class="hljs-number">-12</span><span class="hljs-number">-27</span>    <span class="hljs-number">0.994144</span>
<span class="hljs-number">2018</span><span class="hljs-number">-12</span><span class="hljs-number">-28</span>    <span class="hljs-number">0.892863</span>
<span class="hljs-number">2018</span><span class="hljs-number">-12</span><span class="hljs-number">-29</span>    <span class="hljs-number">0.005812</span>
<span class="hljs-number">2018</span><span class="hljs-number">-12</span><span class="hljs-number">-30</span>    <span class="hljs-number">0.307693</span>
<span class="hljs-number">2018</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.768305</span>
Freq: D, Length: <span class="hljs-number">365</span>, dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>52. 统计<code>s</code> 中每一个周三对应值的和：</strong></p>
<pre><code class="hljs python"><span class="hljs-meta"># 周一从 0 开始</span>
s[s.<span class="hljs-keyword">index</span>.weekday == <span class="hljs-number">2</span>].<span class="hljs-keyword">sum</span>()
</code></pre><pre><code class="hljs"><span class="hljs-number">29.352512050028086</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>53. 统计<code>s</code>中每个月值的平均值：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">s</span><span class="hljs-selector-class">.resample</span>(<span class="hljs-string">'M'</span>)<span class="hljs-selector-class">.mean</span>()
</code></pre><pre><code class="hljs"><span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.568715</span>
<span class="hljs-number">2018</span><span class="hljs-number">-02</span><span class="hljs-number">-28</span>    <span class="hljs-number">0.474804</span>
<span class="hljs-number">2018</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.556370</span>
<span class="hljs-number">2018</span><span class="hljs-number">-04</span><span class="hljs-number">-30</span>    <span class="hljs-number">0.450867</span>
<span class="hljs-number">2018</span><span class="hljs-number">-05</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.588701</span>
<span class="hljs-number">2018</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>    <span class="hljs-number">0.483388</span>
<span class="hljs-number">2018</span><span class="hljs-number">-07</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.584717</span>
<span class="hljs-number">2018</span><span class="hljs-number">-08</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.539294</span>
<span class="hljs-number">2018</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>    <span class="hljs-number">0.474815</span>
<span class="hljs-number">2018</span><span class="hljs-number">-10</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.569529</span>
<span class="hljs-number">2018</span><span class="hljs-number">-11</span><span class="hljs-number">-30</span>    <span class="hljs-number">0.562296</span>
<span class="hljs-number">2018</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.509720</span>
Freq: M, dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>54. 将 Series 中的时间进行转换（秒转分钟）：</strong></p>
<pre><code class="hljs python">s = pd.date<span class="hljs-constructor">_range('<span class="hljs-params">today</span>', <span class="hljs-params">periods</span>=100, <span class="hljs-params">freq</span>='S')</span>

ts = pd.<span class="hljs-constructor">Series(<span class="hljs-params">np</span>.<span class="hljs-params">random</span>.<span class="hljs-params">randint</span>(0, 500, <span class="hljs-params">len</span>(<span class="hljs-params">s</span>)</span>), index=s)

ts.resample('Min').sum<span class="hljs-literal">()</span>
</code></pre><pre><code class="hljs"><span class="hljs-number">2019</span><span class="hljs-number">-11</span><span class="hljs-number">-13</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">00</span>     <span class="hljs-number">1218</span>
<span class="hljs-number">2019</span><span class="hljs-number">-11</span><span class="hljs-number">-13</span> <span class="hljs-number">06</span>:<span class="hljs-number">42</span>:<span class="hljs-number">00</span>    <span class="hljs-number">13599</span>
<span class="hljs-number">2019</span><span class="hljs-number">-11</span><span class="hljs-number">-13</span> <span class="hljs-number">06</span>:<span class="hljs-number">43</span>:<span class="hljs-number">00</span>     <span class="hljs-number">9525</span>
Freq: T, dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>55. UTC 世界时间标准：</strong></p>
<pre><code class="hljs python">s = pd.date<span class="hljs-constructor">_range('<span class="hljs-params">today</span>', <span class="hljs-params">periods</span>=1, <span class="hljs-params">freq</span>='D')</span>  # 获取当前时间
ts = pd.<span class="hljs-constructor">Series(<span class="hljs-params">np</span>.<span class="hljs-params">random</span>.<span class="hljs-params">randn</span>(<span class="hljs-params">len</span>(<span class="hljs-params">s</span>)</span>), s)  # 随机数值
ts_utc = ts.tz<span class="hljs-constructor">_localize('UTC')</span>  # 转换为 UTC 时间
ts_utc
</code></pre><pre><code class="hljs"><span class="hljs-number">2019</span><span class="hljs-number">-11</span><span class="hljs-number">-13</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">54.143158</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span>    <span class="hljs-number">2.453661</span>
Freq: D, dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>56. 转换为上海所在时区：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">ts_utc</span><span class="hljs-selector-class">.tz_convert</span>(<span class="hljs-string">'Asia/Shanghai'</span>)
</code></pre><pre><code class="hljs"><span class="hljs-number">2019</span><span class="hljs-number">-11</span><span class="hljs-number">-13</span> <span class="hljs-number">14</span>:<span class="hljs-number">41</span>:<span class="hljs-number">54.143158</span>+<span class="hljs-number">08</span>:<span class="hljs-number">00</span>    <span class="hljs-number">2.453661</span>
Freq: D, dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p>看一看你当前的时间，是不是一致？</p>
<p><strong>57.不同时间表示方式的转换：</strong></p>
<pre><code class="hljs python">rng = pd.date<span class="hljs-constructor">_range('1<span class="hljs-operator">/</span>1<span class="hljs-operator">/</span>2018', <span class="hljs-params">periods</span>=5, <span class="hljs-params">freq</span>='M')</span>
ts = pd.<span class="hljs-constructor">Series(<span class="hljs-params">np</span>.<span class="hljs-params">random</span>.<span class="hljs-params">randn</span>(<span class="hljs-params">len</span>(<span class="hljs-params">rng</span>)</span>), index=rng)
print(ts)
ps = ts.<span class="hljs-keyword">to</span><span class="hljs-constructor">_period()</span>
print(ps)
ps.<span class="hljs-keyword">to</span><span class="hljs-constructor">_timestamp()</span>
</code></pre><pre><code class="hljs"><span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-31</span>   <span class="hljs-number">-1.522708</span>
<span class="hljs-number">2018</span><span class="hljs-number">-02</span><span class="hljs-number">-28</span>   <span class="hljs-number">-0.495813</span>
<span class="hljs-number">2018</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.914070</span>
<span class="hljs-number">2018</span><span class="hljs-number">-04</span><span class="hljs-number">-30</span>    <span class="hljs-number">0.676996</span>
<span class="hljs-number">2018</span><span class="hljs-number">-05</span><span class="hljs-number">-31</span>    <span class="hljs-number">0.136920</span>
Freq: M, dtype: <span class="hljs-built_in">float</span>64
<span class="hljs-number">2018</span><span class="hljs-number">-01</span>   <span class="hljs-number">-1.522708</span>
<span class="hljs-number">2018</span><span class="hljs-number">-02</span>   <span class="hljs-number">-0.495813</span>
<span class="hljs-number">2018</span><span class="hljs-number">-03</span>    <span class="hljs-number">0.914070</span>
<span class="hljs-number">2018</span><span class="hljs-number">-04</span>    <span class="hljs-number">0.676996</span>
<span class="hljs-number">2018</span><span class="hljs-number">-05</span>    <span class="hljs-number">0.136920</span>
Freq: M, dtype: <span class="hljs-built_in">float</span>64





<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-01</span>   <span class="hljs-number">-1.522708</span>
<span class="hljs-number">2018</span><span class="hljs-number">-02</span><span class="hljs-number">-01</span>   <span class="hljs-number">-0.495813</span>
<span class="hljs-number">2018</span><span class="hljs-number">-03</span><span class="hljs-number">-01</span>    <span class="hljs-number">0.914070</span>
<span class="hljs-number">2018</span><span class="hljs-number">-04</span><span class="hljs-number">-01</span>    <span class="hljs-number">0.676996</span>
<span class="hljs-number">2018</span><span class="hljs-number">-05</span><span class="hljs-number">-01</span>    <span class="hljs-number">0.136920</span>
Freq: MS, dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="series-多重索引">Series 多重索引</h3>
<p><strong>58. 创建多重索引 Series：</strong></p>
<p>构建一个 <code>letters = ['A', 'B', 'C']</code> 和 <code>numbers = list(range(10))</code>为索引，值为随机数的多重索引 Series。</p>
<pre><code class="hljs python">letters = ['A', 'B', 'C']
numbers = list(range(10))

mi = pd.MultiIndex.from_product([letters, numbers])  <span class="hljs-comment"># 设置多重索引</span>
s = pd.Series(np.random.rand(30), index=mi)  <span class="hljs-comment"># 随机数</span>
s
</code></pre><pre><code class="hljs">A  <span class="hljs-number">0</span>    <span class="hljs-number">0.581028</span>
   <span class="hljs-number">1</span>    <span class="hljs-number">0.915796</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.361079</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.659616</span>
   <span class="hljs-number">4</span>    <span class="hljs-number">0.432175</span>
   <span class="hljs-number">5</span>    <span class="hljs-number">0.069876</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.534347</span>
   <span class="hljs-number">7</span>    <span class="hljs-number">0.414391</span>
   <span class="hljs-number">8</span>    <span class="hljs-number">0.172693</span>
   <span class="hljs-number">9</span>    <span class="hljs-number">0.728719</span>
B  <span class="hljs-number">0</span>    <span class="hljs-number">0.200480</span>
   <span class="hljs-number">1</span>    <span class="hljs-number">0.868427</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.829001</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.854959</span>
   <span class="hljs-number">4</span>    <span class="hljs-number">0.958170</span>
   <span class="hljs-number">5</span>    <span class="hljs-number">0.789500</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.114575</span>
   <span class="hljs-number">7</span>    <span class="hljs-number">0.597118</span>
   <span class="hljs-number">8</span>    <span class="hljs-number">0.511793</span>
   <span class="hljs-number">9</span>    <span class="hljs-number">0.998563</span>
C  <span class="hljs-number">0</span>    <span class="hljs-number">0.921726</span>
   <span class="hljs-number">1</span>    <span class="hljs-number">0.778926</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.918187</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.137094</span>
   <span class="hljs-number">4</span>    <span class="hljs-number">0.523859</span>
   <span class="hljs-number">5</span>    <span class="hljs-number">0.547756</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.410537</span>
   <span class="hljs-number">7</span>    <span class="hljs-number">0.491586</span>
   <span class="hljs-number">8</span>    <span class="hljs-number">0.654941</span>
   <span class="hljs-number">9</span>    <span class="hljs-number">0.726480</span>
dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>59. 多重索引 Series 查询：</strong></p>
<pre><code class="hljs python"># 查询索引为 <span class="hljs-number">1</span>，<span class="hljs-number">3</span>，<span class="hljs-number">6</span> 的值
s.loc[:, [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>]]
</code></pre><pre><code class="hljs">A  <span class="hljs-number">1</span>    <span class="hljs-number">0.915796</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.659616</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.534347</span>
B  <span class="hljs-number">1</span>    <span class="hljs-number">0.868427</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.854959</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.114575</span>
C  <span class="hljs-number">1</span>    <span class="hljs-number">0.778926</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.137094</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.410537</span>
dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>60. 多重索引 Series 切片：</strong></p>
<pre><code class="hljs python">s<span class="hljs-selector-class">.loc</span>[pd<span class="hljs-selector-class">.IndexSlice</span>[:<span class="hljs-string">'B'</span>, <span class="hljs-number">5</span>:]]
</code></pre><pre><code class="hljs">A  <span class="hljs-number">5</span>    <span class="hljs-number">0.069876</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.534347</span>
   <span class="hljs-number">7</span>    <span class="hljs-number">0.414391</span>
   <span class="hljs-number">8</span>    <span class="hljs-number">0.172693</span>
   <span class="hljs-number">9</span>    <span class="hljs-number">0.728719</span>
B  <span class="hljs-number">5</span>    <span class="hljs-number">0.789500</span>
   <span class="hljs-number">6</span>    <span class="hljs-number">0.114575</span>
   <span class="hljs-number">7</span>    <span class="hljs-number">0.597118</span>
   <span class="hljs-number">8</span>    <span class="hljs-number">0.511793</span>
   <span class="hljs-number">9</span>    <span class="hljs-number">0.998563</span>
dtype: <span class="hljs-built_in">float</span>64
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="dataframe-多重索引">DataFrame 多重索引</h3>
<p><strong>61. 根据多重索引创建 DataFrame：</strong></p>
<p>创建一个以 <code>letters = ['A', 'B']</code> 和 <code>numbers = list(range(6))</code>为索引，值为随机数据的多重索引 DataFrame。</p>
<pre><code class="hljs python">frame = pd.DataFrame(np.<span class="hljs-meta">arange(</span>12).reshape(6, 2),
                     <span class="hljs-meta">index</span>=[<span class="hljs-meta">list</span>(<span class="hljs-string">'AAABBB'</span>), <span class="hljs-meta">list</span>(<span class="hljs-string">'123123'</span>)],
                     columns=[<span class="hljs-string">'hello'</span>, <span class="hljs-string">'shiyanlou'</span>])
frame
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th></th>
      <th>hello</th>
      <th>shiyanlou</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <th>1</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>B</th>
      <th>1</th>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>62. 多重索引设置列名称：</strong></p>
<pre><code class="hljs python">frame<span class="hljs-selector-class">.index</span><span class="hljs-selector-class">.names</span> = [<span class="hljs-string">'first'</span>, <span class="hljs-string">'second'</span>]
frame
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th></th>
      <th>hello</th>
      <th>shiyanlou</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <th>1</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>B</th>
      <th>1</th>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>63. DataFrame 多重索引分组求和：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">frame</span><span class="hljs-selector-class">.groupby</span>(<span class="hljs-string">'first'</span>)<span class="hljs-selector-class">.sum</span>()
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>hello</th>
      <th>shiyanlou</th>
    </tr>
    <tr>
      <th>first</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>B</th>
      <td>24</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>64. DataFrame 行列名称转换：</strong></p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(frame)</span></span>
frame.stack()
</code></pre><pre><code class="hljs">              hello  shiyanlou
first second                  
A     <span class="hljs-number">1</span>           <span class="hljs-number">0</span>          <span class="hljs-number">1</span>
      <span class="hljs-number">2</span>           <span class="hljs-number">2</span>          <span class="hljs-number">3</span>
      <span class="hljs-number">3</span>           <span class="hljs-number">4</span>          <span class="hljs-number">5</span>
B     <span class="hljs-number">1</span>           <span class="hljs-number">6</span>          <span class="hljs-number">7</span>
      <span class="hljs-number">2</span>           <span class="hljs-number">8</span>          <span class="hljs-number">9</span>
      <span class="hljs-number">3</span>          <span class="hljs-number">10</span>         <span class="hljs-number">11</span>





first  second           
A      <span class="hljs-number">1</span>       hello         <span class="hljs-number">0</span>
               shiyanlou     <span class="hljs-number">1</span>
       <span class="hljs-number">2</span>       hello         <span class="hljs-number">2</span>
               shiyanlou     <span class="hljs-number">3</span>
       <span class="hljs-number">3</span>       hello         <span class="hljs-number">4</span>
               shiyanlou     <span class="hljs-number">5</span>
B      <span class="hljs-number">1</span>       hello         <span class="hljs-number">6</span>
               shiyanlou     <span class="hljs-number">7</span>
       <span class="hljs-number">2</span>       hello         <span class="hljs-number">8</span>
               shiyanlou     <span class="hljs-number">9</span>
       <span class="hljs-number">3</span>       hello        <span class="hljs-number">10</span>
               shiyanlou    <span class="hljs-number">11</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>65. DataFrame 索引转换：</strong></p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(frame)</span></span>
frame.unstack()
</code></pre><pre><code class="hljs">              hello  shiyanlou
first second                  
A     <span class="hljs-number">1</span>           <span class="hljs-number">0</span>          <span class="hljs-number">1</span>
      <span class="hljs-number">2</span>           <span class="hljs-number">2</span>          <span class="hljs-number">3</span>
      <span class="hljs-number">3</span>           <span class="hljs-number">4</span>          <span class="hljs-number">5</span>
B     <span class="hljs-number">1</span>           <span class="hljs-number">6</span>          <span class="hljs-number">7</span>
      <span class="hljs-number">2</span>           <span class="hljs-number">8</span>          <span class="hljs-number">9</span>
      <span class="hljs-number">3</span>          <span class="hljs-number">10</span>         <span class="hljs-number">11</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: left;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span>:last-of-type <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>hello</th>
      <th>shiyanlou</th>
    </tr>
    <tr>
      <th>second</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>first</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>B</th>
      <td>6</td>
      <td>8</td>
      <td>10</td>
      <td>7</td>
      <td>9</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>66. DataFrame 条件查找：</strong></p>
<pre><code class="hljs python"># 示例数据
data = {<span class="hljs-string">'animal'</span>: [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'snake'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'snake'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'dog'</span>],
        <span class="hljs-string">'age'</span>: [<span class="hljs-number">2.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0.5</span>, np.nan, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4.5</span>, np.nan, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>],
        <span class="hljs-string">'visits'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],
        <span class="hljs-string">'priority'</span>: [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'no'</span>]}

labels = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'e'</span>, <span class="hljs-string">'f'</span>, <span class="hljs-string">'g'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'i'</span>, <span class="hljs-string">'j'</span>]
df = pd.<span class="hljs-symbol">DataFrame</span>(data, index=labels)
</code></pre><pre><code class="hljs python">
</code></pre><p>查找 <code>age</code> 大于 <code>3</code> 的全部信息</p>
<pre><code class="hljs python">df[df[<span class="hljs-string">'age'</span>] &gt; <span class="hljs-number">3</span>]
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>67. 根据行列索引切片：</strong></p>
<pre><code class="hljs python">df.iloc[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>, <span class="hljs-number">1</span>:<span class="hljs-number">3</span>]
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>age</th>
      <th>visits</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>c</th>
      <td>0.5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>68. DataFrame 多重条件查询：</strong></p>
<p>查找 <code>age&lt;3</code> 且为 <code>cat</code> 的全部数据。</p>
<pre><code class="hljs python">df = pd.<span class="hljs-symbol">DataFrame</span>(data, index=labels)

df[(df[<span class="hljs-string">'animal'</span>] == <span class="hljs-string">'cat'</span>) &amp; (df[<span class="hljs-string">'age'</span>] &lt; <span class="hljs-number">3</span>)]
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>69. DataFrame 按关键字查询：</strong></p>
<pre><code class="hljs python">df3[df3[<span class="hljs-string">'animal'</span>].isin([<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>])]
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
      <th>No.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
      <td>3</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
      <td>4</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>1.5</td>
      <td>3</td>
      <td>no</td>
      <td>5</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
      <td>7</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
      <td>8</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>70. DataFrame 按标签及列名查询。：</strong></p>
<pre><code class="hljs python">df.loc[df2.index<span class="hljs-string">[[3, 4, 8]]</span>, [<span class="hljs-string">'animal'</span>, <span class="hljs-string">'age'</span>]]
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>71. DataFrame 多条件排序：</strong></p>
<p>按照 <code>age</code> 降序，<code>visits</code> 升序排列</p>
<pre><code class="hljs python">df.sort_values(<span class="hljs-keyword">by</span>=<span class="hljs-meta">[</span><span class="hljs-string">'age'</span>, <span class="hljs-string">'visits'</span><span class="hljs-meta">]</span>, ascending=<span class="hljs-meta">[</span><span class="hljs-literal">False</span>, <span class="hljs-literal">True</span><span class="hljs-meta">]</span>)
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>animal</th>
      <th>age</th>
      <th>visits</th>
      <th>priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>i</th>
      <td>dog</td>
      <td>7.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>e</th>
      <td>dog</td>
      <td>5.0</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>g</th>
      <td>snake</td>
      <td>4.5</td>
      <td>1</td>
      <td>no</td>
    </tr>
    <tr>
      <th>j</th>
      <td>dog</td>
      <td>3.0</td>
      <td>1</td>
      <td>no</td>
    </tr>
    <tr>
      <th>b</th>
      <td>cat</td>
      <td>3.0</td>
      <td>3</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>a</th>
      <td>cat</td>
      <td>2.5</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>f</th>
      <td>cat</td>
      <td>2.0</td>
      <td>3</td>
      <td>no</td>
    </tr>
    <tr>
      <th>c</th>
      <td>snake</td>
      <td>0.5</td>
      <td>2</td>
      <td>no</td>
    </tr>
    <tr>
      <th>h</th>
      <td>cat</td>
      <td>NaN</td>
      <td>1</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>d</th>
      <td>dog</td>
      <td>NaN</td>
      <td>3</td>
      <td>yes</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>72.DataFrame 多值替换：</strong></p>
<p>将 <code>priority</code> 列的 <code>yes</code> 值替换为 <code>True</code>，<code>no</code> 值替换为 <code>False</code>。</p>
<pre><code class="hljs python">df[<span class="hljs-symbol">'priority</span>'].map({<span class="hljs-symbol">'yes</span>': <span class="hljs-literal">True</span>, <span class="hljs-symbol">'no</span>': <span class="hljs-literal">False</span>})
</code></pre><pre><code class="hljs"><span class="hljs-string">a</span>     <span class="hljs-literal">True</span>
<span class="hljs-string">b</span>     <span class="hljs-literal">True</span>
<span class="hljs-string">c</span>    <span class="hljs-literal">False</span>
<span class="hljs-string">d</span>     <span class="hljs-literal">True</span>
<span class="hljs-string">e</span>    <span class="hljs-literal">False</span>
<span class="hljs-string">f</span>    <span class="hljs-literal">False</span>
<span class="hljs-string">g</span>    <span class="hljs-literal">False</span>
<span class="hljs-string">h</span>     <span class="hljs-literal">True</span>
<span class="hljs-string">i</span>    <span class="hljs-literal">False</span>
<span class="hljs-string">j</span>    <span class="hljs-literal">False</span>
<span class="hljs-attr">Name:</span> <span class="hljs-string">priority,</span> <span class="hljs-attr">dtype:</span> <span class="hljs-string">bool</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>73. DataFrame 分组求和：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df4</span><span class="hljs-selector-class">.groupby</span>(<span class="hljs-string">'animal'</span>)<span class="hljs-selector-class">.sum</span>()
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>age</th>
      <th>visits</th>
      <th>No.</th>
    </tr>
    <tr>
      <th>animal</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cat</th>
      <td>6.0</td>
      <td>8</td>
      <td>13</td>
    </tr>
    <tr>
      <th>dog</th>
      <td>15.0</td>
      <td>8</td>
      <td>24</td>
    </tr>
    <tr>
      <th>snake</th>
      <td>5.0</td>
      <td>3</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>74. 使用列表拼接多个 DataFrame：</strong></p>
<pre><code class="hljs python">temp_df1 = pd.<span class="hljs-constructor">DataFrame(<span class="hljs-params">np</span>.<span class="hljs-params">random</span>.<span class="hljs-params">randn</span>(5, 4)</span>)  # 生成由随机数组成的 DataFrame <span class="hljs-number">1</span>
temp_df2 = pd.<span class="hljs-constructor">DataFrame(<span class="hljs-params">np</span>.<span class="hljs-params">random</span>.<span class="hljs-params">randn</span>(5, 4)</span>)  # 生成由随机数组成的 DataFrame <span class="hljs-number">2</span>
temp_df3 = pd.<span class="hljs-constructor">DataFrame(<span class="hljs-params">np</span>.<span class="hljs-params">random</span>.<span class="hljs-params">randn</span>(5, 4)</span>)  # 生成由随机数组成的 DataFrame <span class="hljs-number">3</span>

print(temp_df1)
print(temp_df2)
print(temp_df3)

pieces = <span class="hljs-literal">[<span class="hljs-identifier">temp_df1</span>, <span class="hljs-identifier">temp_df2</span>, <span class="hljs-identifier">temp_df3</span>]</span>
pd.concat(pieces)
</code></pre><pre><code class="hljs">          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>         <span class="hljs-number">3</span>
<span class="hljs-number">0</span>  <span class="hljs-number">0.435550</span> <span class="hljs-number">-0.177802</span> <span class="hljs-number">-0.786935</span>  <span class="hljs-number">0.423889</span>
<span class="hljs-number">1</span>  <span class="hljs-number">0.346422</span>  <span class="hljs-number">4.229253</span>  <span class="hljs-number">2.088201</span>  <span class="hljs-number">0.708978</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.385993</span>  <span class="hljs-number">0.283358</span>  <span class="hljs-number">0.088337</span> <span class="hljs-number">-1.549931</span>
<span class="hljs-number">3</span> <span class="hljs-number">-0.785884</span> <span class="hljs-number">-0.480385</span>  <span class="hljs-number">2.223877</span> <span class="hljs-number">-0.679601</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.080318</span> <span class="hljs-number">-0.063990</span>  <span class="hljs-number">1.188124</span> <span class="hljs-number">-0.058703</span>
          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>         <span class="hljs-number">3</span>
<span class="hljs-number">0</span>  <span class="hljs-number">0.337338</span>  <span class="hljs-number">0.507625</span>  <span class="hljs-number">0.597768</span>  <span class="hljs-number">2.081642</span>
<span class="hljs-number">1</span> <span class="hljs-number">-0.355360</span>  <span class="hljs-number">0.616494</span>  <span class="hljs-number">0.983156</span> <span class="hljs-number">-2.353219</span>
<span class="hljs-number">2</span> <span class="hljs-number">-0.754273</span>  <span class="hljs-number">0.048184</span>  <span class="hljs-number">0.452729</span> <span class="hljs-number">-1.155665</span>
<span class="hljs-number">3</span> <span class="hljs-number">-0.064326</span>  <span class="hljs-number">0.009316</span> <span class="hljs-number">-0.679547</span> <span class="hljs-number">-0.830644</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.707566</span> <span class="hljs-number">-0.424499</span> <span class="hljs-number">-0.201184</span>  <span class="hljs-number">0.456907</span>
          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>         <span class="hljs-number">3</span>
<span class="hljs-number">0</span>  <span class="hljs-number">0.043462</span> <span class="hljs-number">-1.507718</span>  <span class="hljs-number">1.450533</span>  <span class="hljs-number">0.253259</span>
<span class="hljs-number">1</span> <span class="hljs-number">-0.858315</span>  <span class="hljs-number">0.895162</span> <span class="hljs-number">-1.792400</span>  <span class="hljs-number">0.625761</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.697760</span>  <span class="hljs-number">0.294903</span> <span class="hljs-number">-0.181454</span>  <span class="hljs-number">1.062563</span>
<span class="hljs-number">3</span> <span class="hljs-number">-0.423211</span> <span class="hljs-number">-1.303878</span>  <span class="hljs-number">0.430220</span>  <span class="hljs-number">0.626554</span>
<span class="hljs-number">4</span> <span class="hljs-number">-2.189581</span> <span class="hljs-number">-1.471537</span> <span class="hljs-number">-0.097386</span>  <span class="hljs-number">0.840387</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.435550</td>
      <td>-0.177802</td>
      <td>-0.786935</td>
      <td>0.423889</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.346422</td>
      <td>4.229253</td>
      <td>2.088201</td>
      <td>0.708978</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.385993</td>
      <td>0.283358</td>
      <td>0.088337</td>
      <td>-1.549931</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.785884</td>
      <td>-0.480385</td>
      <td>2.223877</td>
      <td>-0.679601</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.080318</td>
      <td>-0.063990</td>
      <td>1.188124</td>
      <td>-0.058703</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.337338</td>
      <td>0.507625</td>
      <td>0.597768</td>
      <td>2.081642</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.355360</td>
      <td>0.616494</td>
      <td>0.983156</td>
      <td>-2.353219</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.754273</td>
      <td>0.048184</td>
      <td>0.452729</td>
      <td>-1.155665</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.064326</td>
      <td>0.009316</td>
      <td>-0.679547</td>
      <td>-0.830644</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.707566</td>
      <td>-0.424499</td>
      <td>-0.201184</td>
      <td>0.456907</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.043462</td>
      <td>-1.507718</td>
      <td>1.450533</td>
      <td>0.253259</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.858315</td>
      <td>0.895162</td>
      <td>-1.792400</td>
      <td>0.625761</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.697760</td>
      <td>0.294903</td>
      <td>-0.181454</td>
      <td>1.062563</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.423211</td>
      <td>-1.303878</td>
      <td>0.430220</td>
      <td>0.626554</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2.189581</td>
      <td>-1.471537</td>
      <td>-0.097386</td>
      <td>0.840387</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>75. 找出 DataFrame 表中和最小的列：</strong></p>
<pre><code class="hljs python">df = pd.DataFrame(np.random.random(size=(5, 10)), columns=<span class="hljs-meta">list</span>(<span class="hljs-string">'abcdefghij'</span>))
p<span class="hljs-meta">rint(</span>df)
df<span class="hljs-meta">.sum(</span>).id<span class="hljs-meta">xmin(</span>)  # id<span class="hljs-meta">xmax(</span>), id<span class="hljs-meta">xmin(</span>) 为 Series 函数返回最大最小值的索引值
</code></pre><pre><code class="hljs">          a         b         c         d         e         f         g  \
<span class="hljs-number">0</span>  <span class="hljs-number">0.659654</span>  <span class="hljs-number">0.483403</span>  <span class="hljs-number">0.919202</span>  <span class="hljs-number">0.974115</span>  <span class="hljs-number">0.200142</span>  <span class="hljs-number">0.808882</span>  <span class="hljs-number">0.475721</span>   
<span class="hljs-number">1</span>  <span class="hljs-number">0.301785</span>  <span class="hljs-number">0.175620</span>  <span class="hljs-number">0.518156</span>  <span class="hljs-number">0.902168</span>  <span class="hljs-number">0.148538</span>  <span class="hljs-number">0.625570</span>  <span class="hljs-number">0.904466</span>   
<span class="hljs-number">2</span>  <span class="hljs-number">0.883472</span>  <span class="hljs-number">0.163885</span>  <span class="hljs-number">0.257383</span>  <span class="hljs-number">0.644198</span>  <span class="hljs-number">0.391812</span>  <span class="hljs-number">0.484854</span>  <span class="hljs-number">0.972991</span>   
<span class="hljs-number">3</span>  <span class="hljs-number">0.044470</span>  <span class="hljs-number">0.154228</span>  <span class="hljs-number">0.856581</span>  <span class="hljs-number">0.218614</span>  <span class="hljs-number">0.474023</span>  <span class="hljs-number">0.614501</span>  <span class="hljs-number">0.518694</span>   
<span class="hljs-number">4</span>  <span class="hljs-number">0.289443</span>  <span class="hljs-number">0.023369</span>  <span class="hljs-number">0.478756</span>  <span class="hljs-number">0.856789</span>  <span class="hljs-number">0.506150</span>  <span class="hljs-number">0.468482</span>  <span class="hljs-number">0.433832</span>   

          h         i         j  
<span class="hljs-number">0</span>  <span class="hljs-number">0.050720</span>  <span class="hljs-number">0.612750</span>  <span class="hljs-number">0.897287</span>  
<span class="hljs-number">1</span>  <span class="hljs-number">0.234042</span>  <span class="hljs-number">0.267778</span>  <span class="hljs-number">0.355303</span>  
<span class="hljs-number">2</span>  <span class="hljs-number">0.341762</span>  <span class="hljs-number">0.272017</span>  <span class="hljs-number">0.826310</span>  
<span class="hljs-number">3</span>  <span class="hljs-number">0.510205</span>  <span class="hljs-number">0.458077</span>  <span class="hljs-number">0.928548</span>  
<span class="hljs-number">4</span>  <span class="hljs-number">0.932874</span>  <span class="hljs-number">0.290233</span>  <span class="hljs-number">0.583398</span>  





<span class="hljs-string">'b'</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>76. DataFrame 中每个元素减去每一行的平均值：</strong></p>
<pre><code class="hljs python">df = pd.DataFrame(np.random.random(size=(5, 3)))
<span class="hljs-builtin-name">print</span>(df)
df.sub(df.mean(<span class="hljs-attribute">axis</span>=1), <span class="hljs-attribute">axis</span>=0)
</code></pre><pre><code class="hljs">          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>
<span class="hljs-number">0</span>  <span class="hljs-number">0.557610</span>  <span class="hljs-number">0.228851</span>  <span class="hljs-number">0.996397</span>
<span class="hljs-number">1</span>  <span class="hljs-number">0.149600</span>  <span class="hljs-number">0.852522</span>  <span class="hljs-number">0.877812</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.988292</span>  <span class="hljs-number">0.380809</span>  <span class="hljs-number">0.460013</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.299431</span>  <span class="hljs-number">0.913197</span>  <span class="hljs-number">0.093875</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.318845</span>  <span class="hljs-number">0.324786</span>  <span class="hljs-number">0.452362</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.036676</td>
      <td>-0.365435</td>
      <td>0.402111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.477045</td>
      <td>0.225877</td>
      <td>0.251168</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.378587</td>
      <td>-0.228896</td>
      <td>-0.149691</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.136070</td>
      <td>0.477696</td>
      <td>-0.341626</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.046486</td>
      <td>-0.040545</td>
      <td>0.087031</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>77. DataFrame 分组，并得到每一组中最大三个数之和：</strong></p>
<pre><code class="hljs python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: list(<span class="hljs-string">'aaabbcaabcccbbc'</span>),
                   <span class="hljs-string">'B'</span>: [<span class="hljs-number">12</span>, <span class="hljs-number">345</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">45</span>, <span class="hljs-number">14</span>, <span class="hljs-number">4</span>, <span class="hljs-number">52</span>, <span class="hljs-number">54</span>, <span class="hljs-number">23</span>, <span class="hljs-number">235</span>, <span class="hljs-number">21</span>, <span class="hljs-number">57</span>, <span class="hljs-number">3</span>, <span class="hljs-number">87</span>]})
print(df)
df.groupby(<span class="hljs-string">'A'</span>)[<span class="hljs-string">'B'</span>].nlargest(<span class="hljs-number">3</span>).sum(level=<span class="hljs-number">0</span>)
</code></pre><pre><code class="hljs">    A    B
<span class="hljs-number">0</span>   a   <span class="hljs-number">12</span>
<span class="hljs-number">1</span>   a  <span class="hljs-number">345</span>
<span class="hljs-number">2</span>   a    <span class="hljs-number">3</span>
<span class="hljs-number">3</span>   b    <span class="hljs-number">1</span>
<span class="hljs-number">4</span>   b   <span class="hljs-number">45</span>
<span class="hljs-number">5</span>   c   <span class="hljs-number">14</span>
<span class="hljs-number">6</span>   a    <span class="hljs-number">4</span>
<span class="hljs-number">7</span>   a   <span class="hljs-number">52</span>
<span class="hljs-number">8</span>   b   <span class="hljs-number">54</span>
<span class="hljs-number">9</span>   c   <span class="hljs-number">23</span>
<span class="hljs-number">10</span>  c  <span class="hljs-number">235</span>
<span class="hljs-number">11</span>  c   <span class="hljs-number">21</span>
<span class="hljs-number">12</span>  b   <span class="hljs-number">57</span>
<span class="hljs-number">13</span>  b    <span class="hljs-number">3</span>
<span class="hljs-number">14</span>  c   <span class="hljs-number">87</span>





A
a    <span class="hljs-number">409</span>
b    <span class="hljs-number">156</span>
c    <span class="hljs-number">345</span>
Name: B, dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="透视表">透视表</h3>
<p>当分析庞大的数据时，为了更好的发掘数据特征之间的关系，且不破坏原数据，就可以利用透视表 <code>pivot_table</code> 进行操作。</p>
<p><strong>78. 透视表的创建：</strong></p>
<p>新建表将 <code>A, B, C</code> 列作为索引进行聚合。</p>
<pre><code class="hljs python">df = pd.<span class="hljs-symbol">DataFrame</span>({<span class="hljs-string">'A'</span>: [<span class="hljs-string">'one'</span>, <span class="hljs-string">'one'</span>, <span class="hljs-string">'two'</span>, <span class="hljs-string">'three'</span>] * <span class="hljs-number">3</span>,
                   <span class="hljs-string">'B'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>] * <span class="hljs-number">4</span>,
                   <span class="hljs-string">'C'</span>: [<span class="hljs-string">'foo'</span>, <span class="hljs-string">'foo'</span>, <span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>, <span class="hljs-string">'bar'</span>, <span class="hljs-string">'bar'</span>] * <span class="hljs-number">2</span>,
                   <span class="hljs-string">'D'</span>: np.random.randn(<span class="hljs-number">12</span>),
                   <span class="hljs-string">'E'</span>: np.random.randn(<span class="hljs-number">12</span>)})

print(df)

pd.pivot_table(df, index=[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>])
</code></pre><pre><code class="hljs">        A  B    C         D         E
<span class="hljs-number">0</span>     one  A  foo <span class="hljs-number">-0.919138</span> <span class="hljs-number">-1.237583</span>
<span class="hljs-number">1</span>     one  B  foo <span class="hljs-number">-0.253568</span>  <span class="hljs-number">0.099505</span>
<span class="hljs-number">2</span>     two  C  foo <span class="hljs-number">-0.835409</span>  <span class="hljs-number">1.368102</span>
<span class="hljs-number">3</span>   three  A  bar  <span class="hljs-number">0.057239</span>  <span class="hljs-number">0.673671</span>
<span class="hljs-number">4</span>     one  B  bar <span class="hljs-number">-0.429654</span> <span class="hljs-number">-1.685530</span>
<span class="hljs-number">5</span>     one  C  bar <span class="hljs-number">-1.817320</span> <span class="hljs-number">-1.945139</span>
<span class="hljs-number">6</span>     two  A  foo  <span class="hljs-number">1.698895</span>  <span class="hljs-number">0.660799</span>
<span class="hljs-number">7</span>   three  B  foo  <span class="hljs-number">0.153677</span>  <span class="hljs-number">1.370332</span>
<span class="hljs-number">8</span>     one  C  foo <span class="hljs-number">-0.455464</span>  <span class="hljs-number">1.704628</span>
<span class="hljs-number">9</span>     one  A  bar <span class="hljs-number">-0.601843</span>  <span class="hljs-number">0.715617</span>
<span class="hljs-number">10</span>    two  B  bar  <span class="hljs-number">0.531022</span> <span class="hljs-number">-0.536631</span>
<span class="hljs-number">11</span>  three  C  bar  <span class="hljs-number">0.578453</span> <span class="hljs-number">-0.182977</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th></th>
      <th>D</th>
      <th>E</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <th>A</th>
      <td>-0.760491</td>
      <td>-0.260983</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.341611</td>
      <td>-0.793012</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-1.136392</td>
      <td>-0.120256</td>
    </tr>
    <tr>
      <th>three</th>
      <th>A</th>
      <td>0.057239</td>
      <td>0.673671</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.153677</td>
      <td>1.370332</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.578453</td>
      <td>-0.182977</td>
    </tr>
    <tr>
      <th>two</th>
      <th>A</th>
      <td>1.698895</td>
      <td>0.660799</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.531022</td>
      <td>-0.536631</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-0.835409</td>
      <td>1.368102</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>79. 透视表按指定行进行聚合：</strong></p>
<p>将该 DataFrame 的 <code>D</code> 列聚合，按照 <code>A,B</code> 列为索引进行聚合，聚合的方式为默认求均值。</p>
<pre><code class="hljs python">pd.pivot_table(df, <span class="hljs-keyword">values</span>=[<span class="hljs-string">'D'</span>], <span class="hljs-keyword">index</span>=[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>])
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th></th>
      <th>D</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <th>A</th>
      <td>-0.760491</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.341611</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-1.136392</td>
    </tr>
    <tr>
      <th>three</th>
      <th>A</th>
      <td>0.057239</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.153677</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.578453</td>
    </tr>
    <tr>
      <th>two</th>
      <th>A</th>
      <td>1.698895</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.531022</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-0.835409</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>80. 透视表聚合方式定义：</strong></p>
<p>上一题中 <code>D</code> 列聚合时，采用默认求均值的方法，若想使用更多的方式可以在 <code>aggfunc</code> 中实现。</p>
<pre><code class="hljs python">pd.pivot<span class="hljs-constructor">_table(<span class="hljs-params">df</span>, <span class="hljs-params">values</span>=['D'], <span class="hljs-params">index</span>=['A', 'B'], <span class="hljs-params">aggfunc</span>=[<span class="hljs-params">np</span>.<span class="hljs-params">sum</span>, <span class="hljs-params">len</span>])</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: left;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span>:last-of-type <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>len</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>D</th>
      <th>D</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <th>A</th>
      <td>-1.520981</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.683222</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-2.272784</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>three</th>
      <th>A</th>
      <td>0.057239</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.153677</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.578453</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>two</th>
      <th>A</th>
      <td>1.698895</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.531022</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-0.835409</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>81. 透视表利用额外列进行辅助分割：</strong></p>
<p><code>D</code> 列按照 <code>A,B</code> 列进行聚合时，若关心 <code>C</code> 列对 <code>D</code> 列的影响，可以加入 <code>columns</code> 值进行分析。</p>
<pre><code class="hljs python">pd.pivot_table(df, <span class="hljs-keyword">values</span>=[<span class="hljs-string">'D'</span>], <span class="hljs-keyword">index</span>=[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>],
               <span class="hljs-keyword">columns</span>=[<span class="hljs-string">'C'</span>], aggfunc=np.sum)
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: left;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span>:last-of-type <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>D</th>
    </tr>
    <tr>
      <th></th>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <th>A</th>
      <td>-0.601843</td>
      <td>-0.919138</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.429654</td>
      <td>-0.253568</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-1.817320</td>
      <td>-0.455464</td>
    </tr>
    <tr>
      <th>three</th>
      <th>A</th>
      <td>0.057239</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>B</th>
      <td>NaN</td>
      <td>0.153677</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.578453</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>two</th>
      <th>A</th>
      <td>NaN</td>
      <td>1.698895</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.531022</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>C</th>
      <td>NaN</td>
      <td>-0.835409</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>82. 透视表的缺省值处理：</strong></p>
<p>在透视表中由于不同的聚合方式，相应缺少的组合将为缺省值，可以加入 <code>fill_value</code> 对缺省值处理。</p>
<pre><code class="hljs python">pd.pivot_table(df, <span class="hljs-keyword">values</span>=[<span class="hljs-string">'D'</span>], <span class="hljs-keyword">index</span>=[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>],
               <span class="hljs-keyword">columns</span>=[<span class="hljs-string">'C'</span>], aggfunc=np.sum, fill_value=<span class="hljs-number">0</span>)
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: left;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">tr</span>:last-of-type <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>D</th>
    </tr>
    <tr>
      <th></th>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <th>A</th>
      <td>-0.601843</td>
      <td>-0.919138</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.429654</td>
      <td>-0.253568</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-1.817320</td>
      <td>-0.455464</td>
    </tr>
    <tr>
      <th>three</th>
      <th>A</th>
      <td>0.057239</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.000000</td>
      <td>0.153677</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.578453</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>two</th>
      <th>A</th>
      <td>0.000000</td>
      <td>1.698895</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.531022</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.000000</td>
      <td>-0.835409</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><h3 id="绝对类型">绝对类型</h3>
<p>在数据的形式上主要包括数量型和性质型，数量型表示着数据可数范围可变，而性质型表示范围已经确定不可改变，绝对型数据就是性质型数据的一种。</p>
<p><strong>83. 绝对型数据定义：</strong></p>
<pre><code class="hljs python">df = pd.<span class="hljs-symbol">DataFrame</span>({<span class="hljs-string">"id"</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], <span class="hljs-string">"raw_grade"</span>: [
                  <span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-string">'e'</span>]})
df[<span class="hljs-string">"grade"</span>] = df[<span class="hljs-string">"raw_grade"</span>].astype(<span class="hljs-string">"category"</span>)
df
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>id</th>
      <th>raw_grade</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>e</td>
      <td>e</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>84. 对绝对型数据重命名：</strong></p>
<pre><code class="hljs python">df[<span class="hljs-string">"grade"</span>]<span class="hljs-selector-class">.cat</span><span class="hljs-selector-class">.categories</span> = [<span class="hljs-string">"very good"</span>, <span class="hljs-string">"good"</span>, <span class="hljs-string">"very bad"</span>]
df
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>id</th>
      <th>raw_grade</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>b</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>b</td>
      <td>good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>e</td>
      <td>very bad</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>85. 重新排列绝对型数据并补充相应的缺省值：</strong></p>
<pre><code class="hljs python">df[<span class="hljs-string">"grade"</span>] = df[<span class="hljs-string">"grade"</span>].cat.set_categories(
    [<span class="hljs-string">"very bad"</span>, <span class="hljs-string">"bad"</span>, <span class="hljs-string">"medium"</span>, <span class="hljs-string">"good"</span>, <span class="hljs-string">"very good"</span>])
df
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>id</th>
      <th>raw_grade</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>b</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>b</td>
      <td>good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>e</td>
      <td>very bad</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>86. 对绝对型数据进行排序：</strong></p>
<pre><code class="hljs python">df.sort<span class="hljs-constructor">_values(<span class="hljs-params">by</span>=<span class="hljs-string">"grade"</span>)</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>id</th>
      <th>raw_grade</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>e</td>
      <td>very bad</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>b</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>b</td>
      <td>good</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>a</td>
      <td>very good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>a</td>
      <td>very good</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>87. 对绝对型数据进行分组：</strong></p>
<pre><code class="hljs python"><span class="hljs-selector-tag">df</span><span class="hljs-selector-class">.groupby</span>(<span class="hljs-string">"grade"</span>)<span class="hljs-selector-class">.size</span>()
</code></pre><pre><code class="hljs">grade
very bad     <span class="hljs-number">1</span>
bad          <span class="hljs-number">0</span>
medium       <span class="hljs-number">0</span>
good         <span class="hljs-number">2</span>
very good    <span class="hljs-number">3</span>
dtype: <span class="hljs-built_in">int</span>64
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="数据清洗">数据清洗</h3>
<p>常常我们得到的数据是不符合我们最终处理的数据要求，包括许多缺省值以及坏的数据，需要我们对数据进行清洗。</p>
<p><strong>88. 缺失值拟合：</strong></p>
<p>在<code>FilghtNumber</code>中有数值缺失，其中数值为按 10 增长，补充相应的缺省值使得数据完整，并让数据为 <code>int</code> 类型。</p>
<pre><code class="hljs python">df = pd.<span class="hljs-symbol">DataFrame</span>({<span class="hljs-string">'From_To'</span>: [<span class="hljs-string">'LoNDon_paris'</span>, <span class="hljs-string">'MAdrid_miLAN'</span>, <span class="hljs-string">'londON_StockhOlm'</span>,
                               <span class="hljs-string">'Budapest_PaRis'</span>, <span class="hljs-string">'Brussels_londOn'</span>],
                   <span class="hljs-string">'FlightNumber'</span>: [<span class="hljs-number">10045</span>, np.nan, <span class="hljs-number">10065</span>, np.nan, <span class="hljs-number">10085</span>],
                   <span class="hljs-string">'RecentDelays'</span>: [[<span class="hljs-number">23</span>, <span class="hljs-number">47</span>], [], [<span class="hljs-number">24</span>, <span class="hljs-number">43</span>, <span class="hljs-number">87</span>], [<span class="hljs-number">13</span>], [<span class="hljs-number">67</span>, <span class="hljs-number">32</span>]],
                   <span class="hljs-string">'Airline'</span>: [<span class="hljs-string">'KLM(!)'</span>, <span class="hljs-string">'&lt;Air France&gt; (12)'</span>, <span class="hljs-string">'(British Airways. )'</span>,
                               <span class="hljs-string">'12. Air France'</span>, <span class="hljs-string">'"Swiss Air"'</span>]})
df[<span class="hljs-string">'FlightNumber'</span>] = df[<span class="hljs-string">'FlightNumber'</span>].interpolate().astype(int)
df
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>From_To</th>
      <th>FlightNumber</th>
      <th>RecentDelays</th>
      <th>Airline</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LoNDon_paris</td>
      <td>10045</td>
      <td>[23, 47]</td>
      <td>KLM(!)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MAdrid_miLAN</td>
      <td>10055</td>
      <td>[]</td>
      <td>&lt;Air France&gt; (12)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>londON_StockhOlm</td>
      <td>10065</td>
      <td>[24, 43, 87]</td>
      <td>(British Airways. )</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Budapest_PaRis</td>
      <td>10075</td>
      <td>[13]</td>
      <td>12. Air France</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brussels_londOn</td>
      <td>10085</td>
      <td>[67, 32]</td>
      <td>"Swiss Air"</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>89. 数据列拆分：</strong></p>
<p>其中<code>From_to</code>应该为两独立的两列<code>From</code>和<code>To</code>，将<code>From_to</code>依照<code>_</code>拆分为独立两列建立为一个新表。</p>
<pre><code class="hljs python">temp = df<span class="hljs-selector-class">.From_To</span><span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.split</span>(<span class="hljs-string">'_'</span>, expand=True)
temp<span class="hljs-selector-class">.columns</span> = [<span class="hljs-string">'From'</span>, <span class="hljs-string">'To'</span>]
temp
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>From</th>
      <th>To</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LoNDon</td>
      <td>paris</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MAdrid</td>
      <td>miLAN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>londON</td>
      <td>StockhOlm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Budapest</td>
      <td>PaRis</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brussels</td>
      <td>londOn</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>90. 字符标准化：</strong></p>
<p>其中注意到地点的名字都不规范（如：<code>londON</code>应该为<code>London</code>）需要对数据进行标准化处理。</p>
<pre><code class="hljs python">temp[<span class="hljs-string">'From'</span>] = temp[<span class="hljs-string">'From'</span>]<span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.capitalize</span>()
temp[<span class="hljs-string">'To'</span>] = temp[<span class="hljs-string">'To'</span>]<span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.capitalize</span>()
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>91. 删除坏数据加入整理好的数据：</strong></p>
<p>将最开始的 <code>From_to</code> 列删除，加入整理好的 <code>From</code> 和 <code>to</code> 列。</p>
<pre><code class="hljs python">df = df.drop('From_To', axis=1)
df = df.join(temp)
print(df)
</code></pre><pre><code class="hljs">   FlightNumber  RecentDelays              Airline      From         To
<span class="hljs-number">0</span>         <span class="hljs-number">10045</span>      [<span class="hljs-number">23</span>, <span class="hljs-number">47</span>]               KLM(!)    London      Paris
<span class="hljs-number">1</span>         <span class="hljs-number">10055</span>            []    &lt;Air France&gt; (<span class="hljs-number">12</span>)    Madrid      Milan
<span class="hljs-number">2</span>         <span class="hljs-number">10065</span>  [<span class="hljs-number">24</span>, <span class="hljs-number">43</span>, <span class="hljs-number">87</span>]  (British Airways. )    London  Stockholm
<span class="hljs-number">3</span>         <span class="hljs-number">10075</span>          [<span class="hljs-number">13</span>]       <span class="hljs-number">12.</span> Air France  Budapest      Paris
<span class="hljs-number">4</span>         <span class="hljs-number">10085</span>      [<span class="hljs-number">67</span>, <span class="hljs-number">32</span>]          <span class="hljs-string">"Swiss Air"</span>  Brussels     London
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>92. 去除多余字符：</strong></p>
<p>如同 <code>airline</code> 列中许多数据有许多其他字符，会对后期的数据分析有较大影响，需要对这类数据进行修正。</p>
<pre><code class="hljs python">df[<span class="hljs-string">'Airline'</span>] = df[<span class="hljs-string">'Airline'</span>]<span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.extract</span>(
    <span class="hljs-string">'([a-zA-Z\s]+)'</span>, expand=False)<span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.strip</span>()
df
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>FlightNumber</th>
      <th>RecentDelays</th>
      <th>Airline</th>
      <th>From</th>
      <th>To</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10045</td>
      <td>[23, 47]</td>
      <td>KLM</td>
      <td>London</td>
      <td>Paris</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10055</td>
      <td>[]</td>
      <td>Air France</td>
      <td>Madrid</td>
      <td>Milan</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10065</td>
      <td>[24, 43, 87]</td>
      <td>British Airways</td>
      <td>London</td>
      <td>Stockholm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10075</td>
      <td>[13]</td>
      <td>Air France</td>
      <td>Budapest</td>
      <td>Paris</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10085</td>
      <td>[67, 32]</td>
      <td>Swiss Air</td>
      <td>Brussels</td>
      <td>London</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>93. 格式规范：</strong></p>
<p>在 <code>RecentDelays</code> 中记录的方式为列表类型，由于其长度不一，这会为后期数据分析造成很大麻烦。这里将 <code>RecentDelays</code> 的列表拆开，取出列表中的相同位置元素作为一列，若为空值即用 <code>NaN</code> 代替。</p>
<pre><code class="hljs python">delays = df[<span class="hljs-string">'RecentDelays'</span>].apply(pd.Series)

delays.<span class="hljs-keyword">columns</span> = [<span class="hljs-string">'delay_{}'</span>.format(n)
                  <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, len(delays.<span class="hljs-keyword">columns</span>)+<span class="hljs-number">1</span>)]

df = df.<span class="hljs-keyword">drop</span>(<span class="hljs-string">'RecentDelays'</span>, axis=<span class="hljs-number">1</span>).<span class="hljs-keyword">join</span>(delays)
df
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>FlightNumber</th>
      <th>Airline</th>
      <th>From</th>
      <th>To</th>
      <th>delay_1</th>
      <th>delay_2</th>
      <th>delay_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10045</td>
      <td>KLM</td>
      <td>London</td>
      <td>Paris</td>
      <td>23.0</td>
      <td>47.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10055</td>
      <td>Air France</td>
      <td>Madrid</td>
      <td>Milan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10065</td>
      <td>British Airways</td>
      <td>London</td>
      <td>Stockholm</td>
      <td>24.0</td>
      <td>43.0</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10075</td>
      <td>Air France</td>
      <td>Budapest</td>
      <td>Paris</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10085</td>
      <td>Swiss Air</td>
      <td>Brussels</td>
      <td>London</td>
      <td>67.0</td>
      <td>32.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><h3 id="数据预处理">数据预处理</h3>
<p><strong>94. 信息区间划分：</strong></p>
<p>班级一部分同学的数学成绩表，如下图所示</p>
<pre><code class="hljs python"><span class="hljs-attr">df</span>=pd.DataFrame({<span class="hljs-string">'name'</span>:[<span class="hljs-string">'Alice'</span>,<span class="hljs-string">'Bob'</span>,<span class="hljs-string">'Candy'</span>,<span class="hljs-string">'Dany'</span>,<span class="hljs-string">'Ella'</span>,<span class="hljs-string">'Frank'</span>,<span class="hljs-string">'Grace'</span>,<span class="hljs-string">'Jenny'</span>],<span class="hljs-string">'grades'</span>:[<span class="hljs-number">58</span>,<span class="hljs-number">83</span>,<span class="hljs-number">79</span>,<span class="hljs-number">65</span>,<span class="hljs-number">93</span>,<span class="hljs-number">45</span>,<span class="hljs-number">61</span>,<span class="hljs-number">88</span>]})
</code></pre><p>但我们更加关心的是该同学是否及格，将该数学成绩按照是否<code>&gt;60</code>来进行划分。</p>
<pre><code class="hljs python">df = pd.DataFrame({<span class="hljs-string">'name'</span>: [<span class="hljs-string">'Alice'</span>, <span class="hljs-string">'Bob'</span>, <span class="hljs-string">'Candy'</span>, <span class="hljs-string">'Dany'</span>, <span class="hljs-string">'Ella'</span>,
                            <span class="hljs-string">'Frank'</span>, <span class="hljs-string">'Grace'</span>, <span class="hljs-string">'Jenny'</span>],
                   <span class="hljs-string">'grades'</span>: [<span class="hljs-number">58</span>, <span class="hljs-number">83</span>, <span class="hljs-number">79</span>, <span class="hljs-number">65</span>, <span class="hljs-number">93</span>, <span class="hljs-number">45</span>, <span class="hljs-number">61</span>, <span class="hljs-number">88</span>]})


def choice(<span class="hljs-symbol">x</span>):
    <span class="hljs-keywords">if</span> <span class="hljs-symbol">x</span> &gt; <span class="hljs-number">60</span>:
        <span class="hljs-keywords">return</span> <span class="hljs-number">1</span>
    <span class="hljs-keywords">else</span>:
        <span class="hljs-keywords">return</span> <span class="hljs-number">0</span>


df.grades = pd.Series(map(lambda <span class="hljs-symbol">x</span>: choice(<span class="hljs-symbol">x</span>), df.grades))
df
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>name</th>
      <th>grades</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alice</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Candy</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dany</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ella</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Frank</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Grace</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Jenny</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>95. 数据去重：</strong></p>
<p>一个列为<code>A</code>的 DataFrame 数据，如下图所示</p>
<pre><code class="hljs python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>]})
</code></pre><p>尝试将 A 列中连续重复的数据清除。</p>
<pre><code class="hljs python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>]})
df.loc[df[<span class="hljs-string">'A'</span>].shift() != df[<span class="hljs-string">'A'</span>]]
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><p><strong>96. 数据归一化：</strong></p>
<p>有时候，DataFrame 中不同列之间的数据差距太大，需要对其进行归一化处理。</p>
<p>其中，Max-Min 归一化是简单而常见的一种方式，公式如下:</p>
<p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><mfrac><mrow><mi>X</mi><mo>−</mo><msub><mi>X</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><mrow><msub><mi>X</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Y=\frac{X-X_{min}}{X_{max}-X_{min}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.22222em;">Y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.19633em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<pre><code class="hljs python">def normalization(df):
    numerator = df.<span class="hljs-built_in">sub</span>(df.<span class="hljs-built_in">min</span>())
    denominator = (df.<span class="hljs-built_in">max</span>()).<span class="hljs-built_in">sub</span>(df.<span class="hljs-built_in">min</span>())
    Y = numerator.div(denominator)
    <span class="hljs-keyword">return</span> Y


df = pd.DataFrame(np.<span class="hljs-built_in">random</span>.<span class="hljs-built_in">random</span>(size=(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)))
<span class="hljs-built_in">print</span>(df)
normalization(df)
</code></pre><pre><code class="hljs">          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>
<span class="hljs-number">0</span>  <span class="hljs-number">0.068466</span>  <span class="hljs-number">0.942762</span>  <span class="hljs-number">0.795099</span>
<span class="hljs-number">1</span>  <span class="hljs-number">0.831463</span>  <span class="hljs-number">0.028050</span>  <span class="hljs-number">0.603929</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.136350</span>  <span class="hljs-number">0.826835</span>  <span class="hljs-number">0.865010</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.595750</span>  <span class="hljs-number">0.247326</span>  <span class="hljs-number">0.328010</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.425220</span>  <span class="hljs-number">0.209596</span>  <span class="hljs-number">0.154659</span>
</code></pre><div>
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code class="hljs"><span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">tbody</span> <span class="hljs-selector-tag">tr</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">vertical-align</span>: top;
}

<span class="hljs-selector-class">.dataframe</span> <span class="hljs-selector-tag">thead</span> <span class="hljs-selector-tag">th</span> {
    <span class="hljs-attribute">text-align</span>: right;
}
</code></pre><p>&lt;/style&gt;</p>
<table class="dataframe">
  <thead>
    <tr style="text-align:right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.901582</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.632463</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.088971</td>
      <td>0.873265</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.691070</td>
      <td>0.239722</td>
      <td>0.244036</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.467569</td>
      <td>0.198474</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>




<pre><code class="hljs python">
</code></pre><h3 id="pandas-绘图操作">Pandas 绘图操作</h3>
<p>为了更好的了解数据包含的信息，最直观的方法就是将其绘制成图。</p>
<p><strong>97. Series 可视化：</strong></p>
<pre><code class="hljs python">%matplotlib inline
ts = pd.<span class="hljs-constructor">Series(<span class="hljs-params">np</span>.<span class="hljs-params">random</span>.<span class="hljs-params">randn</span>(100)</span>, index=pd.date<span class="hljs-constructor">_range('<span class="hljs-params">today</span>', <span class="hljs-params">periods</span>=100)</span>)
ts = ts.cumsum<span class="hljs-literal">()</span>
ts.plot<span class="hljs-literal">()</span>
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>98. DataFrame 折线图：</strong></p>
<pre><code class="hljs python">df = pd.DataFrame(np<span class="hljs-selector-class">.random</span><span class="hljs-selector-class">.randn</span>(<span class="hljs-number">100</span>, <span class="hljs-number">4</span>), index=ts<span class="hljs-selector-class">.index</span>,
                  <span class="hljs-attribute">columns</span>=[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>])
df = df.cumsum()
df.plot()
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>99. DataFrame 散点图：</strong></p>
<pre><code class="hljs python">df = pd.DataFrame({<span class="hljs-string">"xs"</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>], <span class="hljs-string">"ys"</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>]})
df = df.cumsum()
df.plot.scatter(<span class="hljs-string">"xs"</span>, <span class="hljs-string">"ys"</span>, color=<span class="hljs-string">'red'</span>, marker=<span class="hljs-string">"*"</span>)
</code></pre><pre><code class="hljs python">
</code></pre><p><strong>100. DataFrame 柱形图：</strong></p>
<pre><code class="hljs python">df = pd.DataFrame({<span class="hljs-string">"revenue"</span>: [<span class="hljs-number">57</span>, <span class="hljs-number">68</span>, <span class="hljs-number">63</span>, <span class="hljs-number">71</span>, <span class="hljs-number">72</span>, <span class="hljs-number">90</span>, <span class="hljs-number">80</span>, <span class="hljs-number">62</span>, <span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">47</span>, <span class="hljs-number">52</span>],
                   <span class="hljs-string">"advertising"</span>: [<span class="hljs-number">2.1</span>, <span class="hljs-number">1.9</span>, <span class="hljs-number">2.7</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">3.6</span>, <span class="hljs-number">3.2</span>, <span class="hljs-number">2.7</span>, <span class="hljs-number">2.4</span>, <span class="hljs-number">1.8</span>, <span class="hljs-number">1.6</span>, <span class="hljs-number">1.3</span>, <span class="hljs-number">1.9</span>],
                   <span class="hljs-string">"month"</span>: range(<span class="hljs-number">12</span>)
                   })

ax = df.plot.bar(<span class="hljs-string">"month"</span>, <span class="hljs-string">"revenue"</span>, color=<span class="hljs-string">"yellow"</span>)
df.plot(<span class="hljs-string">"month"</span>, <span class="hljs-string">"advertising"</span>, secondary_y=True, ax=ax)
</code></pre><pre><code class="hljs python">
</code></pre><hr><div style="color:#999; font-size:12px;"><i class="fa fa-copyright"> 本课程内容版权归实验楼所有，禁止转载、下载及非法传播。实验中少量题目编译自：<a href="https://github.com/ajcr/100-pandas-puzzles">100 pandas puzzles</a></i></div><h2></h2></div></div> <div data-v-198dce4b="" class="copyright">
        *本课程内容由作者授权实验楼发布，未经允许，禁止转载、下载及非法传播
      </div></div> <div data-v-5a6f02b8="" data-v-198dce4b="" class="toolbar"><!----> <div data-v-5a6f02b8="" class="toolbar-btns"><button data-v-5a6f02b8="" type="button" class="btn toolbar-btn btn-primary">
        完成学习
      </button></div></div> <div data-v-31af5ef6="" data-v-198dce4b=""><!----></div></div> <!----> <!----> <!----></div> <div data-v-ea7cbec0="" data-v-00d8b544="" class="lab-console-report" data-v-48901454="" style="display: none;"><!----> <ul data-v-ea7cbec0="" class="nav nav-tabs"><li data-v-ea7cbec0="" class="nav-item"><a data-v-ea7cbec0="" class="nav-link active">
        编辑
      </a></li><li data-v-ea7cbec0="" class="nav-item"><a data-v-ea7cbec0="" class="nav-link">
        预览
      </a></li></ul> <div data-v-ea7cbec0="" class="tab-content"><div data-v-ea7cbec0="" class="tab-pane active lab-report-tab"><div data-v-ea88a3ba="" data-v-ea7cbec0="" class="editor"><div data-v-94795872="" data-v-ea88a3ba="" class="markdown-editor"><div data-v-374f1a78="" data-v-94795872="" class="tools"><div data-v-374f1a78=""><i data-v-374f1a78="" class="fa fa-bold"></i> <i data-v-374f1a78="" class="fa fa-italic"></i> <i data-v-374f1a78="" class="fa fa-link"></i> <i data-v-374f1a78="" class="fa fa-quote-left"></i> <i data-v-374f1a78="" class="fa fa-code"></i> <i data-v-374f1a78="" class="fa fa-image add-image-btn"></i> <div data-v-374f1a78="" class="custom-file b-form-file upload-image" id="__BVID__48__BV_file_outer_"><input type="file" class="custom-file-input" id="__BVID__48"><label data-browse="Browse" class="custom-file-label" for="__BVID__48">No file chosen</label></div> <i data-v-374f1a78="" class="fa fa-list-ol"></i> <i data-v-374f1a78="" class="fa fa-list-ul"></i></div> <a data-v-374f1a78="" href="https://www.shiyanlou.com/questions/764/" target="_blank" class="markdown-syntax"><i data-v-374f1a78="" class="fa fa-question-circle"></i>
    格式说明
  </a></div> <textarea data-v-94795872="" placeholder="报告将自动保存，推荐使用 markdown 语法：

报告是您在本实验保存的笔记、截图及实验代码的完整记录，多记录学习更高效哦~" class="textarea form-control"></textarea> <!----></div> <div data-v-78b3a632="" data-v-ea88a3ba=""><!----> <div data-v-78b3a632="" class="custom-file b-form-file upload-image" id="__BVID__50__BV_file_outer_"><input type="file" class="custom-file-input" id="__BVID__50"><label data-browse="Browse" class="custom-file-label" for="__BVID__50">No file chosen</label></div></div></div></div> <!----></div> <button data-v-ea7cbec0="" type="button" disabled="disabled" class="btn publish-btn btn-primary disabled"><i data-v-ea7cbec0="" class="fa fa-share"></i> <span data-v-ea7cbec0="">发布</span></button></div> <div data-v-24a59a0a="" data-v-00d8b544="" class="lab-question" data-v-48901454="" style="display: none;"><div data-v-38f43bd3="" data-v-24a59a0a="" class="operate"><button data-v-38f43bd3="" class="btn btn-primary">
    发布帖子
  </button> <fieldset data-v-38f43bd3="" class="form-group form-group" id="__BVID__53"><!----><div tabindex="-1" role="group"><div data-v-38f43bd3="" class="custom-control custom-checkbox"><input type="checkbox" name="checkbox" autocomplete="off" class="custom-control-input" value="true" id="__BVID__54"><label class="custom-control-label" for="__BVID__54">
      只看我的
    </label></div><!----><!----><!----></div></fieldset> <!----> <div data-v-38f43bd3=""><!----></div></div> <div data-v-51d37e30="" data-v-24a59a0a="" class="best-question"><!----></div> <div data-v-91301d3e="" data-v-24a59a0a="" class="normal-question"><div data-v-5fd8fa79="" data-v-91301d3e="" class="question-list" question-type="normal"><div data-v-5fd8fa79="" class="list-title">
    本节帖子(21)
  </div> <ul data-v-5fd8fa79="" style="height: 1043px;"><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/173911" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          第50题的read_excel的na_values参数的意义
        </p> <span data-v-5fd8fa79="" class="answer-num">2回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/173589" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          module 'pandas' has no attribute 'data_range'
        </p> <span data-v-5fd8fa79="" class="answer-num">2回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/103644" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          pandas百题38题：
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/96517" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          第6 应该是S3
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85604" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          54题没看懂
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/89771" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          pandas百题69
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/88062" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          没有变量命名变量“df3”
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/87142" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          labels是什么意思
        </p> <span data-v-5fd8fa79="" class="answer-num">2回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/86955" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          请教85题 重新排列绝对型数据后为什么取到的顺序和原来一样呢？
        </p> <span data-v-5fd8fa79="" class="answer-num">2回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/86954" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          求教78题 透视表聚合后C列的数据怎么没有了呢
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/86487" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          可否保存为ipynb?
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/86485" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          提问保存jupyter notebook
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85560" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          再次提问37、38题
        </p> <span data-v-5fd8fa79="" class="answer-num">9回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85535" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          pandas百题大战小瑕疵2
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85536" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          pandas百题37、38题
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85538" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          pandas百题37、38题
        </p> <span data-v-5fd8fa79="" class="answer-num">2回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85534" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          以下两个指令有什么区别？
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85533" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          pandas百题大战小瑕疵
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/85223" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          通过dict创建DataFrame能使行和列呼唤吗？
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/84738" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          隐藏桌面了以后怎样显示出来呢？
        </p> <span data-v-5fd8fa79="" class="answer-num">2回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/84490" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          pandas 中的数据去重问题
        </p> <span data-v-5fd8fa79="" class="answer-num">2回复</span></a></li> <li data-v-5fd8fa79="" class="load-msg"><span data-v-5fd8fa79="">到底了~</span></li></ul></div></div></div> <!----> <!----></div> <div data-v-23e30aba="" data-v-00d8b544="" class="course-labs-panel customize-modal text-right" data-v-48901454="" style="display: none;"><div data-v-23e30aba="" class="modal-content-wrapper modal-labs-box inline-block text-left"><div data-v-23e30aba="" class="modal-content content-box"><div data-v-23e30aba="" class="box-header progress-info no-margin"><p data-v-23e30aba="" class="progress-desc font-18">
          目前已完成 1/2 个章节的学习
        </p> <div data-v-23e30aba="" class="progress-graph flex space-between vertical-center"><div data-v-23e30aba="" class="progress-bar-outter relative"><span data-v-23e30aba="" class="progress-percentage-label font-12" style="left: 50%;">
              50%
            </span> <div data-v-23e30aba="" class="progress" style="height: 5px;"><div data-v-23e30aba="" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="50" class="progress-bar bg-primary learn-progress-bar" style="width: 50%;"><!----></div></div></div> <!----> <div data-v-23e30aba="" aria-hidden="true" class="d-none" style="display: none;"><div><span data-v-23e30aba="" class="font-12">完成全部章节即可获得完课证书</span></div></div></div> <!----></div> <div data-v-23e30aba="" class="box-body chapter-stages"><div data-v-58426d58="" data-v-23e30aba="" class="chapter-stage collapse-item"><!----> <div data-v-58426d58="" id="collapse-stage-0" class="stage-body collapse show" style=""><div data-v-5c68598e="" data-v-58426d58="" class="lab-item pointer"><div data-v-5c68598e="" class="item-top flex space-between color-primary bold"><div data-v-5c68598e="" class="top-left vertical-center"><span data-v-5c68598e="" class="inline-block lab-icon"><!----> <!----> <img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAmtJREFUSA3tlU9oE0EUxt+bdMM2kRIEq1IPWqweQgtSL2JrsiCIelJR9CIIShRDTloQFHsQ/ANCbYK2VNFj6cGjF9HdFMEIFaShPVQpCl6sCKE13SRr5jmzcUKp3dbECoIOLN/um3nfb+ftzCzA//a3VQDVCwXN/r0c4SYBdQBBg4rXrAjfEHCcMdaT3xN/JvNdSFN6oK1EpXEk+CQiI0g0X7P5jwQC1AnhiHjc5Ed/x2zk7Fv3jR1eOghAumB22dHEx3oBKi9kPrxRwNnPFV/oY7IDgUJSbeP3AdInZ5zKiZLNKV8XIjv+ZKsZ0kvEoqZZ08JYERIw75xe8yIVVjO9lU5dy2D2rnxutJI9gdHBjarPS5eF6OnkVQ7QRw5q0iA8MeIn4GeQ2POKIXVxXrRWAnlCdCt5BTi/CMx3IG+cfyNNp2dmDkttbW5+LLWlBY4KmZagYGZovYwt1TwhAPwEIL4KB7WXKpGQxwDZo4nwsZKMvWtLFBmjASDaRsVipxq3WL0/oObbD07ZmvxaHO4cGzw+ZTtbnDKPNDCMKZPgaHJfmdMwMrgwH4k/UfHF6jmTwu74B9B8UQLYMZkvHCpzbojkp3Pd8SllwjkNIcJlO5K4rWJLqfdMxGgJErPY/npnzJFL17KsB9YCl9Z1G7aq0i0I/3S7LESOlgCpvYhioYG8qu1XAHKwZ7mqTqtw40LEqflFeq3N9DetgieIEmtEEFC+7lEfMu9tLqCTFYAxcVreZxzz9cIqRz0/KfK7ddLac8a599WfVqOV2gXErwNSu1hR7g6vByQMHSDMiv10yY7Gq3usHq9/NOc77YPc8hnQeRYAAAAASUVORK5CYII=" alt="lab-classic"></span> <span data-v-5c68598e="" class="inline-block lab-index color-primary bold">
        实验 1
      </span> <span data-v-5c68598e="" title="Pandas 百题大冲关｜学习版" class="inline-block lab-name">
        Pandas 百题大冲关｜学习版
      </span></div> <div data-v-5c68598e="" class="top-right"><img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAmdJREFUSA21ls9rU0EQx2c2sWmCBVuphVh/QAsK1rZ4FlQUxR9YqtdeBHvw0GD/AvHkPT0a7EUPBYso2OJBrODNiwcFfyBoEX8heojEIr63znfztnm/+vKerQNhs5vZz8zOzs6EKUGKj6r9rPSYq/m0qA3Ip+ypf5TxrWJ9X7t899eRygdvPTJwZEUWSk9myu4ffZU0XSDSuTid1ho7xDSr8nylcXAKhgMSMVB6PHPW1e5NgXcFNNtNmOqK1UTj0NQ9v6ryT4pL1YrA72SGAyIOYS8YfubqCTzPAQ8Y9Sun+s7kyknG7UmMgWbM3Zf/5HmcVYQrr/biToy33oVmi3kc2K4hXEgSEUYqaqJ37bPF7k47siPh2S3h0mMbD4cTOge28h5RWrcCelvyBbq84wD1FzYH1u0E7LxM8EIzS7fAF0bGabRrGxVVjq69fxrHGMAl2+cfUIB353oHqYOjD9kPf9P4QTc+vQjs9U3Ka+b8pe3DdGvfKZrff4YK4qGVMPz4s3n68rthf46MMBCpH9Ca+/rabDzWs4tuDzWNxME/J8DB5s6l6gJpfRLQsOwpddOD0fPU11Gih9+XaeumThNzhAWet4HLI+BFhZIbBtv5KwGd8EJwtGdnNrhAwFao52LKsdDwaI0sr9Tp+c9v6Tw3EHbANrVIwnRdwnQxDPfPc8zkaHnzaYW5tnK4MmmyCM1CmkY9aW82OIqdMEWMAVP1pFmIETfJSKrfmuV6wna31XeA+s3E0+syInAwbC+AQ+YO/J7915YJQ7COZiE5XEvKrpZTaPpcMw0m1I+hEzlBayPRRvxt+QvzgQD15GCKOwAAAABJRU5ErkJggg==" alt="已学习"></div></div> <!----></div><div data-v-5c68598e="" data-v-58426d58="" class="lab-item pointer"><div data-v-5c68598e="" class="item-top flex space-between color-text"><div data-v-5c68598e="" class="top-left vertical-center"><span data-v-5c68598e="" class="inline-block lab-icon"><!----> <!----> <img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAipJREFUSA3tlcFrE0EUxpONNaGQpYdAEXopNHoIBjaGJEKhLRREPVkR9NKTkn+gDQiKF9H2UMhJClXosXgQSqEXqfSWbAiktOSiIAhepAjCYkOaZtPfW51QQjZtQgoFHRi+mbdvvu+9N29Yj+f/uGgV8KqAcrncNOvFRqMRBS8pew945PV6d30+XyaRSGzJeUckn8+HbdveZf9D07T3CB30QK6OBFjch2MErmgqlfriRIzAXT4EMI5j/K68e8VSqbRQqVT2//JmNSEivSHBfggIj2EYvwBL8Toi8uE8R9ci1FpjdtUYp4rQdY8LhUJEZWqa5ksa5Y3s+ZYpFotX1Dc37CgCyQsOZpkDQlAuly+TxRNq/Un2jPFarbZ9mpCrCNE+h2Sefr9Dv+8Io2VZM4LBYPCDYCgUegB8FSH8h8XWbriKEPEjpklb59RB9mnmaiQSORRbOByuktUytqtsbyi/VnS9QL/ff7tarW4T5RrleFiv10fp+wkySysS7ucW9jUCmaP9N5W9FV0zicVi3xCa5ICB0D3Ipoj4YzKZ/KxIEF1B4BkCS8rWDl0zEWcRIotr8Xi8hoAE9O4kia7rY6p0J+2t644i4iwCgtTeBmQ2x1kExNm1XE2mPiyUyE/hog31PnB6KLG8q0Gmw6vKtYHhFXVf5wG+5TJ/9yoGR4BGmeW8lFl4//xPZEE73qRbXrO8jqPzwsXe7eDuhHyPQJ/Sic031i3PP+x/DBPn3QC5lw/kAAAAAElFTkSuQmCC" alt="lab-classic"></span> <span data-v-5c68598e="" class="inline-block lab-index color-999">
        实验 2
      </span> <span data-v-5c68598e="" title="Pandas 百题大冲关｜题目版" class="inline-block lab-name">
        Pandas 百题大冲关｜题目版
      </span></div> <div data-v-5c68598e="" class="top-right"><img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAgxJREFUSA21ljtuAjEQhne9IETBAbJKR5MD5BaREhANjzRcIFIKonQoHUqKSLkATXg0CBKJW+QAaeiiXICCAnbh/53xCgQELw9L1no94+/32uPxus4/pdfrnU8mkxvXda/glkX1xf0Xz9F8Ph+m0+mPQqHwI/1rD3etBx2dTscPw/AJzSog3iYf0wfxAO2mUqpeKpUovFLWBAC/DoLgHV4Z1CkAA4gMEonEFyAaAHF/NptdwpaDLQe/JOrY87xbiHyiHZUVgVardYcBr7Aq1D6gtWKxOIq8NzS63W4WYi8w5VFDiN5XKpU34xoJyMz7NGCmj+VymYOsS7vdruHLGhyAL8mbL9ECXHMsyzdsGcAf4sLNLETkGe9crgvuCZfCkQ3lmvf3hZMjY7kKGWE6iqGIjirqlGuO50FFGFNAqmQrxjlDkdGya0NtlMmQyPPIVnjhIXIYijYAGx/DIpt7wBPqMM5tBtv4LLGyFNDH3xwiG8AunyWWr6No14C49lQqFZ0vCkTHPy5omz8290xs+hzoVMDcsm1A3P4l1khhx4cEYMeZtI5SDItsxXyOjgAvOSauQxXIIItMspVcFk2Ak5IVD9IQBtN3k2wdRQirOjrGqHkmrH0VZCzT9liYOu87zHq8LGBAjgob+4hIJmW6DuXi0dEZxStnfdILhwIsJ70y/yROfOkbET6P8duyADFNLbDfiJeBAAAAAElFTkSuQmCC" alt="未学习"></div></div> <!----></div> <br data-v-58426d58=""></div></div></div></div></div></div></div></div></div> <div data-v-d68b6290="" class="drag can-drag" style="display: none;"></div> <div data-v-d68b6290="" class="drag can-not-drag" style="left: 188.234px;"></div> <div data-v-531a5542="" data-v-bebca12e="" data-v-d68b6290="" class="right-box" style="width: 2369.77px;"><!----> <!----> <!----> <div data-v-d685947a="" data-v-bebca12e="" class="iframe-env" data-v-531a5542=""><iframe data-v-d685947a="" src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/lab.html" class="iframe"></iframe> <div data-v-d685947a="" class="copyright">
    *本课程内容由作者授权实验楼发布，未经允许，禁止转载、下载及非法传播
  </div></div> <!----> <!----></div> <div data-v-37b730a4="" data-v-d68b6290="" class="lab-tools show"><div data-v-37b730a4="" class="toggle-btn"><i data-v-37b730a4="" class="fa fa-angle-double-right"></i></div> <div data-v-18205388="" data-v-37b730a4="" class="left-time"><div data-v-18205388="" class="text">
    39:35
  </div> <button data-v-18205388="" type="button" class="btn add-time-btn btn-secondary">
    延时
  </button> <!----></div> <!----> <div data-v-37b730a4="" class="divide"></div> <div data-v-c19f4d44="" data-v-37b730a4=""><button data-v-c19f4d44="" type="button" class="btn stop-lab-btn btn-danger"><i data-v-c19f4d44="" class="fa fa-stop"></i>
    关闭环境
  </button> <!----> <div data-v-5751383a="" data-v-78fab3f2="" data-v-c19f4d44="" class="base-left-modal" style="display: none;"><div data-v-5751383a="" class="box"><div data-v-5751383a="" class="close"><i data-v-5751383a="" class="fa fa-times"></i></div> <div data-v-5751383a="" class="content"><div data-v-78fab3f2="" data-v-5751383a="">
    选择想要替换的环境
    <div data-v-78fab3f2="" data-v-5751383a="" class="modal-sub-title">
      （被替换的环境将被删除）
    </div></div></div>  <div data-v-78fab3f2="" data-v-5751383a=""><div data-v-78fab3f2="" data-v-5751383a="" class="items"></div> <div data-v-78fab3f2="" data-v-5751383a="" class="footer"><button data-v-78fab3f2="" data-v-5751383a="" type="button" class="btn confirm-btn btn-primary">
        确认
      </button> <div data-v-78fab3f2="" data-v-5751383a="">
        返回上一步
      </div></div></div></div></div></div> <div data-v-37b730a4="" class="divide"></div> <!----> <!----> <!----> <!----> <div data-v-e7838ea4="" data-v-37b730a4=""><div data-v-e7838ea4="" class="common-btn"><div data-v-e7838ea4=""><i data-v-e7838ea4="" class="fa fa-arrows-alt"></i>
    桌面全屏
  </div></div> </div> <div data-v-37b730a4="" class="divide"></div> <!----> <!----> <!----> <div data-v-e7838ea4="" data-v-37b730a4=""><div data-v-e7838ea4="" class="common-btn"><div data-v-e7838ea4=""><i data-v-e7838ea4="" class="fa fa-bookmark-o"></i>
    环境使用指南
  </div></div> </div></div> <div class="messages" data-v-817ed8d0="" data-v-d68b6290=""><!----></div> <!----> <!----> <!----> <div class="hundred-level-modal" data-v-d68b6290=""><!----></div></div> <div data-v-57a4eb3b=""><!----> <!----></div> <div class="risk-validation" data-v-62b04b40="" data-v-57a4eb3b=""><!----></div> <!----> <!----> <!----></div>  <!----> <!----> <div class="flash-message" data-v-6fbfd453="" data-v-57a4eb3b=""><!----></div> <!----></div></div></div><script>window.__NUXT__=(function(a,b,c,d,e,f){return {layout:"body-layout",data:[{}],error:a,state:{env:{nodeEnv:"production",apiEndpointV1:f,apiEndpointV2:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2",apiEndpointLocalV1:f,apiEndpointLocalV2:"http:\u002F\u002Fshiyanlou-v2-web-svc\u002Fapi\u002Fv2",cometServiceUrl:"wss:\u002F\u002Fcomet.shiyanlou.com",staticHost:"https:\u002F\u002Fstatic.shiyanlou.com\u002Ffrontend\u002Fstatic",menuHost:f},teacher:{course:{},labs:[],monthData:[],courseUserStatus:{},courseStudents:[],labReports:[],activeLab:{},publishedCourses:[],comments:{},commentStatus:[],questions:{},"mutation-types":{}},labTask:{showLabTask:e,labTask:a,savedEnv:a},library:{navData:{},blocks:[],book:{},chapters:[],chapterContents:{},activeChapterSlug:c,isLiked:b,isMarked:b,"mutation-types":{}},live:{notEndedLiveCourses:{},endedLiveCourses:{},liveLab:{},course:{},liveUserStatus:{},chatroomInfo:{},chatroomUserInfo:{},chatroomAuthPayload:{},"mutation-types":{}},home:{courseCategories:c,swapper:c,classicalCourse:c,recentLouplus:c,popularBootCamp:c,popularPath:c,advertisement:c,advertisementStatus:{height:d,show:b},"mutation-types":{}},mall:{products:{},product:{},order:{},"mutation-types":{}},message:{show:b,type:c,message:c,"mutation-types":{}},messages:{messages:{},"mutation-types":{}},path:{paths:[],path:{},pathUserStatus:c,stage_list:[],"mutation-types":{}},promotion:{promotion:{},coupon:{},"mutation-types":{}},course:{categories:[],courses:{},coursesUserStatus:[],course:{},labStages:[],labDocData:{},labsUserStatus:[],activeLab:{},questions:{},reports:{},isReply:b,answer:{},comments:{},commentsUserStatus:[],replayUser:{},startLabLoading:b,studentMeta:{order:[],data:{}},relatedCourseGroups:[],pathNextCourses:[],recentlyContests:[],relatedChallenges:[],courseTopStudents:[],monthData:[],students:[],runningStudents:[],louplusStudentsRankData:{},"mutation-types":{},actions:{id:{}}},user:{userBaseInfo:{},userPublicInfo:{},userStudyRecords:{},userVisitors:[],userReportStatistic:{},userCoursesStatus:[],userMedals:[],editableUserInfo:{},editUserInfoStatus:{nickname:b,school:b},editUserPassword:{status:b,newPwd:c,oldPwd:c},hundredLevelUserInfo:{},userEmailSettings:{},courseRecordAction:{},oauthStatus:{},certificate:{},userCertificates:[],"mutation-types":{}},contest:{contests:a,contest_detail:a,contests_rank:a,contest_rank:{results:[]},contest_list:[],user_contest_status:{},"mutation-types":{}},question:{questions:{count:d,results:[]},question:{},questionUserStatus:{},relatedQuestions:[],answers:{},answer:{},answersUserStatus:[],isReply:b,"mutation-types":{},utils:{},actions:{question:{},"question.config":{},answer:{},"answer.config":{}}},challenge:{challenges:a,challengesStatus:a,challenge_tags:[],submissions:a,answers:a,lab_document:{},submission:{},challenge:{},modal:b,modal_content:{},"mutation-types":{}},report:{reports:{},report:{},user_status:[],related:[],study_data:{},lab_user_status:{},"mutation-types":{}},bootcamp:{courses:{},categories:[],"mutation-types":{}},search:{results:{},"mutation-types":{}},auth:{loggedIn:e,user:{id:1183262,name:"LOU263208170",avatar_url:"https:\u002F\u002Fdn-simplecloud.shiyanlou.com\u002Fgravatar2v5mHQBVw6yI.jpg?imageView2\u002F1\u002Fw\u002F200\u002Fh\u002F200",is_graduated:b,job_title:a,school:a,level:39,member_type:a,teacher_info:a,labels:[],join_date:"2019-10-29",status:"active",html_url:"\u002Fusers\u002F1183262",api_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002F",courses_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fcourses\u002F",questions_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fquestions\u002F",comments_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fcomments\u002F",contests_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fcontests\u002F",studied_courses_count:15,followed_courses_count:d,published_courses_count:d,marked_books_count:d,is_site_admin:b,is_teacher:b,email:a,is_email_validated:b,phone:"+8618813017082",beans:"42",created_at:"2019-10-29T11:27:24+08:00",study_minutes:1167,free_minutes:d,today_study_minutes:144,bought_courses_count:1,study_labs_count:250,basic_member_expired_at:a,plus_member_expired_at:a,premium_member_expired_at:a,invitation_html_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fregister?inviter=NTY0MzIwMTk1OTM3",member_invitation_code:c,have_saved_vm:b,enterprise_html_url:c,unread_messages_count:d,is_enterprise_admin:b,session_id:"5a2cfa65-fc80-4e84-a420-d06433e55aa4.S_65c8XreZj83PHvVGwhvwXTDoc",is_set_password:e,roles:[],abilities:[],in_bailou_club:b,course_quota:2,is_subscribe_mp:b},isChecked:b,risk:{isRisk:b},authTokens:{},beans:d,signActive:"signInForm",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJNb0h1bWZGeWt3bFdmT2JoNVVSSXpvNEdrV0dHVFZpdSIsImlhdCI6MTU3Mzc5MzEwNiwiZXhwIjoxNTczODc5NTA2fQ.uMrcoMdQ95Jl_bEHT80sEhSkU6-9eFWId9DBNXCHXmA","mutation-types":{},redirect:"\u002Fcourses\u002F1091\u002Flearning\u002F"},sideBox:{recentLouplus:[],recentActivity:[],followedPath:[],"mutation-types":{}},activity:{activity:{start_at:a,end_at:a,member_config:a,bootcamp_config:a,louplus_config:a},rules:[{product_type:"premium",discount_type:"present",derate_money:d,second_kill_price:a,second_kill_amount:d,extra_config:{progress:d,quota:d},present_days:30,discount_percent:"1.000",course_ids:[],buy_days:365}],modal:{activity_id:a,start_at:a,end_at:a,config:a},"mutation-types":{}},louplus:{louplusInfo:{},louplusList:[],louplusUserStatus:{},"mutation-types":{}}},serverRendered:e}}(null,false,"",0,true,"https:\u002F\u002Fwww.shiyanlou.com"));</script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/f3a337105fb6129b39d1.js.下载" defer=""></script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/13652036f3502b0c6db7.js.下载" defer=""></script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/cc58aae2d5b624e45e75.js.下载" defer=""></script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/34e4120db4a53410cbcd.js.下载" defer=""></script><script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/0eed17603f033879ebbc.js.下载" defer=""></script>
  

<script src="./Pandas 百题大冲关 - Pandas 百题大冲关｜学习版 - 实验楼_files/guide.js.下载"></script><script></script></body></html>