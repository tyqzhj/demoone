(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{1063:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"withParams",{enumerable:!0,get:function(){return o.default}}),t.regex=t.ref=t.len=t.req=void 0;var r,o=(r=n(1101))&&r.__esModule?r:{default:r};function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=function(e){if(Array.isArray(e))return!!e.length;if(null==e)return!1;if(!1===e)return!0;if(e instanceof Date)return!isNaN(e.getTime());if("object"===c(e)){for(var t in e)return!0;return!1}return!!String(e).length};t.req=l;t.len=function(e){return Array.isArray(e)?e.length:"object"===c(e)?Object.keys(e).length:String(e).length};t.ref=function(e,t,n){return"function"==typeof e?e.call(t,n):n[e]};t.regex=function(e,t){return(0,o.default)({type:e},function(e){return!l(e)||t.test(e)})}},1076:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"alpha",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"alphaNum",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"numeric",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"between",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"email",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"ipAddress",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"macAddress",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"maxLength",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"minLength",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"required",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"requiredIf",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"requiredUnless",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"sameAs",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(t,"url",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"or",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(t,"and",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(t,"not",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(t,"minValue",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"maxValue",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(t,"integer",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(t,"decimal",{enumerable:!0,get:function(){return E.default}}),t.helpers=void 0;var r=M(n(1100)),o=M(n(1103)),c=M(n(1104)),l=M(n(1105)),d=M(n(1106)),f=M(n(1107)),h=M(n(1108)),m=M(n(1109)),v=M(n(1110)),_=M(n(1111)),w=M(n(1112)),y=M(n(1113)),P=M(n(1114)),k=M(n(1115)),C=M(n(1116)),x=M(n(1117)),j=M(n(1118)),O=M(n(1119)),S=M(n(1120)),$=M(n(1121)),E=M(n(1122)),A=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};desc.get||desc.set?Object.defineProperty(t,n,desc):t[n]=e[n]}return t.default=e,t}(n(1063));function M(e){return e&&e.__esModule?e:{default:e}}t.helpers=A},1100:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(1063).regex)("alpha",/^[a-zA-Z]*$/);t.default=r},1101:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r="web"===e.env.BUILD?n(1102).withParams:n(562).withParams;t.default=r}).call(this,n(59))},1102:function(e,t,n){"use strict";(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.withParams=void 0;var r="undefined"!=typeof window?window:void 0!==e?e:{},o=r.vuelidate?r.vuelidate.withParams:function(e,t){return"object"===n(e)&&void 0!==t?t:e(function(){})};t.withParams=o}).call(this,n(42))},1103:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(1063).regex)("alphaNum",/^[a-zA-Z0-9]*$/);t.default=r},1104:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(1063).regex)("numeric",/^[0-9]*$/);t.default=r},1105:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e,t){return(0,r.withParams)({type:"between",min:e,max:t},function(n){return!(0,r.req)(n)||(!/\s/.test(n)||n instanceof Date)&&+e<=+n&&+t>=+n})}},1106:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(1063).regex)("email",/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/);t.default=r},1107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063),o=(0,r.withParams)({type:"ipAddress"},function(e){if(!(0,r.req)(e))return!0;if("string"!=typeof e)return!1;var t=e.split(".");return 4===t.length&&t.every(c)});t.default=o;var c=function(e){if(e.length>3||0===e.length)return!1;if("0"===e[0]&&"0"!==e)return!1;if(!e.match(/^\d+$/))return!1;var t=0|+e;return t>=0&&t<=255}},1108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":";return(0,r.withParams)({type:"macAddress"},function(t){if(!(0,r.req)(t))return!0;if("string"!=typeof t)return!1;var n="string"==typeof e&&""!==e?t.split(e):12===t.length||16===t.length?t.match(/.{2}/g):null;return null!==n&&(6===n.length||8===n.length)&&n.every(o)})};var o=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)}},1109:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"maxLength",max:e},function(t){return!(0,r.req)(t)||(0,r.len)(t)<=e})}},1110:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"minLength",min:e},function(t){return!(0,r.req)(t)||(0,r.len)(t)>=e})}},1111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063),o=(0,r.withParams)({type:"required"},r.req);t.default=o},1112:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"requiredIf",prop:e},function(t,n){return!(0,r.ref)(e,this,n)||(0,r.req)(t)})}},1113:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"requiredUnless",prop:e},function(t,n){return!!(0,r.ref)(e,this,n)||(0,r.req)(t)})}},1114:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"sameAs",eq:e},function(t,n){return t===(0,r.ref)(e,this,n)})}},1115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(1063).regex)("url",/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?$/i);t.default=r},1116:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.withParams)({type:"or"},function(){for(var e=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.length>0&&t.reduce(function(t,n){return t||n.apply(e,r)},!1)})}},1117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.withParams)({type:"and"},function(){for(var e=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.length>0&&t.reduce(function(t,n){return t&&n.apply(e,r)},!0)})}},1118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"not"},function(t,n){return!(0,r.req)(t)||!e.call(this,t,n)})}},1119:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"minValue",min:e},function(t){return!(0,r.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t>=+e})}},1120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1063);t.default=function(e){return(0,r.withParams)({type:"maxValue",max:e},function(t){return!(0,r.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t<=+e})}},1121:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(1063).regex)("integer",/^-?[0-9]*$/);t.default=r},1122:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(1063).regex)("decimal",/^[-]?\d*(\.\d+)?$/);t.default=r},1671:function(e,t,n){},1672:function(e,t,n){},1673:function(e,t,n){},1674:function(e,t,n){},1675:function(e,t,n){},1676:function(e,t,n){},1677:function(e,t,n){},1678:function(e,t,n){},1679:function(e,t,n){},1680:function(e,t,n){},1681:function(e,t,n){},1682:function(e,t,n){},1683:function(e,t,n){},1684:function(e,t,n){},1685:function(e,t,n){},1686:function(e,t,n){},1687:function(e,t,n){},1688:function(e,t,n){},1689:function(e,t,n){},1690:function(e,t,n){},1691:function(e,t,n){},1692:function(e,t,n){},1693:function(e,t,n){},1694:function(e,t,n){},1695:function(e,t,n){},1696:function(e,t,n){},2317:function(e,t,n){"use strict";var r=n(1671);n.n(r).a},2318:function(e,t,n){"use strict";var r=n(1672);n.n(r).a},2319:function(e,t,n){"use strict";var r=n(1673);n.n(r).a},2320:function(e,t,n){"use strict";var r=n(1674);n.n(r).a},2321:function(e,t,n){"use strict";var r=n(1675);n.n(r).a},2322:function(e,t,n){"use strict";var r=n(1676);n.n(r).a},2323:function(e,t,n){"use strict";var r=n(1677);n.n(r).a},2324:function(e,t,n){"use strict";var r=n(1678);n.n(r).a},2325:function(e,t,n){"use strict";var r=n(1679);n.n(r).a},2326:function(e,t,n){"use strict";var r=n(1680);n.n(r).a},2327:function(e,t,n){"use strict";var r=n(1681);n.n(r).a},2328:function(e,t,n){"use strict";var r=n(1682);n.n(r).a},2329:function(e,t,n){"use strict";var r=n(1683);n.n(r).a},2330:function(e,t,n){"use strict";var r=n(1684);n.n(r).a},2331:function(e,t,n){"use strict";var r=n(1685);n.n(r).a},2332:function(e,t,n){"use strict";var r=n(1686);n.n(r).a},2333:function(e,t,n){"use strict";var r=n(1687);n.n(r).a},2334:function(e,t,n){"use strict";var r=n(1688);n.n(r).a},2335:function(e,t,n){"use strict";var r=n(1689);n.n(r).a},2336:function(e,t,n){"use strict";var r=n(1690);n.n(r).a},2337:function(e,t,n){"use strict";var r=n(1691);n.n(r).a},2338:function(e,t,n){"use strict";var r=n(1692);n.n(r).a},2339:function(e,t,n){"use strict";var r=n(1693);n.n(r).a},2340:function(e,t,n){"use strict";var r=n(1694);n.n(r).a},2341:function(e,t,n){"use strict";var r=n(1695);n.n(r).a},2342:function(e,t,n){"use strict";var r=n(1696);n.n(r).a},2879:function(e,t,n){"use strict";n.r(t);var r=n(1),o=(n(105),n(83),n(95),n(46),n(39),n(24),n(124),n(13),n(2)),c=n(10),l={data:function(){return{sending:!1,sended:!1}},methods:Object(r.a)({},Object(c.b)("user",["sendEmail"]),{sendVerifyEmail:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.sending=!0,this.sended=!0,e.next=4,this.sendEmail();case 4:(t=e.sent).ok?this.$actionMessage(!0,t.data.message,!1,""):this.$actionMessage(!1,"邮件发送失败，请稍后重试",!1,""),this.sending=!1;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()})},d=(n(2317),n(5)),f=Object(d.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"verity-mailbox vertical-center"},[r("img",{attrs:{src:n(591),alt:"未验证"}}),e._v("\n   \n  "),r("span",[e._v("\n    邮箱尚未验证，如果没有收到验证邮件，可点击\n  ")]),e._v("\n   \n  "),e.sending?r("button",{staticClass:"sending"},[e._v("\n    正在发送中...\n  ")]):r("button",{on:{click:e.sendVerifyEmail}},[e._v("\n    "+e._s(e.sended?"重发邮件":"发送邮件")+"\n  ")])])},[],!1,null,"66da2895",null).exports,h=(n(96),n(28),n(84),n(209)),m={props:{userAvatar:{type:String,required:!0},setUserAvatar:{type:Function,default:null}},data:function(){return{image:null}},methods:{handleSelectImage:function(){this.$refs.image.$el.firstChild.click()},onInput:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,n,r,o,c,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)(this,"simplecloud");case 2:t=e.sent,n=t.token,r=t.key,o=t.domain,(c=t.message)&&this.$actionMessage(!1,c),Object(h.b)(this.image,n,r,o,function(e){l.setUserAvatar(e.link)});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},v=(n(2318),Object(d.a)(m,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-avatar"},[n("b-form-group",{attrs:{id:"user-avatar",label:"头像","label-for":"avatar","label-cols":"2",horizontal:!0}},[n("div",{staticClass:"img-container inline-block",on:{click:e.handleSelectImage}},[n("img",{attrs:{src:e.userAvatar,alt:""}}),e._v(" "),n("span",[e._v("\n        修改头像\n      ")]),e._v(" "),n("b-form-file",{ref:"image",staticClass:"upload-image",on:{input:e.onInput},model:{value:e.image,callback:function(t){e.image=t},expression:"image"}})],1)])],1)},[],!1,null,"a7105100",null).exports),_=n(1076),w=_.helpers.regex("checkNickname",/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/),y={props:{userNickname:{type:String,default:""},setUserNickname:{type:Function,default:null}},data:function(){return{nickname:this.userNickname}},watch:{userNickname:function(e){this.nickname||(this.nickname=e)}},validations:{nickname:{required:_.required,checkNickname:w}},methods:{setNickName:function(e){this.$v.$invalid||this.setUserNickname(this.nickname),this.nickname||this.setUserNickname("")}}},P=(n(2319),Object(d.a)(y,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-nickname"},[n("b-form-group",{attrs:{id:"user-nickname",label:"昵称","label-for":"nickname","label-cols":"2",horizontal:!0}},[n("b-form-input",{attrs:{id:"nickname",type:"text",placeholder:"用户名(必填)"},on:{input:e.setNickName},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}})],1),e._v(" "),e.$v.$invalid?n("div",{staticClass:"form-row"},[n("b-col",{attrs:{offset:"2"}},[e.$v.nickname.checkNickname?e._e():n("div",{staticClass:"error-message"},[n("i",{staticClass:"fa fa-times-circle"}),e._v("\n        用户名只能包括中文、字母、数字及下划线。\n      ")]),e._v(" "),e.$v.nickname.required?e._e():n("div",{staticClass:"error-message"},[n("i",{staticClass:"fa fa-times-circle"}),e._v("\n        用户名为必填字段。\n      ")])])],1):e._e()],1)},[],!1,null,"4b751c5e",null).exports),k=["Web前端工程师","Python研发工程师","NodeJS研发工程师","JAVA研发工程师","C/C++研发工程师",".NET研发工程师","PHP研发工程师","Ruby研发工程师","Linux研发工程师","iOS研发工程师","Android工程师","运维工程师","测试工程师","硬件开发工程师","DBA工程师","产品经理","教师","其他"],C={props:{userJobTitle:{type:String,default:""},setJobTitle:{type:Function,default:null}},data:function(){return{selected:"",options:k}},mounted:function(){k.includes(this.userJobTitle)?this.selected=this.userJobTitle:this.selected="其他"}},x=(n(2320),Object(d.a)(C,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-position"},[n("b-form-group",{attrs:{id:"user-job",label:"职位","label-for":"job-title","label-cols":"2",horizontal:!0}},[n("b-form-select",{staticClass:"mb-3",attrs:{id:"job-title",options:e.options},on:{input:function(t){return e.setJobTitle(e.selected)}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1)},[],!1,null,"7a3d0e43",null).exports),j={props:{userSchool:{type:String,default:""},setSchool:{type:Function,default:null}},data:function(){return{school:this.userSchool}},watch:{userSchool:function(e){this.school||(this.school=e)}},validations:{school:{required:_.required}},methods:{setUserSchool:function(e){this.$v.$invalid||this.setSchool(e),e||this.setSchool("")}}},O=(n(2321),Object(d.a)(j,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-school"},[n("b-form-group",{attrs:{id:"user-school",label:"我的学校","label-for":"input-school","label-cols":"2",horizontal:!0}},[n("b-form-input",{attrs:{type:"text",placeholder:"填写在读学校"},on:{input:e.setUserSchool},model:{value:e.school,callback:function(t){e.school=t},expression:"school"}})],1),e._v(" "),e.$v.$invalid?n("div",{staticClass:"form-row"},[n("b-col",{attrs:{offset:"2"}},[e.$v.school.required?e._e():n("div",{staticClass:"error-message no-margin"},[n("i",{staticClass:"fa fa-times-circle"}),e._v("\n        学校名不能为空。\n      ")])])],1):e._e()],1)},[],!1,null,"3a877e92",null).exports),S={props:{isGraduated:{type:Boolean,default:!1},setGraduateStatus:{type:Function,default:null}},data:function(){return{graduated:!1,options:[{text:"在上学",value:!1},{text:"在工作",value:!0}]}},watch:{isGraduated:function(e){this.graduated=e}}},$=(n(2322),{components:{UserAvatar:v,UserNickname:P,UserPosition:x,UserSchool:O,UserStatus:Object(d.a)(S,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-status"},[n("b-form-group",{attrs:{id:"graduate-status",label:"我的状态","label-for":"checkbox-graduate","label-cols":"2",horizontal:!0}},[n("b-form-radio-group",{attrs:{id:"radios1",options:e.options,name:"graduate"},on:{input:e.setGraduateStatus},model:{value:e.graduated,callback:function(t){e.graduated=t},expression:"graduated"}})],1)],1)},[],!1,null,"167027fe",null).exports},data:function(){return{newInfo:{name:"",is_graduated:!1,school:"",job_title:"",avatar_url:""}}},computed:{userInfo:function(){return this.$auth.user},canSubmit:function(){return!!this.newInfo.name&&(!!this.newInfo.avatar_url&&(!(this.newInfo.is_graduated&&!this.newInfo.job_title)&&!(!this.newInfo.is_graduated&&!this.newInfo.school)))}},mounted:function(){for(var e=0,t=Object.keys(this.newInfo);e<t.length;e++){var n=t[e];this.newInfo[n]=this.userInfo[n]}},methods:{setAvatar:function(e){this.newInfo.avatar_url=e},setGraduateStatus:function(e){this.newInfo.is_graduated=e},setNickName:function(e){this.newInfo.name=e},setSchool:function(e){this.newInfo.school=e,this.newInfo.job_title=""},setJobTitle:function(e){this.newInfo.job_title=e,this.newInfo.school=""},udpateUserInfo:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canSubmit){e.next=2;break}return e.abrupt("return");case 2:return(t=Object(r.a)({},this.newInfo)).is_graduated?delete t.school:delete t.job_title,e.next=6,this.$ajax.patch(this.$urls.user,t);case 6:(n=e.sent).ok?this.$actionMessage(!0,"更新"):(o=n.response.data&&n.response.data.message,this.$actionMessage(!1,o||"更新失败",!1,"",""));case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}}),E=(n(2323),Object(d.a)($,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container content-container"},[n("div",{staticClass:"row-wrapper"},[n("user-avatar",{attrs:{"user-avatar":e.newInfo.avatar_url,"set-user-avatar":e.setAvatar}})],1),e._v(" "),n("div",{staticClass:"row-wrapper"},[n("user-nickname",{attrs:{"user-nickname":e.newInfo.name,"set-user-nickname":e.setNickName}})],1),e._v(" "),n("div",{staticClass:"row-wrapper"},[n("user-status",{attrs:{"is-graduated":e.newInfo.is_graduated,"set-graduate-status":e.setGraduateStatus}})],1),e._v(" "),n("div",{staticClass:"row-wrapper"},[e.newInfo.is_graduated?n("user-position",{attrs:{"user-job-title":e.newInfo.job_title,"set-job-title":e.setJobTitle}}):n("user-school",{attrs:{"user-school":e.newInfo.school,"set-school":e.setSchool}})],1),e._v(" "),n("div",{staticClass:"row-wrapper form-row"},[n("b-col",{attrs:{offset:"2"}},[n("button",{staticClass:"btn btn-primary",attrs:{disabled:!e.canSubmit},on:{click:e.udpateUserInfo}},[e._v("\n        保存\n      ")])])],1)])},[],!1,null,"4aeb6670",null).exports),A={components:{},data:function(){return{status:!1,message:"",phoneObj:{},codeMessage:"",phoneNum:"",captcha:"",isSended:!1}},computed:Object(r.a)({},Object(c.d)("auth",{risk:function(e){return e.risk}})),methods:Object(r.a)({},Object(c.b)("user",["sendCode"]),{updatePhone:function(e){this.phoneNum=e},changePhone:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.post(this.$urls.changePhone,{phone:this.phoneNum,captcha:this.captcha});case 2:(t=e.sent).ok?(this.$actionMessage(!0,"修改手机号"),this.phoneNum="",this.captcha="",this.message="",this.$emit("changeSuccess")):(this.status=!1,this.message=t.message);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),updateCaptcha:function(e){this.captcha=e}})},M=(n(2324),{components:{NewPhone:Object(d.a)(A,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"new-phone"},[n("div",{staticClass:"phone-num"},[n("b-form-group",{staticClass:"input-group"},[n("phone-number-input",{attrs:{update:e.updatePhone}})],1)],1),e._v(" "),e.message?n("small",{staticClass:"feedback",class:[e.status?"color-primary":"color-red"]},[e._v("\n    "+e._s(e.message)+"\n  ")]):e._e(),e._v(" "),n("div",{staticClass:"code-container"},[n("b-form-group",{staticClass:"input-group"},[n("phone-captcha-input",{attrs:{update:e.updateCaptcha,"phone-number":e.phoneNum,action:"change_phone"}})],1)],1),e._v(" "),n("small",{staticClass:"feedback",class:[e.status?"color-primary":"color-red"]},[e._v("\n    "+e._s(e.codeMessage?e.codeMessage:" ")+"\n  ")]),e._v(" "),n("button",{staticClass:"btn btn-primary",attrs:{disabled:!e.phoneNum||!e.captcha},on:{click:e.changePhone}},[e._v("\n    修改完成\n  ")])])},[],!1,null,"a9e56b18",null).exports},props:{userPhone:{type:String,default:""},formatPhone:{type:String,default:""}},data:function(){return{code:"",message:"",status:!1,isSended:!1,appealContent:this.$marked("请发送申诉邮件到  \n**support@shiyanlou.com**  \n我们会在 2 个工作日内处理\n"),consultAppeal:!1,newPhoneAppeal:!1,showModal:!1}},computed:Object(r.a)({},Object(c.d)("auth",{risk:function(e){return e.risk}}),{codeValidity:function(){return/^\d\d{4}\d$/.test(this.code)}}),methods:{showConsultAppeal:function(){this.consultAppeal=!0},verifyCode:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.codeValidity){e.next=4;break}return this.status=!1,this.message="验证码为6位数字",e.abrupt("return");case 4:return e.next=6,this.$ajax.post(this.$urls.verifyCode("change_phone"),{phone_number:this.userPhone,code:this.code});case 6:e.sent.ok?(this.newPhoneAppeal=!0,this.message=""):(this.status=!1,this.message="验证码错误");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),hideConsultAppeal:function(){this.consultAppeal?this.consultAppeal=!1:this.newPhoneAppeal=!1},handleChangeSuccess:function(){this.newPhoneAppeal=!1,this.showConsultAppeal=!1,this.code="",this.message="",this.showModal=!1,location.href=location.pathname+"#auth",location.reload()},updateCaptcha:function(e){this.code=e}}}),I=(n(2325),n(2326),Object(d.a)(M,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"updatePhone",title:"修改手机",size:"sm","hide-footer":"","modal-class":"user-update-phone-modal","no-close-on-backdrop":!0},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("div",{staticClass:"modal-title-slot",attrs:{slot:"modal-title"},slot:"modal-title"},[e.consultAppeal?n("i",{staticClass:"fa fa-chevron-left",on:{click:e.hideConsultAppeal}}):e._e(),e._v(" "),n("span",[e._v("修改手机")])]),e._v(" "),n("div",{staticClass:"update-phone-body",class:{"show-consult-appeal":e.consultAppeal,"show-new-phone-appeal":e.newPhoneAppeal}},[n("div",{staticClass:"phone-num"},[e._v("\n        "+e._s(e.formatPhone)+"\n      ")]),e._v(" "),n("div",{staticClass:"appeal-help",on:{click:e.showConsultAppeal}},[e._v("\n        手机号不能用了\n      ")]),e._v(" "),n("div",{staticClass:"input-container"},[n("b-form-group",{staticClass:"input-group"},[n("phone-captcha-input",{attrs:{update:e.updateCaptcha,"phone-number":e.userPhone,action:"change_phone"}})],1)],1),e._v(" "),n("small",{class:[e.status?"color-primary":"color-red"]},[e._v("\n        "+e._s(e.message?e.message:" ")+"\n      ")]),e._v(" "),n("div",{staticClass:"next"},[n("button",{staticClass:"btn btn-primary btn-next",on:{click:e.verifyCode}},[e._v("\n          下一步\n        ")])])]),e._v(" "),n("div",{staticClass:"appeal-content",class:{"show-consult-appeal":e.consultAppeal},domProps:{innerHTML:e._s(e.appealContent)}}),e._v(" "),n("new-phone",{class:{"show-new-phone-appeal":e.newPhoneAppeal},on:{changeSuccess:e.handleChangeSuccess}})],1)],1)},[],!1,null,null,null).exports),N={props:{bindPhone:{type:Function,default:null},postUrl:{type:String,default:""},handleCancel:{type:Function,default:null}},data:function(){return{captcha:"",phone:""}},computed:Object(r.a)({},Object(c.d)("risk",{risk:function(e){return e.risk}})),methods:Object(r.a)({},Object(c.b)("user",["sendCode"]),{updateCaptcha:function(e){this.captcha=e},updatePhone:function(e){this.phone=e},handleBind:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.postUrl){e.next=7;break}return e.next=4,this.$ajax.post(this.postUrl,{phone_number:this.phone,code:this.captcha});case 4:t=e.sent,e.next=10;break;case 7:return e.next=9,this.$ajax.post(this.$urls.changePhone,{phone:this.phone,captcha:this.captcha});case 9:t=e.sent;case 10:t.ok?(this.$showMessage("success",t.data.message||"绑定成功"),this.bindPhone?this.bindPhone(this.phoneNum):location.reload()):this.$showMessage("danger",t.message);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()})},R=(n(2327),{components:{updatePhoneModal:I,editPhoneNum:Object(d.a)(N,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"edit-phone-num"},[n("b-form-group",{staticClass:"input-group"},[n("phone-number-input",{attrs:{"default-country":"CN",update:e.updatePhone}})],1),e._v(" "),n("b-form-group",{staticClass:"input-group"},[n("phone-captcha-input",{attrs:{update:e.updateCaptcha,"phone-number":e.phone,action:"change_phone"}})],1),e._v(" "),n("p",{staticClass:"flex space-between"},[n("b-btn",{staticClass:"btn-bind font-14",attrs:{variant:"outline-secondary"},on:{click:e.handleCancel}},[e._v("\n      取消\n    ")]),e._v(" "),n("b-btn",{staticClass:"btn-bind font-14",attrs:{variant:"primary",disabled:!e.phone||!e.captcha},on:{click:e.handleBind}},[e._v("\n      绑定\n    ")])],1)],1)},[],!1,null,"6c917db2",null).exports},props:{userPhone:{type:String,default:""}},data:function(){return{editPhone:!1}},computed:{formatPhone:function(){var e=String(this.userPhone).split("");return e.splice(-8,4,"****"),e.join("")}},methods:{showEditPhoneNum:function(){this.editPhone=!0},cancelEdit:function(){this.editPhone=!1}}}),T=(n(2328),Object(d.a)(R,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-phone"},[n("span",[e._v("\n    手机\n  ")]),e._v(" "),e.userPhone?n("span",[e._v("\n    "+e._s(e.userPhone?e.formatPhone:"******")+"\n  ")]):e.userPhone||e.editPhone?e._e():n("span",[e._v("\n    未绑定\n  ")]),e._v(" "),e.userPhone?n("span",{directives:[{name:"b-modal",rawName:"v-b-modal.updatePhone",modifiers:{updatePhone:!0}}]},[e._v("\n    点击修改\n  ")]):e.userPhone||e.editPhone?e._e():n("span",{on:{click:e.showEditPhoneNum}},[e._v("\n    点击绑定\n  ")]),e._v(" "),e.editPhone?n("edit-phone-num",{attrs:{"handle-cancel":e.cancelEdit}}):e._e(),e._v(" "),n("update-phone-modal",{attrs:{"user-phone":e.userPhone,"format-phone":e.userPhone&&e.formatPhone}})],1)},[],!1,null,"081c02b8",null).exports),U={props:{hasPassword:{type:Boolean,default:!1}},data:function(){return{oldPwd:"",newPwd:"",encrypt:!0,message:""}},computed:{pwdValidity:function(){return this.hasPassword?this.oldPwd.length>=6&&this.newPwd.length>=6:this.newPwd.length>=6}},methods:{handleCancel:function(){this.oldPwd="",this.newPwd="",this.$emit("close")},showPassword:function(){this.encrypt=!this.encrypt},handleSubmit:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.message="",t={new_password:this.newPwd},this.hasPassword&&(t.old_password=this.oldPwd),e.next=5,this.$ajax.post(this.$urls.userChangePwd,t);case 5:(n=e.sent).ok?(this.$actionMessage(!0,n.data.message||"密码修改"),this.handleCancel(),location.href=location.pathname+"#auth",location.reload()):this.message=n.message;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},B=(n(2329),{components:{PasswordEditor:Object(d.a)(U,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"edit-password"},[e.hasPassword?[n("div",{staticClass:"origin-password"},[n("span",[e._v("原密码")]),e._v(" "),n("b-form-input",{attrs:{type:"password",placeholder:"至少六位字符",autocomplete:"new-password"},model:{value:e.oldPwd,callback:function(t){e.oldPwd="string"==typeof t?t.trim():t},expression:"oldPwd"}})],1),e._v(" "),n("div",{staticClass:"new-password"},[n("span",[e._v("新密码")]),e._v(" "),n("b-form-input",{attrs:{type:e.encrypt?"password":"text",placeholder:"至少六位字符"},model:{value:e.newPwd,callback:function(t){e.newPwd="string"==typeof t?t.trim():t},expression:"newPwd"}}),e._v(" "),n("i",{staticClass:"fa",class:e.encrypt?"fa-eye-slash":"fa-eye",on:{click:e.showPassword}})],1),e._v(" "),n("small",{staticClass:"inline-block color-red message"},[e._v("\n      "+e._s(e.message)+"\n    ")])]:[n("div",{staticClass:"new-password"},[n("span",[e._v("新密码")]),e._v(" "),n("b-form-input",{attrs:{type:e.encrypt?"password":"text",placeholder:"至少六位字符"},model:{value:e.newPwd,callback:function(t){e.newPwd="string"==typeof t?t.trim():t},expression:"newPwd"}}),e._v(" "),n("i",{staticClass:"fa",class:e.encrypt?"fa-eye-slash":"fa-eye",on:{click:e.showPassword}})],1),e._v(" "),n("small",{staticClass:"inline-block color-red message"},[e._v("\n      "+e._s(e.message)+"\n    ")])],e._v(" "),n("div",{staticClass:"bottom-btn"},[n("button",{staticClass:"btn btn-default",on:{click:e.handleCancel}},[e._v("\n      取消\n    ")]),e._v(" "),n("button",{staticClass:"btn btn-primary",attrs:{disabled:!e.pwdValidity},on:{click:e.handleSubmit}},[e._v("\n      保存\n    ")])])],2)},[],!1,null,"796ff232",null).exports},data:function(){return{editStatus:!1}},computed:{hasPassword:function(){return this.$auth.user.is_set_password}}}),z=(n(2330),Object(d.a)(B,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-password"},[n("div",{staticClass:"display-password"},[n("span",[e._v("\n      密码\n    ")]),e._v(" "),e.hasPassword?[n("span",[e._v("\n        ******\n      ")]),e._v(" "),n("span",{on:{click:function(t){e.editStatus=!0}}},[e._v("\n        点击修改\n      ")])]:[n("span",[e._v("\n        无密码\n      ")]),e._v(" "),n("span",{on:{click:function(t){e.editStatus=!0}}},[e._v("\n        点击设置\n      ")])]],2),e._v(" "),n("password-editor",{directives:[{name:"show",rawName:"v-show",value:e.editStatus,expression:"editStatus"}],attrs:{"has-password":e.hasPassword},on:{close:function(t){e.editStatus=!1}}})],1)},[],!1,null,"19850dd5",null).exports),V={props:{formatEmail:{type:String,default:""}},methods:{verifyByEmail:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.get(this.$urls.changeEmail,{verify_type:"email"});case 2:e.sent.ok&&this.$emit("showEmailResult",this.formatEmail);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},D=(n(2331),Object(d.a)(V,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"use-email-body"},[n("div",{staticClass:"email-address"},[e._v("\n    我们将发送验证邮件到\n    "),n("span",[e._v("\n      "+e._s(e.formatEmail)+"\n    ")]),e._v("\n    以验证您的身份\n  ")]),e._v(" "),n("div",{staticClass:"send-email"},[n("button",{staticClass:"btn btn-primary",on:{click:e.verifyByEmail}},[e._v("\n      发送验证邮件\n    ")])]),e._v(" "),e._t("use-email-next")],2)},[],!1,null,"431311fc",null).exports),J={props:{userPhone:{type:String,default:""}},data:function(){return{code:"",status:!1,message:"",isSended:!1}},computed:{formatPhone:function(){var e=this.userPhone.split("");return e.splice(3,4,"****"),e.join("")},codeValidity:function(){return/^\d\d{4}\d$/.test(this.code)}},methods:{sendCode:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.get(this.$urls.changeEmail,{verify_type:"phone"});case 2:(t=e.sent).ok?(this.status=!0,this.message="验证码已发送",this.isSended=!0,this.countDown()):(this.status=!1,t.response.data&&t.response.data.message?this.message=t.response.data.message:this.message="验证码发送失败，请稍后重试");case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),countDown:function(){var e=this,t=61,n=this.$refs.btnCountDown,r=function(){if(1===t)return n.textContent="获取验证码",window.clearInterval(o),void(e.isSended=!1);t-=1,n.textContent="".concat(t,"s后获取")},o=setInterval(r,1e3);r()},verifyCode:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.codeValidity){e.next=4;break}return this.status=!1,this.message="验证码为6位数字",e.abrupt("return");case 4:return e.next=6,this.$ajax.post(this.$urls.verifyCode("change_email"),{phone_number:this.userPhone,code:this.code});case 6:(t=e.sent).ok?(this.message="",this.$slots.usePhoneNext[0].context.showNewEmailBody()):(this.status=!1,this.message=t.message||"验证码错误");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},L=(n(2332),Object(d.a)(J,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"use-phone-body"},[n("div",{staticClass:"phone-num"},[e._v("\n    验证码将发送至\n    "),n("span",[e._v("\n      "+e._s(e.userPhone&&e.formatPhone)+"\n    ")])]),e._v(" "),n("div",{staticClass:"input-container"},[n("b-form-input",{attrs:{type:"text",placeholder:"请输入验证码"},model:{value:e.code,callback:function(t){e.code="string"==typeof t?t.trim():t},expression:"code"}}),e._v(" "),n("button",{ref:"btnCountDown",staticClass:"btn btn-primary btn-get-code",attrs:{disabled:e.isSended},on:{click:e.sendCode}},[e._v("\n      获取验证码\n    ")])],1),e._v(" "),n("small",{class:[e.status?"color-primary":"color-red"]},[e._v("\n    "+e._s(e.message?e.message:" ")+"\n  ")]),e._v(" "),e._t("usePhoneNext")],2)},[],!1,null,"4fb62828",null).exports),F={props:{emailValidated:{type:Boolean,default:!0}},data:function(){return{email:"",status:!1,message:""}},methods:{sendToNewEmail:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="phone",this.emailValidated||(t="email"),e.next=4,this.$ajax.post(this.$urls.changeEmail,{verify_type:t,email:this.email});case 4:(n=e.sent).ok?this.$emit("verifyNewEmail",this.email):(this.status=!1,this.message=n.message);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},G=(n(2333),Object(d.a)(F,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"new-email-box-body"},[n("div",{staticClass:"input-container"},[n("span",[e._v("新邮箱")]),e._v(" "),n("b-form-input",{attrs:{type:"text",placeholder:"请输入新邮箱地址"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),e._v(" "),n("small",{class:[e.status?"color-primary":"color-red"]},[e._v("\n    "+e._s(e.message?e.message:" ")+"\n  ")]),e._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:e.sendToNewEmail}},[e._v("\n    发送激活邮件\n  ")])])},[],!1,null,"520d82ed",null).exports),Z={props:{email:{type:String,default:""}}},H=(n(2334),{components:{useEmail:D,usePhone:L,newEmailBox:G,emailResult:Object(d.a)(Z,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"email-result-body"},[n("div",{staticClass:"result-msg"},[e._v("\n    已发送验证邮件到\n    "),n("span",[e._v("\n      "+e._s(e.email)+"\n    ")]),e._v("\n    ，24小时内有效，请尽快登录您的邮箱点击验证链接完成验证\n  ")]),e._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:function(t){return e.$emit("closeModal")}}},[e._v("\n    我知道了\n  ")])])},[],!1,null,"78150f59",null).exports},props:{formatEmail:{type:String,default:""},userPhone:{type:String,default:""},emailValidated:{type:Boolean,default:!0}},data:function(){return{phoneCodeAppeal:!1,newEmailAppeal:!1,emailResultAppeal:!1,newEmail:"",showModal:!1}},mounted:function(){this.emailValidated||(this.phoneCodeAppeal=!0,this.newEmailAppeal=!0)},methods:{_verifyCode:function(){this.$refs.usePhone.verifyCode()},showPhoneCodeBody:function(){this.phoneCodeAppeal=!0},hideUsePhone:function(){this.emailResultAppeal?this.emailResultAppeal=!1:this.newEmailAppeal?this.newEmailAppeal=!1:this.phoneCodeAppeal=!1},showNewEmailBody:function(){this.newEmailAppeal=!0},showEmailResult:function(e){this.phoneCodeAppeal=!0,this.newEmailAppeal=!0,this.emailResultAppeal=!0,this.newEmail=e},closeModal:function(){this.showModal=!1}}}),W=(n(2335),n(2336),{components:{updateEmailModal:Object(d.a)(H,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"updateEmail",title:"修改邮箱",size:"sm","hide-footer":"","modal-class":"user-update-email-modal","no-close-on-backdrop":!0},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("div",{staticClass:"modal-title-slot",attrs:{slot:"modal-title"},slot:"modal-title"},[n("span",[e._v("修改邮箱")])]),e._v(" "),n("use-email",{class:{"show-use-phone":e.phoneCodeAppeal},attrs:{"format-email":e.formatEmail},on:{showEmailResult:e.showEmailResult}},[n("template",{slot:"use-email-next"},[e.userPhone?n("div",{staticClass:"use-phone",on:{click:e.showPhoneCodeBody}},[e._v("\n          使用手机验证\n        ")]):e._e()])],2),e._v(" "),n("use-phone",{ref:"usePhone",class:{"show-new-email-box":e.newEmailAppeal,"show-use-phone":e.phoneCodeAppeal},attrs:{"user-phone":e.userPhone}},[n("template",{slot:"usePhoneNext"},[n("div",{staticClass:"next"},[n("button",{staticClass:"btn btn-primary",on:{click:e._verifyCode}},[e._v("\n            下一步\n          ")])])])],2),e._v(" "),n("new-email-box",{class:{"show-new-email-box":e.newEmailAppeal,"show-use-phone":e.phoneCodeAppeal,"show-email-result":e.emailResultAppeal},attrs:{"email-validated":e.emailValidated},on:{verifyNewEmail:e.showEmailResult}}),e._v(" "),n("email-result",{class:{"show-new-email-box":e.newEmailAppeal,"show-use-phone":e.phoneCodeAppeal,"show-email-result":e.emailResultAppeal},attrs:{email:e.newEmail},on:{closeModal:e.closeModal}})],1)],1)},[],!1,null,null,null).exports},props:{userEmail:{type:String,default:""},userPhone:{type:String,default:""},emailValidated:{type:Boolean,default:!0}},computed:{formatEmail:function(){var e=(this.userEmail||"").split("");return e.splice(3,4,"****"),e.join("")}}}),K=(n(2337),Object(d.a)(W,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-email"},[n("span",[e._v("\n    邮箱\n  ")]),e._v(" "),n("span",[e._v("\n    "+e._s(e.userEmail?e.formatEmail:"******")+"\n  ")]),e._v(" "),n("span",{directives:[{name:"b-modal",rawName:"v-b-modal.updateEmail",modifiers:{updateEmail:!0}}]},[e._v("\n    点击修改\n  ")]),e._v(" "),n("update-email-modal",{attrs:{"format-email":e.formatEmail,"user-phone":e.userPhone,"email-validated":e.emailValidated}})],1)},[],!1,null,"21d814b2",null).exports),Q={computed:Object(r.a)({},Object(c.d)("user",{oauthStatus:function(e){return e.oauthStatus}})),methods:Object(r.a)({},Object(c.b)("user",["unbindUserOauth"]),{redirectToBind:function(e){this.$router.push({path:"/services/oauth",query:{action:"bind",type:e,next:"/user/profile/#auth"}})}})},X=(n(2338),{components:{userPhone:T,userPassword:z,userEmail:K,userBind:Object(d.a)(Q,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-bind"},[n("span",[e._v("\n    账号绑定\n  ")]),e._v(" "),n("ul",{staticClass:"user-bind-list"},[n("li",[n("i",{staticClass:"fa fa-weixin fa-2x",staticStyle:{color:"#5cb85c"}}),e._v(" "),e.oauthStatus.bind_wechat?n("span",{staticClass:"cancel-bind",on:{click:function(t){return e.unbindUserOauth({oauthType:"wechat"})}}},[e._v("\n        解除绑定\n      ")]):n("span",{on:{click:function(t){return e.redirectToBind("wechat")}}},[e._v("\n        点击绑定\n      ")])]),e._v(" "),n("li",[n("i",{staticClass:"fa fa-qq fa-2x",staticStyle:{color:"#5bc0de"}}),e._v(" "),e.oauthStatus.bind_qq?n("span",{staticClass:"cancel-bind",on:{click:function(t){return e.unbindUserOauth({oauthType:"qq"})}}},[e._v("\n        解除绑定\n      ")]):n("span",{on:{click:function(t){return e.redirectToBind("qq")}}},[e._v("\n        点击绑定\n      ")])]),e._v(" "),n("li",[n("i",{staticClass:"fa fa-weibo fa-2x",staticStyle:{color:"#d9534f"}}),e._v(" "),e.oauthStatus.bind_weibo?n("span",{staticClass:"cancel-bind",on:{click:function(t){return e.unbindUserOauth({oauthType:"weibo"})}}},[e._v("\n        解除绑定\n      ")]):n("span",{on:{click:function(t){return e.redirectToBind("weibo")}}},[e._v("\n        点击绑定\n      ")])]),e._v(" "),n("li",[n("i",{staticClass:"fa fa-github fa-2x",staticStyle:{color:"#333"}}),e._v(" "),e.oauthStatus.bind_github?n("span",{staticClass:"cancel-bind",on:{click:function(t){return e.unbindUserOauth({oauthType:"github"})}}},[e._v("\n        解除绑定\n      ")]):n("span",{on:{click:function(t){return e.redirectToBind("github")}}},[e._v("\n        点击绑定\n      ")])])])])},[],!1,null,"5068f584",null).exports},computed:Object(r.a)({},Object(c.d)("user",{editUserPassword:function(e){return e.editUserPassword},userBaseInfo:function(e){return e.userBaseInfo}}),{userInfo:function(){return this.$auth.user}})}),Y=Object(d.a)(X,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"user-security"},[t("div",{staticClass:"container-fluid"},[t("user-phone",{attrs:{"user-phone":this.userInfo.phone}}),this._v(" "),t("user-email",{attrs:{"user-email":this.userInfo.email,"user-phone":this.userInfo.phone,"email-validated":this.userInfo.is_email_validated}}),this._v(" "),t("user-password"),this._v(" "),t("user-bind")],1)])},[],!1,null,null,null).exports,ee={data:function(){return{emailSettings:{new_course:!1,activity:!1,labreport_invite:!1,question_invite:!1}}},computed:Object(r.a)({},Object(c.d)("user",{userEmailSettings:function(e){return e.userEmailSettings}})),mounted:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.emailSettings=Object(r.a)({},this.userEmailSettings);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:Object(r.a)({},Object(c.b)("user",["setUserEmails"]),{submit:function(){var e=this;this.$nextTick(function(){e.setUserEmails(e.emailSettings)})}})},te=(n(2339),Object(d.a)(ee,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"set-email container-fluid"},[n("div",{staticClass:"remind-email"},[n("h5",[e._v("提醒邮件")]),e._v(" "),n("div",{staticClass:"checkbox-container"},[n("b-form-checkbox",{attrs:{plain:""},on:{change:e.submit},model:{value:e.emailSettings.labreport_invite,callback:function(t){e.$set(e.emailSettings,"labreport_invite",t)},expression:"emailSettings.labreport_invite"}},[e._v("\n        实验报告点评邀请\n      ")]),e._v(" "),n("b-form-checkbox",{attrs:{plain:""},on:{change:e.submit},model:{value:e.emailSettings.question_invite,callback:function(t){e.$set(e.emailSettings,"question_invite",t)},expression:"emailSettings.question_invite"}},[e._v("\n        问题邀请\n      ")])],1)]),e._v(" "),n("div",{staticClass:"official-mall"},[n("h5",[e._v("官方邮件")]),e._v(" "),n("div",{staticClass:"checkbox-container"},[n("b-form-checkbox",{attrs:{plain:""},on:{change:e.submit},model:{value:e.emailSettings.new_course,callback:function(t){e.$set(e.emailSettings,"new_course",t)},expression:"emailSettings.new_course"}},[e._v("\n        新课程推荐邮件\n      ")]),e._v(" "),n("b-form-checkbox",{attrs:{plain:""},on:{change:e.submit},model:{value:e.emailSettings.activity,callback:function(t){e.$set(e.emailSettings,"activity",t)},expression:"emailSettings.activity"}},[e._v("\n        新功能/活动提醒邮件\n      ")])],1)])])},[],!1,null,"aac71b98",null).exports),ne={data:function(){return{form:{realname:"",title:"",school:"",link:"",description:""},formLabels:[{key:"realname",value:"姓名"},{key:"title",value:"机构"},{key:"school",value:"职称"},{key:"link",value:"个人主页"},{key:"description",value:"简介"}]}},computed:{teacherInfo:function(){return this.$auth.user.teacher_info}},mounted:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form=this.teacherInfo;case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:Object(r.a)({},Object(c.b)("user",["setTeacherInfo"]),{submit:function(){this.setTeacherInfo(this.form)}})},ae=(n(2340),Object(d.a)(ne,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"teacher-info"},[n("b-container",{attrs:{fluid:""}},[n("b-form-group",{attrs:{id:"realname",label:"姓名","label-for":"input-realname","label-cols":"2",horizontal:!0}},[n("b-form-input",{attrs:{id:"input-realname",trim:""},model:{value:e.form.realname,callback:function(t){e.$set(e.form,"realname",t)},expression:"form.realname"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"school",label:"机构","label-for":"input-school","label-cols":"2",horizontal:!0}},[n("b-form-input",{attrs:{id:"input-school",trim:""},model:{value:e.form.school,callback:function(t){e.$set(e.form,"school",t)},expression:"form.school"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"title",label:"职称","label-for":"input-title","label-cols":"2",horizontal:!0}},[n("b-form-input",{attrs:{id:"input-title",trim:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"link",label:"个人主页","label-for":"input-link","label-cols":"2",horizontal:!0}},[n("b-form-input",{attrs:{id:"input-link",trim:""},model:{value:e.form.link,callback:function(t){e.$set(e.form,"link",t)},expression:"form.link"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"description",label:"简介","label-for":"input-description","label-cols":"2",horizontal:!0}},[n("b-form-input",{attrs:{id:"input-description",trim:""},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"description",label:"","label-cols":"2",horizontal:!0}},[n("b-button",{attrs:{variant:"primary"},on:{click:e.submit}},[e._v("\n        保存\n      ")])],1)],1)],1)},[],!1,null,"81577f5e",null).exports),se={props:{switchTab:{type:Function,default:null}},data:function(){return{code:""}},methods:Object(r.a)({},Object(c.b)("user",["sendRedeemCode"]),{useRedeemCode:function(){this.code&&this.sendRedeemCode({code:this.code})}})},ie=(n(2341),{middleware:"auth",components:{VerityMailbox:f,baseSettings:E,securitySettings:Y,emailSttings:te,teacherSettings:ae,redeemCode:Object(d.a)(se,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"redeem-code container-fluid"},[n("b-form-input",{attrs:{type:"text",placeholder:"输入兑换码"},model:{value:e.code,callback:function(t){e.code="string"==typeof t?t.trim():t},expression:"code"}}),e._v(" "),n("button",{staticClass:"btn btn-primary",attrs:{disabled:!e.$auth.user.phone||!e.code},on:{click:e.useRedeemCode}},[e._v("\n    立即兑换\n  ")]),e._v(" "),e.$auth.user.phone?e._e():n("small",{staticClass:"block tip"},[e._v("\n    需要\n    "),n("span",{staticClass:"bind-phone color-red",on:{click:function(t){return e.switchTab({component:"securitySettings"})}}},[e._v("绑定手机号")]),e._v("\n    再进行兑换操作\n  ")])],1)},[],!1,null,"205159b6",null).exports},data:function(){return{activeTabComponent:"baseSettings"}},computed:{userInfo:function(){return this.$auth.user},isTeacher:function(){return this.userInfo.is_teacher},userTabs:function(){var e=[{key:"base",text:"基本信息",component:"baseSettings"},{key:"auth",text:"账号密码",component:"securitySettings"},{key:"emailSetting",text:"邮件通知",component:"emailSttings"},{key:"teacherInfo",text:"教师信息",component:"teacherSettings"},{key:"redeemCode",text:"兑换码",component:"redeemCode"}];return this.isTeacher||e.splice(3,1),e}},asyncData:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.store,e.next=3,Promise.all([n.dispatch("user/getUserEmails"),n.dispatch("user/getUserOauthStatus")]);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),mounted:function(){var e=this.$route.hash;if(e){var t=e.split("#")[1];if(this.userTabs.map(function(e){return e.key}).includes(t)){var n=this.userTabs.find(function(e){return e.key===t});this.activeTabComponent=n.component}}},methods:Object(r.a)({},Object(c.b)("user",["getUserBaseInfo"]),{switchTab:function(e){var component=e.component;this.activeTabComponent=component}}),head:function(){return{title:"个人设置"}}}),re=(n(2342),Object(d.a)(ie,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("single-page",{staticClass:"user-profile"},[e.userInfo.is_email_validated||"active"!==!e.userInfo.status?e._e():n("verity-mailbox"),e._v(" "),n("b-row",{staticClass:"profile-container"},[n("b-col",{attrs:{cols:"3"}},[n("common-content",{staticClass:"content-tabs"},[n("div",{staticClass:"profile-tabs"},e._l(e.userTabs,function(t,r){return n("span",{key:r,staticClass:"tab-title",class:{active:e.activeTabComponent===t.component},on:{click:function(n){return e.switchTab(t)}}},[e._v("\n            "+e._s(t.text)+"\n          ")])}),0)])],1),e._v(" "),n("b-col",{attrs:{cols:"9"}},[n("common-content",[n("keep-alive",[n(e.activeTabComponent,{tag:"component",attrs:{"switch-tab":e.switchTab}})],1)],1)],1)],1)],1)},[],!1,null,"c41a0b34",null));t.default=re.exports}}]);