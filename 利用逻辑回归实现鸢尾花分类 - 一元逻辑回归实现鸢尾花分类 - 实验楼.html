<!DOCTYPE html>
<!-- saved from url=(0048)https://www.shiyanlou.com/courses/1058/learning/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="vjs-styles-defaults">
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid {
        padding-top: 56.25%
      }
    </style>
    <title data-n-head="true">利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼</title><meta data-n-head="true" name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta data-n-head="true" data-hid="keywords" name="keywords" content="实验楼,IT培训,IT教育,编程,在线编程,Linux,Linux教程,Linux操作系统,
        Python,Python教程,Python基础教程,Java,Java编程,C语言,大数据,Node.js,
        Hadoop,PHP,Docker,Git,R,SQL,MongoDB,Redis,Swift,Spark,在线实验,
        IT在线教育,编程入门,项目训练,项目实践,webIDE,软件开发"><meta data-n-head="true" data-hid="description" name="description" content="实验楼是国内领先的IT在线编程及在线实训学习平台，专业导师提供精选的实践项目，
        创新的技术使得学习者无需配置繁琐的本地环境，随时在线流畅使用。以就业为导向，
        提供编程、运维、测试、云计算、大数据、数据库等全面的IT技术动手实践环境，
        提供Linux、Python、Java、C语言、Node.js、Hadoop、PHP、Docker、Git、
        R、SQL、MongoDB、Redis、Swift、Spark等千门热门课程。"><link data-n-head="true" rel="icon" type="image/x-icon" href="https://www.shiyanlou.com/favicon.ico"><link data-n-head="true" rel="stylesheet" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/font-awesome.min.css"><link rel="preload" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/f3a337105fb6129b39d1.js.下载" as="script"><link rel="preload" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/cc58aae2d5b624e45e75.js.下载" as="script"><link rel="preload" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/34e4120db4a53410cbcd.js.下载" as="script"><link rel="preload" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/e37290ea5e6d3a26020d.css" as="style"><link rel="preload" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/0eed17603f033879ebbc.js.下载" as="script"><link rel="preload" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/4f1eb9016cbba5f02532.css" as="style"><link rel="preload" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/13652036f3502b0c6db7.js.下载" as="script"><link rel="stylesheet" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/e37290ea5e6d3a26020d.css"><link rel="stylesheet" href="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/4f1eb9016cbba5f02532.css">
  <script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/121.js.下载" id="AWSC_uabModule"></script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/um.js.下载" id="AWSC_umidPCModule"></script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/nvc.js.下载"></script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/nvcPrepare.jsonp"></script><script charset="utf-8" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/57e24fa8044cda0ae313.js.下载"></script><script charset="utf-8" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/6920e455a4bd0bff748c.js.下载"></script><script charset="utf-8" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/fa53ae7bdb5589798911.js.下载"></script><script charset="utf-8" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/78f12ae12e7792b2e80b.js.下载"></script><script async="" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/analytics.js.下载" charset="utf-8"></script></head>
  <body class="" data-modal-open-count="0">
    <div id="__nuxt"><div id="__layout"><div data-v-57a4eb3b=""><!---->  <div class="body" data-v-57a4eb3b=""><!----> <div class="lab-operation" data-v-d68b6290="" data-v-57a4eb3b=""><div data-v-00d8b544="" data-v-d68b6290="" class="section-box-root"><div data-v-4c89ebd0="" data-v-00d8b544="" class="wx-service-modal-root"><!----></div> <div data-v-48901454="" data-v-00d8b544="" class="left-box" style="width: 896px;"><div data-v-48901454="" class="top-bar"><div data-v-00d8b544="" data-v-48901454="" class="top-bar"><a data-v-00d8b544="" data-v-48901454="" href="https://www.shiyanlou.com/courses/1058" class="home-btn"><img data-v-00d8b544="" data-v-48901454="" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/9f0571e.png"></a> <span data-v-00d8b544="" data-v-48901454="" class="course-name">
        一元逻辑回归实现鸢尾花分类
      </span> <div data-v-00d8b544="" data-v-48901454="" class="sections-list-btn"><img data-v-00d8b544="" data-v-48901454="" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/01a1ffb.svg">
        章节列表
      </div></div></div> <div data-v-48901454="" class="box-container relative"><div data-v-48901454="" class="left-bar"><div data-v-00d8b544="" data-v-48901454="" class="left-bar"><div data-v-00d8b544="" data-v-48901454="" class="menu-tabs"><div data-v-00d8b544="" data-v-48901454="" class="item font-16 active">
          步骤
        </div><div data-v-00d8b544="" data-v-48901454="" class="item font-16">
          报告
        </div><div data-v-00d8b544="" data-v-48901454="" class="item font-16">
          讨论
        </div></div> <div data-v-00d8b544="" data-v-48901454="" class="menu-btns"><!----> <div data-v-00d8b544="" data-v-48901454="" title="" class="item" data-original-title="新手指南"><img data-v-00d8b544="" data-v-48901454="" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjQzZDNkM2IiBzdHJva2Utd2lkdGg9IjEuMyIgZD0iTTEwIDE3LjgzOWw4LjA2NC0xLjQ5M2EuMzUuMzUgMCAwIDAgLjI4Ni0uMzQ0di0xMy4zYS4zNS4zNSAwIDAgMC0uNDE0LS4zNDRsLTcuOCAxLjQ0NGMtLjEzNi4wMTctLjEzNi4wMTctLjI3MyAwbC03LjgtMS40NDRhLjM1LjM1IDAgMCAwLS40MTMuMzQ0djEzLjNjMCAuMTY4LjEyLjMxMy4yODYuMzQ0TDEwIDE3LjgzOXoiLz4KICAgICAgICA8cGF0aCBmaWxsPSIjQzZDNkM2IiBkPSJNOS41IDEzLjVoMXYxaC0xdi0xem0xLjcxNy00LjY5NGMwLS43MDItLjQyOC0xLjE5Mi0xLjI3NS0xLjE5Mi0uNjEyIDAtMS4xNTkuMjkxLTEuNjc4Ljg2NUw3LjUgNy43NjRDOC4xNzEgNy4wMTcgOC45OTQgNi41IDEwLjA5NCA2LjVjMS40MzUgMCAyLjQwNi44MDggMi40MDYgMi4xOTggMCAxLjc3OC0yLjI5IDIuMDgxLTIuMDUgMy44MDJIOS4yN2MtLjMxMS0xLjkyOCAxLjk0Ny0yLjQxNyAxLjk0Ny0zLjY5NHoiLz4KICAgIDwvZz4KPC9zdmc+Cg=="></div> <div data-v-00d8b544="" data-v-48901454="" title="服务号" class="item"><img data-v-00d8b544="" data-v-48901454="" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/76a43f5.svg"></div> <div data-v-00d8b544="" data-v-48901454="" class="item" role="button"><img data-v-00d8b544="" data-v-48901454="" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/cc491c4.svg" title="" data-original-title="纠错"></div> <div data-v-00d8b544="" data-v-48901454="" class="item"><img data-v-00d8b544="" data-v-48901454="" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjQzZDNkM2Ij4KICAgICAgICA8cGF0aCBmaWxsPSIjQzZDNkM2IiBzdHJva2Utd2lkdGg9Ii43IiBkPSJNMTMuOTIyIDQuMjN2Ni4xNDhhLjU1LjU1IDAgMCAxLS41NS41NUg4LjcwNHY1LjQ3OGEuNTUuNTUgMCAwIDEtLjU1LjU1SDMuNWEuMTUuMTUgMCAwIDAtLjE1LjE1di40MzRjMCAuMDgzLjA2Ny4xNS4xNS4xNWg1LjgwMnYtNS40NzhhLjU1LjU1IDAgMCAxIC41NS0uNTVoNC42NjdWNS41MTRhLjU1LjU1IDAgMCAxIC41NS0uNTVIMTkuNWEuMTUuMTUgMCAwIDAgLjE1LS4xNVY0LjM4YS4xNS4xNSAwIDAgMC0uMTUtLjE1aC01LjU3OHoiLz4KICAgICAgICA8cGF0aCBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjEuMiIgZD0iTTYuMzUgNS4xM0w0Ljc0OCA0LjA0NGMtLjE2Ni0uMTQ4LS4xNjYtLjE0OC0uMjQxLS4zMjZhLjYxMy42MTMgMCAwIDEgLjMzMy0uNzQ1bC4xMDktLjAzNiA0LjYzNS0xLjA5MmEuNzIuNzIgMCAwIDEgLjkyNi42MjRsLjU1MyA0LjYwMWMuMDAyLjE1Ny4wMDIuMTU3LS4wNS4zMTFhLjYxLjYxIDAgMCAxLS44ODguMjY4bC0xLjM5Mi0uODljLS41MDkuODgtMS41OTUgMi4yMjgtMi42MzIgMy4wNi0xLjM5IDEuMTE3LTIuODk4IDEuODc1LTQuNTIyIDIuMjdsLS4zOS0xLjEyOWMxLjc5OS0uODE2IDMuMDUzLTEuNzI0IDMuNzctMi43MDdBOC4xMDYgOC4xMDYgMCAwIDAgNi4zNSA1LjEyOXoiLz4KICAgIDwvZz4KPC9zdmc+Cg=="> <!----></div></div></div></div> <div data-v-48901454="" class="box-content relative full-width"><div data-v-659422e8="" data-v-00d8b544="" class="lab-document" data-v-48901454=""><!----> <div data-v-198dce4b="" data-v-659422e8="" class="single-document" width="896"><div data-v-198dce4b="" class="content"><!----> <div data-v-198dce4b=""><div data-v-198dce4b="" role="alert" aria-live="polite" aria-atomic="true" class="alert rules alert-info"><!----><p data-v-198dce4b="">说明：</p> <div data-v-198dce4b="">
            1. 本章节实验步骤已融合在右侧环境，请开启环境后直接在右侧环境的 空白单元格 处输入代码做实验
          </div> <div data-v-198dce4b="">
            2. 若想仅查看实验步骤，请点击下方展开实验步骤
          </div></div> <div data-v-198dce4b="" class="toggle-doc">
          点击收起步骤
          <i data-v-198dce4b="" class="fa fa-angle-up"></i></div> <div data-v-198dce4b="" class="markdown-body" style=""><h1 id="一元逻辑回归实现鸢尾花分类">一元逻辑回归实现鸢尾花分类</h1>
<hr>
<h3 id="实验内容">实验内容</h3>
<p>本实验讲解了逻辑回归模型的概念，以及由线性回归扩展为逻辑回归的逆连结函数概念，并利用逻辑回归对鸢尾花进行分类。</p>
<h3 id="课程来源">课程来源</h3>
<p>本课程源自 <a href="http://www.epubit.com.cn/" target="_blank">异步社区</a> 的 <a href="https://www.epubit.com/book/detail/17444" target="_blank">《Python贝叶斯分析》</a> 书籍第 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex"> 5 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">5</span></span></span></span></span> 章，感谢 <a href="http://www.epubit.com.cn/" target="_blank">异步社区</a> 授权实验楼发布。如需系统的学习本书，请购买<a href="https://item.jd.com/12283479.html" target="_blank">《Python贝叶斯分析》</a>。</p>
<p>为了保证可以在实验楼环境中完成本次实验，我们在原书内容基础上补充了一系列的实验指导，比如实验截图，代码注释，帮助您更好得实战。</p>
<p>如果您对于实验有疑惑或者建议可以随时在讨论区中提问，与同学们一起探讨。</p>
<h3 id="实验知识点">实验知识点</h3>
<ul>
<li>逻辑回归以及逆连结函数</li>
<li>利用pymc3做线性回归</li>
<li>利用逻辑回归分类</li>
</ul>
<hr>
<h3 id="实验原理">实验原理</h3>
<h3 id="逻辑回归">逻辑回归</h3>
<p>我母亲有一道拿手好菜叫 sopa seca ，其做法源于意大利面，直译过来叫做干汤面，这个名字听起来似乎有点矛盾，不过一旦了解它的做法之后，你会觉得这个叫法其实挺合理的。同样，逻辑回归也是如此，它主要用来解决分类问题。</p>
<p>逻辑回归模型是线性回归模型的一种扩展，这也是其名称来源。在理解如何将一个回归模型应用于分类问题之前，先将线性模型的核心部分改写成如下形式：</p>
<p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu=f(\alpha+\beta X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.05278em;">β</span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span></span></span></p>
<p> 其中，f 称作逆连结函数。为什么这里把f称作逆连结函数而不是连结函数？原因是传统上人们认为此类函数是用来连结输出变量和线性模型的，不过在构建贝叶斯模型的时候你将看到，反过来思考可能更容易一些。</p>
<p>因此，为了避免疑惑，我们这里统称逆连结函数。前一章中的所有线性模型其实都包含一个逆连结函数，不过我们书写的时候将其省略了，因为它其实是一个恒等函数（函数的返回值和输入值相同）。</p>
<p>恒等函数在这里也许没什么用，不过它可以让我们用一种更一般的形式思考不同的模型。从原理上讲，许多其他函数都可以充当逆连结函数，不过这一章只讨论逻辑函数，其数学形式如下：</p>
<p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>c</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">logistic(z)=\frac{1}{1+exp(-z)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.25744em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>从分类的角度来看，逻辑函数最重要的特点之一是不论参数z的值为多少，其输出值总是介于0到1之间。因此，该函数将整个实轴压缩到了区间[0,1]内。逻辑函数也称作S型函数（<code>sigmoid function</code>），可以运行以下几行代码来看一下。</p>
<p><strong>☞ 示例代码：</strong></p>
<pre><code class="hljs python">%matplotlib inline
<span class="hljs-keyword">import</span> matplotlib.pyplot as plt
<span class="hljs-keyword">import</span> numpy as np
z = np.linspace(<span class="hljs-number">-10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>)
logistic = <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-z))
plt.plot(z, logistic)
plt.xlabel(<span class="hljs-string">'$z$'</span>, fontsize=<span class="hljs-number">18</span>)
plt.ylabel(<span class="hljs-string">'$logistic(z)$'</span>, fontsize=<span class="hljs-number">18</span>)
</code></pre><p><strong>☞ 动手练习：</strong></p>
<pre><code class="hljs python">
</code></pre><h3 id="逻辑回归模型">逻辑回归模型</h3>
<p>现在我们知道逻辑函数长什么样了，接下来将继续学习如何用来对结果进行分类。先从简单的问题开始，假设类别只有两类，比如正常邮件/垃圾邮件、安全/不安全、阴天/晴天、健康/生病等。首先对类别进行编码，假设变量 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 只能有两个值，<span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>或<span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>，也就是说 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>∈</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y\in (0,1) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> 。</p>
<p>这样描述之后，问题就有点像抛硬币问题了，在那个例子中我们用到了伯努利分布作为似然。这里的区别是：现在 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span></span></span></span></span> 不再是从一个 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span></span></span></span></span> 分布中生成的，而是由一个线性模型定义的。一个线性模型可以返回实轴上的任意值，但是伯努利分布的值限定在 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> 区间内。</p>
<p>因此我们使用了一个逆连结函数将线性模型的返回值映射到一个适合伯努利分布的区间内，从而将一个线性回归模型转换成了分类模型：</p>
<p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Θ</mi><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>c</mi><mo stretchy="false">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta=logistic(\alpha+\beta X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Θ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.05278em;">β</span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span></span></span> <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>∼</mo><mi>B</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y\sim Bern(\Theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">Θ</span><span class="mclose">)</span></span></span></span></span></span></p>
<p>下面的 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>c</mi><mi>h</mi><mi>k</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Kruschke</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span></span></span></span></span> 图显示了逻辑回归模型（应该）包含的先验。注意与单参数线性回归模型的区别是：这里用到了伯努利分布而不是高斯分布（或者 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span></span></span></span></span> 分布），并使用了逻辑函数生成区间 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> 范围内的参数 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">θ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span></span></span></span></span>，从而适于输入到伯努利分布。</p>
<img src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/document-uid245411labid7982timestamp1534905825959.png">

<h2 id="开发准备">开发准备</h2>
<h3 id="开发环境准备">开发环境准备</h3>
<p>由于实验楼 python 环境中没有 pymc3 的扩展包，需要在 python 环境中安装相应扩展包。</p>
<pre><code class="hljs python"><span class="hljs-comment"># 在 Jupyter Notebook 单元格中执行，下载并解压数据。注意不要遗漏命令前的「!」</span>
!pip <span class="hljs-keyword">install</span> pymc3
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="鸢尾花数据集">鸢尾花数据集</h3>
<p>这里我们将逻辑回归应用到鸢尾花数据集上。在构建模型之前，我们先了解下该数据集。鸢尾花数据集是一个很经典的数据集，包含有 Setosa、Versicolour和Virginica 3个种类，这 3 个类别标签就是我们想要预测的量，即因变量。</p>
<p>其中每个种类包含有 50 个数据，每个数据包含 4 种变量（或者称为特征，机器学习中通常这么称呼），这 4 种变量就是我们要分析的自变量，分别是：花瓣长度、花瓣宽度、花萼长度和花萼宽度。</p>
<p>花萼有点类似小叶，在花还是芽时包围着花，有保护作用。</p>
<p>seaborn 中包含鸢尾花数据集，我们可以用如下代码将其导入成 Pandas 里的 Dataframe 格式：</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns 
<span class="hljs-title">iris</span> = sns.load_dataset(<span class="hljs-string">"iris"</span>)
<span class="hljs-title">iris</span>.head()
</code></pre><pre><code class="hljs python">
</code></pre><p>可以用seaborn中的stripplot函数将每个种类的花萼长度画出来：</p>
<pre><code class="hljs python">sns.stripplot(<span class="hljs-attribute">x</span>=<span class="hljs-string">"species"</span>, <span class="hljs-attribute">y</span>=<span class="hljs-string">"sepal_length"</span>, <span class="hljs-attribute">data</span>=iris, <span class="hljs-attribute">jitter</span>=<span class="hljs-literal">True</span>)
</code></pre><pre><code class="hljs python">
</code></pre><p>上图中 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 轴是连续的，而 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 轴是离散的类别变量；图中的点在 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 轴上是分散开来的，这并没有什么实际意义，只是一个画图的小技巧而已，通过将 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi><mi>i</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">jitter</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span></span></span></span></span> 参数设为 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">True</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span></span></span></span></span> ，能够避免所有点都重叠在一条直线上，你可以试着将 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi><mi>i</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">jitter</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span></span></span></span></span> 参数设为 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">False</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span></span></span></span></span>。</p>
<p>这里唯一重要的是 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 轴的含义，即分别代表 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>e</mi><mi>t</mi><mi>o</mi><mi>s</mi><mi>a</mi><mi mathvariant="normal">、</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>i</mi><mi>c</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>u</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">setosa、versicolour</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord cjk_fallback">、</span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span></span></span></span></span> 和 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>i</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>c</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">virginica</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span></span></span></span></span> 3 个类别。你还可以用 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>e</mi><mi>a</mi><mi>b</mi><mi>o</mi><mi>r</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">seaborn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">n</span></span></span></span></span> 中的其他作图函数来画这些点（比如 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>i</mi><mi>o</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>l</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">violin plot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span></span></span></span></span>），只需要一行代码就能完成。</p>
<p>另外一种观察数据的方法是用 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>a</mi><mi>i</mi><mi>r</mi><mi>p</mi><mi>l</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">pairplot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span></span></span></span></span> 画出散点图矩阵，用该函数可以得到一个 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">4×4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">4</span></span></span></span></span> 的网格（因为我们有 4 种特征）。网格是对称的，上三角和下三角表示的是同样的信息。由于对角线上的散点图其实是变量本身，因此这里用一个特征的 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mi>D</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">KDE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span></span></span></span></span> 图代替了散点图。可以看到，每个子图中，分别用 3 种颜色表示 3 种不同的类别标签，这一点与前面图中的表示一致。</p>
<pre><code class="hljs python">sns.pairplot(iris, <span class="hljs-attribute">hue</span>=<span class="hljs-string">'species'</span>, <span class="hljs-attribute">diag_kind</span>=<span class="hljs-string">'kde'</span>)
</code></pre><pre><code class="hljs python">
</code></pre><p>深入学习之前，花点时间分析下前面这幅图，进一步熟悉这个数据集并了解变量与标签之间的关系。</p>
<h3 id="实验步骤">实验步骤</h3>
<h3 id="代码包的导入">代码包的导入</h3>
<p>其中如 <code>seaborn</code>, <code>matplotlib</code>, <code>numpy</code> 等库已在前面实验准备时导入，再次就对后续所需用的库导入。为保证实验的成功，请从原理部分开始学习，接下来实验的运行需要之前数据。</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> pymc3 <span class="hljs-keyword">as</span> pm
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> scipy.stats <span class="hljs-keyword">as</span> stats
<span class="hljs-keyword">import</span> theano.tensor <span class="hljs-keyword">as</span> tt
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="给训练数据做标签">给训练数据做标签</h3>
<p>我们先从一个简单的问题开始：用花萼长度这一特征（自变量）来区分 <code>setosa</code> 和 <code>versicolor</code> 这两个种类。和前面一样，这里用 0 和 1 对类别变量进行编码，利用 Pandas 可以这么做：</p>
<pre><code class="hljs python"><span class="hljs-attr">df</span> = iris.query(<span class="hljs-string">"species == ('setosa', 'versicolor')"</span>)
<span class="hljs-attr">y_0</span> = pd.Categorical(df[<span class="hljs-string">'species'</span>]).codes
<span class="hljs-attr">x_n</span> = <span class="hljs-string">'sepal_length'</span>
<span class="hljs-attr">x_0</span> = df[x_n].values
</code></pre><pre><code class="hljs python">
</code></pre><h3 id="利用pymc3建模">利用pymc3建模</h3>
<p>现在数据已经表示成了合适的格式，终于可以用PyMC3来建模了。</p>
<p>留意下面代码中的第一部分与线性回归模型的相似之处。此外还留意两个确定变量：<code>theta</code> 和 <code>bd</code>。theta 是对变量 <code>mu</code> 应用逻辑函数之后的值，bd 是一个有边界的值，用于确定分类结果，稍后会详细讨论。</p>
<p>还有一点值得提的是除了像下面这样明确写出逻辑函数的完整形式之外，还可以简单地使用 PyMC3 中的 <code>pm.math.sigmoid</code> 函数，该函数是 Theano 中 sigmoid函数的一个别名。</p>
<p>对于其他线性模型而言，将数据进行中心化和（或）标准化处理会有利于采样。不过，在这个例子中，我们暂且不对数据做进一步处理。</p>
<pre><code class="hljs python"><span class="hljs-keyword">with</span> pm.<span class="hljs-constructor">Model()</span> <span class="hljs-keyword">as</span> model_0:
    alpha = pm.<span class="hljs-constructor">Normal('<span class="hljs-params">alpha</span>', <span class="hljs-params">mu</span>=0, <span class="hljs-params">sd</span>=10)</span>
    beta = pm.<span class="hljs-constructor">Normal('<span class="hljs-params">beta</span>', <span class="hljs-params">mu</span>=0, <span class="hljs-params">sd</span>=10)</span>

    mu = alpha + pm.math.dot(x_0, beta)
    theta = pm.<span class="hljs-constructor">Deterministic('<span class="hljs-params">theta</span>', 1 <span class="hljs-operator">/</span> (1 + <span class="hljs-params">pm</span>.<span class="hljs-params">math</span>.<span class="hljs-params">exp</span>(-<span class="hljs-params">mu</span>)</span>))
    bd = pm.<span class="hljs-constructor">Deterministic('<span class="hljs-params">bd</span>', -<span class="hljs-params">alpha</span><span class="hljs-operator">/</span><span class="hljs-params">beta</span>)</span>

    yl = pm.<span class="hljs-constructor">Bernoulli('<span class="hljs-params">yl</span>', <span class="hljs-params">theta</span>, <span class="hljs-params">observed</span>=<span class="hljs-params">y_0</span>)</span>
    start = pm.find<span class="hljs-constructor">_MAP()</span>
    step = pm.<span class="hljs-constructor">NUTS()</span>
    trace_0 = pm.sampling.sample(<span class="hljs-number">100</span>, step, start) # 本地运行时，推荐将迭代次数设置为大于 <span class="hljs-number">1000</span> 次
varnames = <span class="hljs-literal">['<span class="hljs-identifier">alpha</span>', '<span class="hljs-identifier">beta</span>', '<span class="hljs-identifier">bd</span>']</span>
pm.traceplot(trace_0, varnames)
</code></pre><p><font>注意：</font><code>pm.sampling.sample()</code> 函数里面的默认迭代次数是 <code>500</code> 次，当设置参数为 <code>100</code> 时，迭代次数为 <code>500+100</code>，也就是 <code>600</code> 次。由于在线环境性能限制，我们降低了迭代次数以缩短运行时间。如果你在本地运行，推荐设置迭代次数 <code>&gt; 1000</code> 次。</p>
<pre><code class="hljs python">
</code></pre><p>和往常一样，我们将后验的总结打印出来，然后将 bd 与通过另外一种方式得到的值进行比较</p>
<pre><code class="hljs python"><span class="hljs-selector-tag">pm</span><span class="hljs-selector-class">.summary</span>(<span class="hljs-selector-tag">trace_0</span>, <span class="hljs-selector-tag">varnames</span>)
</code></pre><pre><code class="hljs python">
</code></pre><p>现在，我们将数据及拟合的 <code>sigmoid</code>（S-型）曲线画出来。</p>
<pre><code class="hljs python">theta = trace_0[<span class="hljs-string">'theta'</span>].mean(axis=<span class="hljs-number">0</span>)
idx = np.argsort(x_0)
plt.plot(x_0[idx], theta[idx], color=<span class="hljs-string">'b'</span>, lw=<span class="hljs-number">3</span>);
plt.axvline(trace_0[<span class="hljs-string">'bd'</span>].mean(), ymax=<span class="hljs-number">1</span>, color=<span class="hljs-string">'r'</span>)
bd_hpd = pm.hpd(trace_0[<span class="hljs-string">'bd'</span>])
plt.fill_betweenx([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], bd_hpd[<span class="hljs-number">0</span>], bd_hpd[<span class="hljs-number">1</span>], color=<span class="hljs-string">'r'</span>, alpha=<span class="hljs-number">0.5</span>)


plt.plot(x_0, y_0, <span class="hljs-string">'o'</span>, color=<span class="hljs-string">'k'</span>)
theta_hpd = pm.hpd(trace_0[<span class="hljs-string">'theta'</span>])[idx]
plt.fill_between(x_0[idx], theta_hpd[:,<span class="hljs-number">0</span>], theta_hpd[:,<span class="hljs-number">1</span>], color=<span class="hljs-string">'b'</span>, alpha=<span class="hljs-number">0.5</span>)


plt.xlabel(x_n, fontsize=<span class="hljs-number">16</span>)
plt.ylabel(r<span class="hljs-string">'$\theta$'</span>, rotation=<span class="hljs-number">0</span>, fontsize=<span class="hljs-number">16</span>)
</code></pre><pre><code class="hljs python">
</code></pre><p>前面这张图表示了花萼长度与花的种类（setosa = 0, versicolor =1）之间的关系。蓝色的 S 型曲线表示 theta 的均值，这条线可以解释为：在知道花萼长度的情况下花的种类是 versicolor 的概率。</p>
<p>即：半透明的蓝色区间是 95%HPD 区间。注意：在这种情况下，逻辑回归其实就是回归，因为我们做的就是在给定特征（或者特征的线性组合）的条件下，回归出一个数据点的类别为 1 的概率。</p>
<p>不过需要时刻注意观察到的变量是二值变量而推断的是连续的概率，因此我们需要引入一个规则将连续的概率转换成一个 0-1 结果。决策边界在图中用红色来表示，此外还有一个 95%HPD 区间。</p>
<p>根据决策边界，x 值位于其左侧的（这里对应花萼长度）属于类别0（setosa），而位于其右侧的属于类别1（versicolor）。</p>
<p>决策边界在 x 轴上的取值为对应 y=0.5 时的点，可以证明其结果是 ，推导过程如下。</p>
<p>根据模型的定义，我们有如下关系：</p>
<h3 id="做预测">做预测</h3>
<p>一旦有了 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">α</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span></span></span></span></span> 和 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">β</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05278em;">β</span></span></span></span></span> 之后，我们就能用其对新的数据进行分类。可以创建一个非常基础的函数，接受花萼长度作为参数，返回分类结果为 versicolor 的概率值。具体代码如下所示：</p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">classify</span><span class="hljs-params">(n, threshold)</span>:</span>
    <span class="hljs-string">"""
    A simple classifying function
    """</span>
    n = np.array(n)
    mu = trace_0[<span class="hljs-string">'alpha'</span>].mean() + trace_0[<span class="hljs-string">'beta'</span>].mean() * n
    prob = <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-mu))
    <span class="hljs-keyword">return</span> prob, prob &gt;= threshold

classify([<span class="hljs-number">5</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">6</span>], <span class="hljs-number">0.5</span>)
</code></pre><pre><code class="hljs python">
</code></pre><p>从前面的例子可以看出，很难只根据花萼长度就将 setosa 和 versicolor 这两类花区分出来。事实上如果你仔细看过 joinplot 画的图，就可以很清楚地观察到这点。仔细观察数据可以发现，类别为 versicolor 的花的花萼长度最小值约为 4.9，而类别为 setosa 的花的花萼长度最大值约为 5.8。换句话说，两种花的花萼长度在 4.9 到 5.8 的范围内有重叠。</p>
<h3 id="实验总结">实验总结</h3>
<p>逻辑回归是机器学习中最基础的分类器，在很多高级的分类器中都会运用逻辑回归，或者逻辑回归的思想。本文介绍了如何利用逻辑回归进行机器学习的模型训练，通过对鸢尾花的分类实例的讲解，使用户更了解逻辑回归的概念，以及对 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>y</mi><mi>m</mi><mi>c</mi><mn>3</mn></mrow><annotation encoding="application/x-tex"> pymc3 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord mathdefault">m</span><span class="mord mathdefault">c</span><span class="mord">3</span></span></span></span></span> 扩展包的应用。</p>
<h2 id="扩展阅读">扩展阅读</h2>
<p>本课程源自 <a href="http://www.epubit.com.cn/" target="_blank">异步社区</a> 的 <a href="https://item.jd.com/12283479.html" target="_blank">《Python贝叶斯分析》</a> 第 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex"> 5 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">5</span></span></span></span></span> 章，再次感谢 <a href="http://www.epubit.com.cn/" target="_blank">异步社区</a> 授权实验楼发布。</p>
<p>如果学完本课程，对书籍其他内容感兴趣欢迎点击以下链接购买书籍：</p>
<ul>
<li>立即购买<a href="https://item.jd.com/11242112.html" target="_blank">《机器学习实战》</a></li>
</ul>
<div style="color:#999; font-size:12px;">©️ 本课程内容，由作者授权实验楼发布，未经允许，禁止转载、下载及非法传播。</div><h2></h2></div></div> <div data-v-198dce4b="" class="copyright">
        *本课程内容由作者授权实验楼发布，未经允许，禁止转载、下载及非法传播
      </div></div> <div data-v-5a6f02b8="" data-v-198dce4b="" class="toolbar"><!----> <div data-v-5a6f02b8="" class="toolbar-btns"><button data-v-5a6f02b8="" type="button" class="btn toolbar-btn btn-primary">
        完成学习
      </button></div></div> <div data-v-31af5ef6="" data-v-198dce4b=""><!----></div></div> <!----> <!----> <!----></div> <div data-v-ea7cbec0="" data-v-00d8b544="" class="lab-console-report" data-v-48901454="" style="display: none;"><!----> <ul data-v-ea7cbec0="" class="nav nav-tabs"><li data-v-ea7cbec0="" class="nav-item"><a data-v-ea7cbec0="" class="nav-link active">
        编辑
      </a></li><li data-v-ea7cbec0="" class="nav-item"><a data-v-ea7cbec0="" class="nav-link">
        预览
      </a></li></ul> <div data-v-ea7cbec0="" class="tab-content"><div data-v-ea7cbec0="" class="tab-pane active lab-report-tab"><div data-v-ea88a3ba="" data-v-ea7cbec0="" class="editor"><div data-v-94795872="" data-v-ea88a3ba="" class="markdown-editor"><div data-v-374f1a78="" data-v-94795872="" class="tools"><div data-v-374f1a78=""><i data-v-374f1a78="" class="fa fa-bold"></i> <i data-v-374f1a78="" class="fa fa-italic"></i> <i data-v-374f1a78="" class="fa fa-link"></i> <i data-v-374f1a78="" class="fa fa-quote-left"></i> <i data-v-374f1a78="" class="fa fa-code"></i> <i data-v-374f1a78="" class="fa fa-image add-image-btn"></i> <div data-v-374f1a78="" class="custom-file b-form-file upload-image" id="__BVID__48__BV_file_outer_"><input type="file" class="custom-file-input" id="__BVID__48"><label data-browse="Browse" class="custom-file-label" for="__BVID__48">No file chosen</label></div> <i data-v-374f1a78="" class="fa fa-list-ol"></i> <i data-v-374f1a78="" class="fa fa-list-ul"></i></div> <a data-v-374f1a78="" href="https://www.shiyanlou.com/questions/764/" target="_blank" class="markdown-syntax"><i data-v-374f1a78="" class="fa fa-question-circle"></i>
    格式说明
  </a></div> <textarea data-v-94795872="" placeholder="报告将自动保存，推荐使用 markdown 语法：

报告是您在本实验保存的笔记、截图及实验代码的完整记录，多记录学习更高效哦~" class="textarea form-control"></textarea> <!----></div> <div data-v-78b3a632="" data-v-ea88a3ba=""><!----> <div data-v-78b3a632="" class="custom-file b-form-file upload-image" id="__BVID__50__BV_file_outer_"><input type="file" class="custom-file-input" id="__BVID__50"><label data-browse="Browse" class="custom-file-label" for="__BVID__50">No file chosen</label></div></div></div></div> <!----></div> <button data-v-ea7cbec0="" type="button" disabled="disabled" class="btn publish-btn btn-primary disabled"><i data-v-ea7cbec0="" class="fa fa-share"></i> <span data-v-ea7cbec0="">发布</span></button></div> <div data-v-24a59a0a="" data-v-00d8b544="" class="lab-question" data-v-48901454="" style="display: none;"><div data-v-38f43bd3="" data-v-24a59a0a="" class="operate"><button data-v-38f43bd3="" class="btn btn-primary">
    发布帖子
  </button> <fieldset data-v-38f43bd3="" class="form-group form-group" id="__BVID__53"><!----><div tabindex="-1" role="group"><div data-v-38f43bd3="" class="custom-control custom-checkbox"><input type="checkbox" name="checkbox" autocomplete="off" class="custom-control-input" value="true" id="__BVID__54"><label class="custom-control-label" for="__BVID__54">
      只看我的
    </label></div><!----><!----><!----></div></fieldset> <!----> <div data-v-38f43bd3=""><!----></div></div> <div data-v-51d37e30="" data-v-24a59a0a="" class="best-question"><!----></div> <div data-v-91301d3e="" data-v-24a59a0a="" class="normal-question"><div data-v-5fd8fa79="" data-v-91301d3e="" class="question-list" question-type="normal"><div data-v-5fd8fa79="" class="list-title">
    本节帖子(2)
  </div> <ul data-v-5fd8fa79="" style="height: 1092px;"><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/106166" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          请问这跟需要学习的内容到底相关在哪里
        </p> <span data-v-5fd8fa79="" class="answer-num">1回复</span></a></li><li data-v-5fd8fa79="" class="list-item"><a data-v-5fd8fa79="" href="https://www.shiyanlou.com/questions/87749" target="_blank"><!----> <p data-v-5fd8fa79="" class="question-title is-best">
          将数据及拟合的 sigmoid（S-型）曲线画出来时，得到图像只有一个黑点
        </p> <span data-v-5fd8fa79="" class="answer-num">0回复</span></a></li> <li data-v-5fd8fa79="" class="load-msg"><span data-v-5fd8fa79="">到底了~</span></li></ul></div></div></div> <!----> <!----></div> <div data-v-23e30aba="" data-v-00d8b544="" class="course-labs-panel customize-modal text-right" data-v-48901454="" style="display: none;"><div data-v-23e30aba="" class="modal-content-wrapper modal-labs-box inline-block text-left"><div data-v-23e30aba="" class="modal-content content-box"><div data-v-23e30aba="" class="box-header progress-info no-margin"><p data-v-23e30aba="" class="progress-desc font-18">
          目前已完成 1/2 个章节的学习
        </p> <div data-v-23e30aba="" class="progress-graph flex space-between vertical-center"><div data-v-23e30aba="" class="progress-bar-outter relative"><span data-v-23e30aba="" class="progress-percentage-label font-12" style="left: 50%;">
              50%
            </span> <div data-v-23e30aba="" class="progress" style="height: 5px;"><div data-v-23e30aba="" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="50" class="progress-bar bg-primary learn-progress-bar" style="width: 50%;"><!----></div></div></div> <!----> <div data-v-23e30aba="" aria-hidden="true" class="d-none" style="display: none;"><div><span data-v-23e30aba="" class="font-12">完成全部章节即可获得完课证书</span></div></div></div> <!----></div> <div data-v-23e30aba="" class="box-body chapter-stages"><div data-v-58426d58="" data-v-23e30aba="" class="chapter-stage collapse-item"><!----> <div data-v-58426d58="" id="collapse-stage-0" class="stage-body collapse show" style=""><div data-v-5c68598e="" data-v-58426d58="" class="lab-item pointer"><div data-v-5c68598e="" class="item-top flex space-between color-primary bold"><div data-v-5c68598e="" class="top-left vertical-center"><span data-v-5c68598e="" class="inline-block lab-icon"><!----> <!----> <img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAmtJREFUSA3tlU9oE0EUxt+bdMM2kRIEq1IPWqweQgtSL2JrsiCIelJR9CIIShRDTloQFHsQ/ANCbYK2VNFj6cGjF9HdFMEIFaShPVQpCl6sCKE13SRr5jmzcUKp3dbECoIOLN/um3nfb+ftzCzA//a3VQDVCwXN/r0c4SYBdQBBg4rXrAjfEHCcMdaT3xN/JvNdSFN6oK1EpXEk+CQiI0g0X7P5jwQC1AnhiHjc5Ed/x2zk7Fv3jR1eOghAumB22dHEx3oBKi9kPrxRwNnPFV/oY7IDgUJSbeP3AdInZ5zKiZLNKV8XIjv+ZKsZ0kvEoqZZ08JYERIw75xe8yIVVjO9lU5dy2D2rnxutJI9gdHBjarPS5eF6OnkVQ7QRw5q0iA8MeIn4GeQ2POKIXVxXrRWAnlCdCt5BTi/CMx3IG+cfyNNp2dmDkttbW5+LLWlBY4KmZagYGZovYwt1TwhAPwEIL4KB7WXKpGQxwDZo4nwsZKMvWtLFBmjASDaRsVipxq3WL0/oObbD07ZmvxaHO4cGzw+ZTtbnDKPNDCMKZPgaHJfmdMwMrgwH4k/UfHF6jmTwu74B9B8UQLYMZkvHCpzbojkp3Pd8SllwjkNIcJlO5K4rWJLqfdMxGgJErPY/npnzJFL17KsB9YCl9Z1G7aq0i0I/3S7LESOlgCpvYhioYG8qu1XAHKwZ7mqTqtw40LEqflFeq3N9DetgieIEmtEEFC+7lEfMu9tLqCTFYAxcVreZxzz9cIqRz0/KfK7ddLac8a599WfVqOV2gXErwNSu1hR7g6vByQMHSDMiv10yY7Gq3usHq9/NOc77YPc8hnQeRYAAAAASUVORK5CYII=" alt="lab-classic"></span> <span data-v-5c68598e="" class="inline-block lab-index color-primary bold">
        实验 1
      </span> <span data-v-5c68598e="" title="一元逻辑回归实现鸢尾花分类" class="inline-block lab-name">
        一元逻辑回归实现鸢尾花分类
      </span></div> <div data-v-5c68598e="" class="top-right"><img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAmdJREFUSA21ls9rU0EQx2c2sWmCBVuphVh/QAsK1rZ4FlQUxR9YqtdeBHvw0GD/AvHkPT0a7EUPBYso2OJBrODNiwcFfyBoEX8heojEIr63znfztnm/+vKerQNhs5vZz8zOzs6EKUGKj6r9rPSYq/m0qA3Ip+ypf5TxrWJ9X7t899eRygdvPTJwZEUWSk9myu4ffZU0XSDSuTid1ho7xDSr8nylcXAKhgMSMVB6PHPW1e5NgXcFNNtNmOqK1UTj0NQ9v6ryT4pL1YrA72SGAyIOYS8YfubqCTzPAQ8Y9Sun+s7kyknG7UmMgWbM3Zf/5HmcVYQrr/biToy33oVmi3kc2K4hXEgSEUYqaqJ37bPF7k47siPh2S3h0mMbD4cTOge28h5RWrcCelvyBbq84wD1FzYH1u0E7LxM8EIzS7fAF0bGabRrGxVVjq69fxrHGMAl2+cfUIB353oHqYOjD9kPf9P4QTc+vQjs9U3Ka+b8pe3DdGvfKZrff4YK4qGVMPz4s3n68rthf46MMBCpH9Ca+/rabDzWs4tuDzWNxME/J8DB5s6l6gJpfRLQsOwpddOD0fPU11Gih9+XaeumThNzhAWet4HLI+BFhZIbBtv5KwGd8EJwtGdnNrhAwFao52LKsdDwaI0sr9Tp+c9v6Tw3EHbANrVIwnRdwnQxDPfPc8zkaHnzaYW5tnK4MmmyCM1CmkY9aW82OIqdMEWMAVP1pFmIETfJSKrfmuV6wna31XeA+s3E0+syInAwbC+AQ+YO/J7915YJQ7COZiE5XEvKrpZTaPpcMw0m1I+hEzlBayPRRvxt+QvzgQD15GCKOwAAAABJRU5ErkJggg==" alt="已学习"></div></div> <!----></div><div data-v-5c68598e="" data-v-58426d58="" class="lab-item pointer"><div data-v-5c68598e="" class="item-top flex space-between color-text"><div data-v-5c68598e="" class="top-left vertical-center"><span data-v-5c68598e="" class="inline-block lab-icon"><!----> <!----> <img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAipJREFUSA3tlcFrE0EUxpONNaGQpYdAEXopNHoIBjaGJEKhLRREPVkR9NKTkn+gDQiKF9H2UMhJClXosXgQSqEXqfSWbAiktOSiIAhepAjCYkOaZtPfW51QQjZtQgoFHRi+mbdvvu+9N29Yj+f/uGgV8KqAcrncNOvFRqMRBS8pew945PV6d30+XyaRSGzJeUckn8+HbdveZf9D07T3CB30QK6OBFjch2MErmgqlfriRIzAXT4EMI5j/K68e8VSqbRQqVT2//JmNSEivSHBfggIj2EYvwBL8Toi8uE8R9ci1FpjdtUYp4rQdY8LhUJEZWqa5ksa5Y3s+ZYpFotX1Dc37CgCyQsOZpkDQlAuly+TxRNq/Un2jPFarbZ9mpCrCNE+h2Sefr9Dv+8Io2VZM4LBYPCDYCgUegB8FSH8h8XWbriKEPEjpklb59RB9mnmaiQSORRbOByuktUytqtsbyi/VnS9QL/ff7tarW4T5RrleFiv10fp+wkySysS7ucW9jUCmaP9N5W9FV0zicVi3xCa5ICB0D3Ipoj4YzKZ/KxIEF1B4BkCS8rWDl0zEWcRIotr8Xi8hoAE9O4kia7rY6p0J+2t644i4iwCgtTeBmQ2x1kExNm1XE2mPiyUyE/hog31PnB6KLG8q0Gmw6vKtYHhFXVf5wG+5TJ/9yoGR4BGmeW8lFl4//xPZEE73qRbXrO8jqPzwsXe7eDuhHyPQJ/Sic031i3PP+x/DBPn3QC5lw/kAAAAAElFTkSuQmCC" alt="lab-classic"></span> <span data-v-5c68598e="" class="inline-block lab-index color-999">
        实验 2
      </span> <span data-v-5c68598e="" title="多元逻辑回归实现鸢尾花分类及性能优化" class="inline-block lab-name">
        多元逻辑回归实现鸢尾花分类及性能优化
      </span></div> <div data-v-5c68598e="" class="top-right"><img data-v-5c68598e="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAgxJREFUSA21ljtuAjEQhne9IETBAbJKR5MD5BaREhANjzRcIFIKonQoHUqKSLkATXg0CBKJW+QAaeiiXICCAnbh/53xCgQELw9L1no94+/32uPxus4/pdfrnU8mkxvXda/glkX1xf0Xz9F8Ph+m0+mPQqHwI/1rD3etBx2dTscPw/AJzSog3iYf0wfxAO2mUqpeKpUovFLWBAC/DoLgHV4Z1CkAA4gMEonEFyAaAHF/NptdwpaDLQe/JOrY87xbiHyiHZUVgVardYcBr7Aq1D6gtWKxOIq8NzS63W4WYi8w5VFDiN5XKpU34xoJyMz7NGCmj+VymYOsS7vdruHLGhyAL8mbL9ECXHMsyzdsGcAf4sLNLETkGe9crgvuCZfCkQ3lmvf3hZMjY7kKGWE6iqGIjirqlGuO50FFGFNAqmQrxjlDkdGya0NtlMmQyPPIVnjhIXIYijYAGx/DIpt7wBPqMM5tBtv4LLGyFNDH3xwiG8AunyWWr6No14C49lQqFZ0vCkTHPy5omz8290xs+hzoVMDcsm1A3P4l1khhx4cEYMeZtI5SDItsxXyOjgAvOSauQxXIIItMspVcFk2Ak5IVD9IQBtN3k2wdRQirOjrGqHkmrH0VZCzT9liYOu87zHq8LGBAjgob+4hIJmW6DuXi0dEZxStnfdILhwIsJ70y/yROfOkbET6P8duyADFNLbDfiJeBAAAAAElFTkSuQmCC" alt="未学习"></div></div> <!----></div> <br data-v-58426d58=""></div></div></div></div></div></div></div></div></div> <div data-v-d68b6290="" class="drag can-drag" style="display: none;"></div> <div data-v-d68b6290="" class="drag can-not-drag" style="left: 894px;"></div> <div data-v-531a5542="" data-v-bebca12e="" data-v-d68b6290="" class="right-box" style="width: 1664px;"><!----> <!----> <!----> <div data-v-d685947a="" data-v-bebca12e="" class="iframe-env" data-v-531a5542=""><iframe data-v-d685947a="" src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/lab.html" class="iframe"></iframe> <div data-v-d685947a="" class="copyright">
    *本课程内容由作者授权实验楼发布，未经允许，禁止转载、下载及非法传播
  </div></div> <!----> <!----></div> <div data-v-37b730a4="" data-v-d68b6290="" class="lab-tools show"><div data-v-37b730a4="" class="toggle-btn"><i data-v-37b730a4="" class="fa fa-angle-double-right"></i></div> <div data-v-18205388="" data-v-37b730a4="" class="left-time"><div data-v-18205388="" class="text">
    17:57
  </div> <button data-v-18205388="" type="button" class="btn add-time-btn btn-secondary">
    延时
  </button> <!----></div> <!----> <div data-v-37b730a4="" class="divide"></div> <div data-v-c19f4d44="" data-v-37b730a4=""><button data-v-c19f4d44="" type="button" class="btn stop-lab-btn btn-danger"><i data-v-c19f4d44="" class="fa fa-stop"></i>
    关闭环境
  </button> <!----> <div data-v-5751383a="" data-v-78fab3f2="" data-v-c19f4d44="" class="base-left-modal" style="display: none;"><div data-v-5751383a="" class="box"><div data-v-5751383a="" class="close"><i data-v-5751383a="" class="fa fa-times"></i></div> <div data-v-5751383a="" class="content"><div data-v-78fab3f2="" data-v-5751383a="">
    选择想要替换的环境
    <div data-v-78fab3f2="" data-v-5751383a="" class="modal-sub-title">
      （被替换的环境将被删除）
    </div></div></div>  <div data-v-78fab3f2="" data-v-5751383a=""><div data-v-78fab3f2="" data-v-5751383a="" class="items"></div> <div data-v-78fab3f2="" data-v-5751383a="" class="footer"><button data-v-78fab3f2="" data-v-5751383a="" type="button" class="btn confirm-btn btn-primary">
        确认
      </button> <div data-v-78fab3f2="" data-v-5751383a="">
        返回上一步
      </div></div></div></div></div></div> <div data-v-37b730a4="" class="divide"></div> <!----> <!----> <!----> <!----> <div data-v-e7838ea4="" data-v-37b730a4=""><div data-v-e7838ea4="" class="common-btn"><div data-v-e7838ea4=""><i data-v-e7838ea4="" class="fa fa-arrows-alt"></i>
    桌面全屏
  </div></div> </div> <div data-v-37b730a4="" class="divide"></div> <!----> <!----> <!----> <div data-v-e7838ea4="" data-v-37b730a4=""><div data-v-e7838ea4="" class="common-btn"><div data-v-e7838ea4=""><i data-v-e7838ea4="" class="fa fa-bookmark-o"></i>
    环境使用指南
  </div></div> </div></div> <div class="messages" data-v-817ed8d0="" data-v-d68b6290=""><!----></div> <!----> <!----> <!----> <div class="hundred-level-modal" data-v-d68b6290=""><!----></div></div> <div data-v-57a4eb3b=""><!----> <!----></div> <div class="risk-validation" data-v-62b04b40="" data-v-57a4eb3b=""><!----></div> <!----> <!----> <!----></div>  <!----> <!----> <div class="flash-message" data-v-6fbfd453="" data-v-57a4eb3b=""><!----></div> <!----></div></div></div><script>window.__NUXT__=(function(a,b,c,d,e,f,g){return {layout:"body-layout",data:[{}],error:a,state:{env:{nodeEnv:"production",apiEndpointV1:f,apiEndpointV2:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2",apiEndpointLocalV1:f,apiEndpointLocalV2:"http:\u002F\u002Fshiyanlou-v2-web-svc\u002Fapi\u002Fv2",cometServiceUrl:"wss:\u002F\u002Fcomet.shiyanlou.com",staticHost:"https:\u002F\u002Fstatic.shiyanlou.com\u002Ffrontend\u002Fstatic",menuHost:f},teacher:{course:{},labs:[],monthData:[],courseUserStatus:{},courseStudents:[],labReports:[],activeLab:{},publishedCourses:[],comments:{},commentStatus:[],questions:{},"mutation-types":{}},labTask:{showLabTask:e,labTask:a,savedEnv:a},library:{navData:{},blocks:[],book:{},chapters:[],chapterContents:{},activeChapterSlug:c,isLiked:b,isMarked:b,"mutation-types":{}},live:{notEndedLiveCourses:{},endedLiveCourses:{},liveLab:{},course:{},liveUserStatus:{},chatroomInfo:{},chatroomUserInfo:{},chatroomAuthPayload:{},"mutation-types":{}},home:{courseCategories:c,swapper:c,classicalCourse:c,recentLouplus:c,popularBootCamp:c,popularPath:c,advertisement:c,advertisementStatus:{height:d,show:b},"mutation-types":{}},mall:{products:{},product:{},order:{},"mutation-types":{}},message:{show:b,type:c,message:c,"mutation-types":{}},messages:{messages:{},"mutation-types":{}},path:{paths:[],path:{},pathUserStatus:c,stage_list:[],"mutation-types":{}},promotion:{promotion:{},coupon:{},"mutation-types":{}},course:{categories:[],courses:{},coursesUserStatus:[],course:{},labStages:[],labDocData:{},labsUserStatus:[],activeLab:{},questions:{},reports:{},isReply:b,answer:{},comments:{},commentsUserStatus:[],replayUser:{},startLabLoading:b,studentMeta:{order:[],data:{}},relatedCourseGroups:[],pathNextCourses:[],recentlyContests:[],relatedChallenges:[],courseTopStudents:[],monthData:[],students:[],runningStudents:[],louplusStudentsRankData:{},"mutation-types":{},actions:{id:{}}},user:{userBaseInfo:{},userPublicInfo:{},userStudyRecords:{},userVisitors:[],userReportStatistic:{},userCoursesStatus:[],userMedals:[],editableUserInfo:{},editUserInfoStatus:{nickname:b,school:b},editUserPassword:{status:b,newPwd:c,oldPwd:c},hundredLevelUserInfo:{},userEmailSettings:{},courseRecordAction:{},oauthStatus:{},certificate:{},userCertificates:[],"mutation-types":{}},contest:{contests:a,contest_detail:a,contests_rank:a,contest_rank:{results:[]},contest_list:[],user_contest_status:{},"mutation-types":{}},question:{questions:{count:d,results:[]},question:{},questionUserStatus:{},relatedQuestions:[],answers:{},answer:{},answersUserStatus:[],isReply:b,"mutation-types":{},utils:{},actions:{question:{},"question.config":{},answer:{},"answer.config":{}}},challenge:{challenges:a,challengesStatus:a,challenge_tags:[],submissions:a,answers:a,lab_document:{},submission:{},challenge:{},modal:b,modal_content:{},"mutation-types":{}},report:{reports:{},report:{},user_status:[],related:[],study_data:{},lab_user_status:{},"mutation-types":{}},bootcamp:{courses:{},categories:[],"mutation-types":{}},search:{results:{},"mutation-types":{}},auth:{loggedIn:e,user:{id:1183262,name:"LOU263208170",avatar_url:"https:\u002F\u002Fdn-simplecloud.shiyanlou.com\u002Fgravatar2v5mHQBVw6yI.jpg?imageView2\u002F1\u002Fw\u002F200\u002Fh\u002F200",is_graduated:b,job_title:a,school:a,level:51,member_type:a,teacher_info:a,labels:[],join_date:"2019-10-29",status:"active",html_url:"\u002Fusers\u002F1183262",api_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002F",courses_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fcourses\u002F",questions_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fquestions\u002F",comments_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fcomments\u002F",contests_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fapi\u002Fv2\u002Fusers\u002F1183262\u002Fcontests\u002F",studied_courses_count:19,followed_courses_count:d,published_courses_count:d,marked_books_count:d,is_site_admin:b,is_teacher:b,email:a,is_email_validated:b,phone:"+8618813017082",beans:"54",created_at:"2019-10-29T11:27:24+08:00",study_minutes:1524,free_minutes:d,today_study_minutes:183,bought_courses_count:1,study_labs_count:314,basic_member_expired_at:a,plus_member_expired_at:a,premium_member_expired_at:a,invitation_html_url:"https:\u002F\u002Fwww.shiyanlou.com\u002Fregister?inviter=NTY0MzIwMTk1OTM3",member_invitation_code:c,have_saved_vm:b,enterprise_html_url:c,unread_messages_count:g,is_enterprise_admin:b,session_id:"62af5e6b-c8c5-4718-8a01-89bf67096240.bQRXeXqE4HQGm6jJp8VyxXtFO9w",is_set_password:e,roles:[],abilities:[],in_bailou_club:b,course_quota:g,is_subscribe_mp:b},isChecked:b,risk:{isRisk:b},authTokens:{},beans:d,signActive:"signInForm",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJNb0h1bWZGeWt3bFdmT2JoNVVSSXpvNEdrV0dHVFZpdSIsImlhdCI6MTU3NDEzODcwNiwiZXhwIjoxNTc0MjI1MTA2fQ.1z4vtwDZ2kt5qp-NPc4ihG3ZoTIJOQR-fYwT0EtDpEs","mutation-types":{},redirect:"\u002Fcourses\u002F1058\u002Flearning\u002F"},sideBox:{recentLouplus:[],recentActivity:[],followedPath:[],"mutation-types":{}},activity:{activity:{start_at:a,end_at:a,member_config:a,bootcamp_config:a,louplus_config:a},rules:[{product_type:"premium",discount_type:"present",derate_money:d,second_kill_price:a,second_kill_amount:d,extra_config:{progress:d,quota:d},present_days:30,discount_percent:"1.000",course_ids:[],buy_days:365}],modal:{activity_id:a,start_at:a,end_at:a,config:a},"mutation-types":{}},louplus:{louplusInfo:{},louplusList:[],louplusUserStatus:{},"mutation-types":{}}},serverRendered:e}}(null,false,"",0,true,"https:\u002F\u002Fwww.shiyanlou.com",2));</script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/f3a337105fb6129b39d1.js.下载" defer=""></script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/13652036f3502b0c6db7.js.下载" defer=""></script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/cc58aae2d5b624e45e75.js.下载" defer=""></script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/34e4120db4a53410cbcd.js.下载" defer=""></script><script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/0eed17603f033879ebbc.js.下载" defer=""></script>
  

<script src="./利用逻辑回归实现鸢尾花分类 - 一元逻辑回归实现鸢尾花分类 - 实验楼_files/guide.js.下载"></script><script></script></body></html>