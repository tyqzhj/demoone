(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1532:function(t,e,n){},1533:function(t,e,n){},1534:function(t,e,n){},1535:function(t,e,n){},1536:function(t,e,n){},1537:function(t,e,n){},1538:function(t,e,n){},2127:function(t,e,n){"use strict";var o=n(1532);n.n(o).a},2128:function(t,e,n){"use strict";var o=n(1533);n.n(o).a},2129:function(t,e,n){"use strict";var o=n(1534);n.n(o).a},2130:function(t,e,n){"use strict";var o=n(1535);n.n(o).a},2131:function(t,e,n){"use strict";var o=n(1536);n.n(o).a},2132:function(t,e,n){"use strict";var o=n(1537);n.n(o).a},2133:function(t,e,n){"use strict";var o=n(1538);n.n(o).a},2892:function(t,e,n){"use strict";n.r(e);n(13);var o=n(2),r=n(1),c={},l=(n(2127),n(2128),n(5)),d=Object(l.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mall-banner"},[n("div",{staticClass:"user-beans"},[t.$auth.user.id?n("div",{staticClass:"beans-surplus"},[t._v("\n      我的实验豆："+t._s(t.$auth.user.beans)+"个\n      "),n("img",{attrs:{src:"https://static.shiyanlou.com/img/shop/icon-bean-v2.png",alt:""}})]):t._e(),t._v(" "),n("div",{staticClass:"beans-collect"},[n("i",{staticClass:"fa fa-question-circle fa-lg"}),t._v(" "),n("span",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.top",value:"有效学习30分钟奖励1个实验豆",expression:"'有效学习30分钟奖励1个实验豆'",modifiers:{hover:!0,top:!0}}]},[t._v("\n        如何获得实验豆\n      ")])])])])},[],!1,null,"a7b9f12a",null).exports,m=n(10),f={props:{product:{type:Object,default:function(){return{}}}},methods:Object(r.a)({},Object(m.b)("mall",["setProduct"]),{viewProduct:function(){this.setProduct(this.product)}})},v=(n(2129),Object(l.a)(f,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mall-goods"},[n("b-card",{staticClass:"mb-2",attrs:{title:t.product.name,"img-src":t.product.picture_url,"img-alt":"Image","img-top":"",tag:"article"},on:{click:t.viewProduct}},[n("div",{staticClass:"card-text"},[n("div",{staticClass:"goods-status"},[n("span",[t._v(t._s(t.product.beans)+"实验豆")]),t._v(" "),t.product.current_stocks<=5?n("span",[t._v("\n          剩余："+t._s(t.product.current_stocks)+"\n        ")]):t._e()]),t._v(" "),t.product.current_stocks<=0?n("div",{staticClass:"shortage"},[t._v("\n        抢光了\n      ")]):t._e(),t._v(" "),t.product.user_could_exchange_times<=0?n("div",{staticClass:"restriction"},[t._v("\n        兑换次数已用完\n      ")]):t._e()])])],1)},[],!1,null,null,null).exports),h=(n(43),n(123)),_=n.n(h),C={props:{product:{type:Object,required:!0}},data:function(){return{form:{recipient:"",phone:"",address:"",comment:""},warning:!1}},methods:Object(r.a)({},Object(m.b)("mall",["purchaseProduct"]),{closeModal:function(){this.$refs.consigneeModal.hide()},submit:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.form.recipient&&/^[0-9]+\.?[0-9]*$/.test(this.form.phone)&&this.form.address){t.next=3;break}return this.warning=!0,t.abrupt("return");case 3:this.purchaseProduct({params:{productId:this.product.id,router:this.$router},query:Object(r.a)({},this.form)}),this.closeModal();case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()})},$=(n(2130),Object(l.a)(C,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"consignee-modal-container"},[n("b-modal",{ref:"consigneeModal",attrs:{id:"consignee-modal","hide-footer":"","hide-header":"",size:"lg"}},[n("div",{staticClass:"consignee-header"},[n("h3",[t._v("\n        本商品需要邮寄，请仔细填写收货信息\n      ")]),t._v(" "),n("i",{staticClass:"fa fa-close",on:{click:t.closeModal}})]),t._v(" "),n("div",{staticClass:"input-container"},[n("label",[t._v("\n        收货人\n        "),n("span",[t._v("\n          *\n        ")]),t._v(" "),n("b-form-input",{attrs:{type:"text"},model:{value:t.form.recipient,callback:function(e){t.$set(t.form,"recipient","string"==typeof e?e.trim():e)},expression:"form.recipient"}})],1),t._v(" "),n("label",[t._v("\n        联系电话\n        "),n("span",[t._v("\n          *\n        ")]),t._v(" "),n("b-form-input",{attrs:{type:"text"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone","string"==typeof e?e.trim():e)},expression:"form.phone"}})],1),t._v(" "),n("label",[t._v("\n        收货地址\n        "),n("span",[t._v("\n          *\n        ")]),t._v(" "),n("b-form-textarea",{attrs:{rows:3,"max-rows":6},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address","string"==typeof e?e.trim():e)},expression:"form.address"}})],1),t._v(" "),n("label",[t._v("\n        备注\n        "),n("b-form-input",{attrs:{type:"text"},model:{value:t.form.comment,callback:function(e){t.$set(t.form,"comment","string"==typeof e?e.trim():e)},expression:"form.comment"}})],1)]),t._v(" "),n("div",{staticClass:"consignee-footer"},[t.warning?n("span",[t._v("\n        您填写的内容有误，请修改后提交\n      ")]):t._e(),t._v(" "),n("button",{staticClass:"btn btn-default cancel",on:{click:t.closeModal}},[t._v("\n        取消\n      ")]),t._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:t.submit}},[t._v("\n        确认兑换\n      ")])])])],1)},[],!1,null,null,null).exports),x={props:{product:{type:Object,default:function(){return{}}}},methods:Object(r.a)({},Object(m.b)("mall",["purchaseProduct"]),{closeModal:function(){this.$refs.confirmModal.hide()},submit:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.purchaseProduct({params:{productId:this.product.id,router:this.$router}}),this.closeModal();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()})},j=(n(2131),{components:{consigneeModal:$,confirmModal:Object(l.a)(x,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("b-modal",{ref:"confirmModal",attrs:{id:"mall-confirm-modal","hide-footer":"","hide-header":"",size:"sm"}},[e("div",{staticClass:"confirm-container"},[e("h3",{staticClass:"title"},[this._v("\n        是否确认兑换？\n      ")]),this._v(" "),e("button",{staticClass:"btn-default cancel",on:{click:this.closeModal}},[this._v("\n        取消\n      ")]),this._v(" "),e("button",{staticClass:"btn-primary",on:{click:this.submit}},[this._v("\n        确认兑换\n      ")])])])],1)},[],!1,null,"5de8d6a0",null).exports},computed:Object(r.a)({},Object(m.d)("mall",{product:function(t){return t.product}}),{desc:function(){var t=_()(this.product.description||"");return t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">")}}),methods:{close:function(){this.$refs.goodsDetailModal.hide()},handleClick:function(){this.close(),this.$auth.loggedIn?"general"===this.product.type?this.$root.$emit("bv::show::modal","consignee-modal"):this.$root.$emit("bv::show::modal","mall-confirm-modal"):this.$root.$emit("bv::show::modal","sign-modal")}}}),k=(n(2132),{components:{mallBanner:d,mallGoods:v,goodsDetailModal:Object(l.a)(j,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"goods-detail-modal-container"},[n("b-modal",{ref:"goodsDetailModal",attrs:{id:"goods-detail-modal","hide-footer":"","hide-header":"",size:"lg"}},[n("div",{staticClass:"modal-text"},[n("div",{staticClass:"goods-header"},[n("h3",[t._v(t._s(t.product.name))]),t._v(" "),n("i",{staticClass:"fa fa-close",on:{click:t.close}})]),t._v(" "),n("div",{staticClass:"goods-body",domProps:{innerHTML:t._s(t.desc)}}),t._v(" "),n("div",{staticClass:"goods-footer"},[n("span",[t._v("\n          消耗实验豆："+t._s(t.product.beans)+"个\n        ")]),t._v(" "),t.$auth.loggedIn?n("span",[t._v("\n          (总剩余实验豆："+t._s(t.$auth.user.beans)+"个)\n        ")]):t._e(),t._v(" "),t.$auth.user.beans<t.product.beans||t.product.user_could_exchange_times<=0||t.product.current_stocks<=0?n("b-button",{attrs:{disabled:""}},[t._v("\n          立即兑换\n        ")]):n("b-button",{attrs:{variant:"primary"},on:{click:t.handleClick}},[t._v("\n          立即兑换\n        ")])],1)])]),t._v(" "),n("consignee-modal",{ref:"consigneeModalWrap",attrs:{product:t.product}}),t._v(" "),n("confirm-modal",{ref:"confirmModalWrap",attrs:{product:t.product}})],1)},[],!1,null,null,null).exports},computed:Object(r.a)({},Object(m.d)("mall",{products:function(t){return t.products}})),asyncData:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.store,t.next=3,n.dispatch("mall/getProducts");case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),methods:Object(r.a)({},Object(m.b)("mall",["getProducts"])),head:{title:"实验豆商城"}}),w=(n(2133),Object(l.a)(k,function(){var t=this.$createElement,e=this._self._c||t;return e("full-page",{attrs:{"near-top":!0}},[e("mall-banner"),this._v(" "),e("div",{staticClass:"container"},[e("b-row",this._l(this.products.results,function(t,n){return e("b-col",{key:n,attrs:{md:"4"}},[e("mall-goods",{directives:[{name:"b-modal",rawName:"v-b-modal.goods-detail-modal",modifiers:{"goods-detail-modal":!0}}],staticClass:"mall-body",attrs:{product:t}})],1)}),1),this._v(" "),e("base-pagination",{attrs:{previous:this.products.previous,next:this.products.next}})],1),this._v(" "),e("goods-detail-modal")],1)},[],!1,null,"9de29394",null));e.default=w.exports}}]);