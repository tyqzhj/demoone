(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{1669:function(e,t,n){},1670:function(e,t,n){},2315:function(e,t,n){"use strict";var r=n(1669);n.n(r).a},2316:function(e,t,n){"use strict";var r=n(1670);n.n(r).a},2906:function(e,t,n){"use strict";n.r(t);n(61),n(58),n(39),n(13);var r=n(2),c=n(1),o=n(10),l=n(123),m=n.n(l),d={props:{message:{type:Object,default:function(){return{}}}},computed:{msgContent:function(){return this.message.content?m()(this.message.content):""}}},f=(n(2315),n(5)),v={middleware:["auth"],components:{MessageItem:Object(f.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message-item",class:{unread:!e.message.is_read}},[n("div",{staticClass:"msg-item-top"},[e.message.show_category?n("div",{staticClass:"msg-cate"},[n("span",{staticClass:"label label-success font-14"},[e._v(e._s(e.message.category))])]):e._e(),e._v(" "),n("div",[n("div",{staticClass:"msg-main-content font-14",domProps:{innerHTML:e._s(e.msgContent)}})])]),e._v(" "),n("div",{staticClass:"msg-create-time text-right"},[n("small",[e._v(e._s(e._f("dateTimeFormat")(e.message.created_at,"YYYY/MM/DD HH:mm",!0)))])])])},[],!1,null,"60738992",null).exports},computed:Object(c.a)({},Object(o.d)("messages",{messages:function(e){return e.messages}}),{userId:function(){return this.$auth.user.id}}),asyncData:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.store,r=t.app.$auth,e.next=3,n.dispatch("messages/getMessages",{from:r.user.id});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),mounted:function(){this.readMessages()},methods:Object(c.a)({},Object(o.b)("messages",["getMessages","readMessage"]),{handlePageChange:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(cursor){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMessages({from:this.userId,cursor:cursor});case 2:this.readMessages(),document.documentElement.scrollTop=0;case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),readMessages:function(){var e=this.messages.results.filter(function(e){return!e.is_read}),t=!0,n=!1,r=void 0;try{for(var c,o=e[Symbol.iterator]();!(t=(c=o.next()).done);t=!0){var l=c.value;this.readMessage(l)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}),head:function(){return{title:"系统通知"}}},h=(n(2316),Object(f.a)(v,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("single-page",[n("common-content",[e.messages.results?n("div",{staticClass:"msgs-list"},[e._l(e.messages.results,function(e,t){return n("message-item",{key:t,attrs:{message:e}})}),e._v(" "),e.messages.results.length?e._e():n("div",{staticClass:"no-message"},[e._v("\n        没有消息\n      ")])],2):n("div",{staticClass:"loading text-center"},[n("i",{staticClass:"fa fa-spinner fa-pulse fa-3x fa-fw"}),e._v(" "),n("span",{staticClass:"sr-only"},[e._v("数据加载中...")]),e._v(" "),n("p",{staticClass:"msg font-14 color-text"},[e._v("\n        数据加载中，请稍候...\n      ")])]),e._v(" "),n("base-pagination",{attrs:{previous:e.messages.previous,next:e.messages.next,"page-handler":e.handlePageChange}})],1)],1)},[],!1,null,"64eab146",null));t.default=h.exports}}]);